<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <title>AI Weather Data</title>
</head>
<body>
<script>
// Pulisci il JSON dalle backtick
function cleanJSON(str) {
  return str.replace(/``````\n?/g, '').trim();
}

// Estrai e parsa
const rawSummary = "";
let parsed = { summary: '', advice: [], alerts: [] };

try {
  const cleaned = cleanJSON(rawSummary);
  if (cleaned) {
    parsed = JSON.parse(cleaned);
  }
} catch(e) {
  console.error('Parse error:', e);
}

// Rendi disponibile al frontend
window.aiWeatherData = {
  summary: parsed.summary || '',
  advice: Array.isArray(parsed.advice) ? parsed.advice : [],
  alerts: Array.isArray(parsed.alerts) ? parsed.alerts : [],
  timestamp: new Date().toLocaleString('it-IT')
};

console.log('âœ… AI Data loaded:', window.aiWeatherData);
</script>
</body>
</html>
