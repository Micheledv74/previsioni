<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes" />
<title>PREVISIONI METEO PROCIDA</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Roboto&display=swap');
  html, body { margin:0; padding:0; box-sizing: border-box; }
  body {
    font-family: 'Roboto', sans-serif;
    background: linear-gradient(135deg, #26365a, #2a3a7f 85%, #3498db 97%);
    color: #f0f8ff;
    max-width: 1000px;
    margin: 0 auto;
    min-height: 100vh;
    padding: 14px 10px 28px 10px;
  }
  .header {
    text-align: center;
    font-family: 'Montserrat', sans-serif;
    font-weight: 900;
    font-size: 2.8rem;
    color: #cfe9ff;
    margin-bottom: 25px;
    letter-spacing: 1.9px;
    user-select: none;
    text-shadow: 1px 2px 15px #09172a;
  }
  .dashboard {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 24px 18px;
    max-width: 1000px;
    margin: 0 auto;
  }
  /* Large box for today */
  .box.today {
    background: #2b416c;
    border-radius: 20px;
    box-shadow: 0 8px 44px rgba(0,0,0,0.34);
    flex: 1 1 950px;
    padding: 27px 30px 22px 30px;
    color: #e6f1ff;
  }
  .box.today h2 {
    font-weight: 900;
    font-size: 2.4rem;
    margin-bottom: 15px;
    font-family: 'Montserrat', sans-serif;
  }
  .box.today .alert, .box.today .advice {
    font-size: 1.17rem;
    font-weight: 700;
    margin-top: 10px;
    color: #a5e3ff;
    background: rgba(14,29,50,0.25);
    padding: 8px 18px;
    border-radius: 13px;
  }

  /* Mini days grid */
  .mini-days-row {
    display: flex;
    justify-content: center;
    gap: 18px;
    flex-wrap: nowrap;
    max-width: 960px;
    margin-bottom: 22px;
  }
  .mini-days-row.wrap {
    flex-wrap: wrap;
  }
  .mini-day-card {
    background: #1a2a56;
    border-radius: 15px;
    box-shadow: 0 4px 14px #0b1b4bcc;
    padding: 18px 26px;
    width: calc((100% - 54px) / 3);
    color: #cdefff;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  .mini-day-card.selected {
    background-color: #3498db;
    box-shadow: 0 6px 26px #2376cfbb;
    color: white;
  }
  .mini-day-main {
    width: 100%;
    margin-bottom: 28px;
  }
  @media(max-width: 1000px) {
    .box.today { flex: 1 1 90vw; max-width: 90vw; }
    .mini-days-row { max-width: 90vw; }
    .mini-day-card { width: calc((100% - 36px) / 2); }
  }
  @media(max-width: 660px) {
    .mini-day-card { width: 100%; }
    .mini-days-row.wrap { flex-direction: column; }
  }
  .mini-day-card .date {
    font-weight: 800;
    font-size: 1.10rem;
    margin-bottom: 6px;
  }
  .mini-day-card .icon {
    font-size: 34px;
    margin-bottom: 10px;
  }
  .mini-day-card .temps {
    font-weight: 700;
    font-size: 1.05rem;
  }
  .mini-day-card .wind-precip {
    margin-top: 7px;
    font-size: 0.98rem;
    color: #82caff;
  }
  .btn-detail {
    margin-top: 20px;
    background-color: #0a83f7;
    color: white;
    border: none;
    border-radius: 13px;
    padding: 12px 22px;
    font-weight: 700;
    font-size: 1rem;
    cursor: pointer;
  }
  .btn-detail:hover {
    background-color: #3498db;
  }
  .box {
    background: #26375c;
    border-radius: 18px;
    box-shadow: 0 6px 30px #0a1b3882;
    padding: 16px 22px 18px 22px;
    max-width: 430px;
    min-width: 280px;
    display: flex;
    flex-direction: column;
    color: #ebf4ff;
  }
  .box-title {
    font-family: 'Montserrat', sans-serif;
    font-weight: 900;
    font-size: 1.18rem;
    margin-bottom: 18px;
    color: #a9e3ff;
  }
  .box-main-info {
    font-weight: 700;
    font-size: 1.14rem;
    margin-bottom: 10px;
    color: #7cd9ff;
  }
  .box-sub-info {
    font-weight: 500;
    font-size: 1rem;
    color: #bcdff9cc;
  }
  .detail-section {
    display: none;
    margin-top: 12px;
    overflow: auto;
    max-height: 320px;
  }
  .detail-section.active {
    display: block;
  }
  .chart-container {
    width: 100%;
    height: 280px;
    background: rgba(29,49,82,0.9);
    border-radius: 15px;
    box-sizing: border-box;
    padding: 12px;
  }
  .info-chips {
    display: flex;
    justify-content: center;
    gap: 16px;
    margin-top: 18px;
  }
  .info-chip {
    background: #39b8e9a6;
    border-radius: 12px;
    padding: 11px 20px;
    font-weight: 700;
    color: #092237;
    min-width: 90px;
    text-align: center;
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="header">PREVISIONI METEO PROCIDA</div>
  <div class="dashboard">
    <section class="box today large-day" id="todayBox"></section>
    <div class="mini-days-row flex-nowrap" id="miniRow1"></div>
    <div class="mini-days-row wrap" id="miniRow2"></div>
    <div class="boxes-row" id="mainBoxes">
      <section class="box" id="windBox"></section>
      <section class="box" id="rainBox"></section>
      <section class="box" id="seaBox"></section>
      <section class="box" id="pressBox"></section>
    </div>
  </div>
  <div class="footer" id="footer"></div>
  <script>
    const DATA = {"mergedHourly":[{"time":"2025-10-15T00:00","wave_height":0.04,"swell_height":0.04,"swell_direction":219,"sea_surface_temperature":21.4},{"time":"2025-10-15T01:00","wave_height":0.04,"swell_height":0.04,"swell_direction":219,"sea_surface_temperature":21.4},{"time":"2025-10-15T02:00","wave_height":0.04,"swell_height":0.04,"swell_direction":218,"sea_surface_temperature":21.4},{"time":"2025-10-15T03:00","wave_height":0.06,"swell_height":0.06,"swell_direction":218,"sea_surface_temperature":21.4},{"time":"2025-10-15T04:00","wave_height":0.08,"swell_height":0.08,"swell_direction":218,"sea_surface_temperature":21.3},{"time":"2025-10-15T05:00","wave_height":0.1,"swell_height":0.1,"swell_direction":218,"sea_surface_temperature":21.3},{"time":"2025-10-15T06:00","wave_height":0.12,"swell_height":0.12,"swell_direction":218,"sea_surface_temperature":21.2},{"time":"2025-10-15T07:00","wave_height":0.14,"swell_height":0.14,"swell_direction":218,"sea_surface_temperature":21.2},{"time":"2025-10-15T08:00","wave_height":0.16,"swell_height":0.16,"swell_direction":218,"sea_surface_temperature":21.2},{"time":"2025-10-15T09:00","wave_height":0.18,"swell_height":0.18,"swell_direction":218,"sea_surface_temperature":21.2},{"time":"2025-10-15T10:00","wave_height":0.2,"swell_height":0.2,"swell_direction":217,"sea_surface_temperature":21.2},{"time":"2025-10-15T11:00","wave_height":0.22,"swell_height":0.22,"swell_direction":217,"sea_surface_temperature":21.2},{"time":"2025-10-15T12:00","wave_height":0.24,"swell_height":0.22,"swell_direction":217,"sea_surface_temperature":21.3},{"time":"2025-10-15T13:00","wave_height":0.28,"swell_height":0.22,"swell_direction":216,"sea_surface_temperature":21.3},{"time":"2025-10-15T14:00","wave_height":0.3,"swell_height":0.22,"swell_direction":216,"sea_surface_temperature":21.3},{"time":"2025-10-15T15:00","wave_height":0.3,"swell_height":0.22,"swell_direction":215,"sea_surface_temperature":21.3},{"time":"2025-10-15T16:00","wave_height":0.28,"swell_height":0.24,"swell_direction":215,"sea_surface_temperature":21.3},{"time":"2025-10-15T17:00","wave_height":0.28,"swell_height":0.24,"swell_direction":214,"sea_surface_temperature":21.3},{"time":"2025-10-15T18:00","wave_height":0.3,"swell_height":0.24,"swell_direction":214,"sea_surface_temperature":21.2},{"time":"2025-10-15T19:00","wave_height":0.3,"swell_height":0.26,"swell_direction":215,"sea_surface_temperature":21.2},{"time":"2025-10-15T20:00","wave_height":0.32,"swell_height":0.26,"swell_direction":215,"sea_surface_temperature":21.2},{"time":"2025-10-15T21:00","wave_height":0.36,"swell_height":0.28,"swell_direction":215,"sea_surface_temperature":21.2},{"time":"2025-10-15T22:00","wave_height":0.42,"swell_height":0.28,"swell_direction":216,"sea_surface_temperature":21.2},{"time":"2025-10-15T23:00","wave_height":0.46,"swell_height":0.3,"swell_direction":216,"sea_surface_temperature":21.2},{"time":"2025-10-16T00:00","wave_height":0.48,"swell_height":0.3,"swell_direction":216,"sea_surface_temperature":21.2},{"time":"2025-10-16T01:00","wave_height":0.52,"swell_height":0.32,"swell_direction":215,"sea_surface_temperature":21.1},{"time":"2025-10-16T02:00","wave_height":0.54,"swell_height":0.32,"swell_direction":215,"sea_surface_temperature":21.1},{"time":"2025-10-16T03:00","wave_height":0.58,"swell_height":0.34,"swell_direction":194,"sea_surface_temperature":21.1},{"time":"2025-10-16T04:00","wave_height":0.62,"swell_height":0.34,"swell_direction":174,"sea_surface_temperature":21.1},{"time":"2025-10-16T05:00","wave_height":0.66,"swell_height":0.36,"swell_direction":153,"sea_surface_temperature":21.1},{"time":"2025-10-16T06:00","wave_height":0.68,"swell_height":0.4,"swell_direction":153,"sea_surface_temperature":21.1},{"time":"2025-10-16T07:00","wave_height":0.7,"swell_height":0.44,"swell_direction":154,"sea_surface_temperature":21.1},{"time":"2025-10-16T08:00","wave_height":0.72,"swell_height":0.48,"swell_direction":154,"sea_surface_temperature":21.1},{"time":"2025-10-16T09:00","wave_height":0.76,"swell_height":0.52,"swell_direction":153,"sea_surface_temperature":21.1},{"time":"2025-10-16T10:00","wave_height":0.78,"swell_height":0.54,"swell_direction":153,"sea_surface_temperature":21.1},{"time":"2025-10-16T11:00","wave_height":0.82,"swell_height":0.58,"swell_direction":152,"sea_surface_temperature":21.1},{"time":"2025-10-16T12:00","wave_height":0.82,"swell_height":0.6,"swell_direction":152,"sea_surface_temperature":21},{"time":"2025-10-16T13:00","wave_height":0.84,"swell_height":0.62,"swell_direction":151,"sea_surface_temperature":21},{"time":"2025-10-16T14:00","wave_height":0.84,"swell_height":0.64,"swell_direction":151,"sea_surface_temperature":21},{"time":"2025-10-16T15:00","wave_height":0.86,"swell_height":0.64,"swell_direction":151,"sea_surface_temperature":21},{"time":"2025-10-16T16:00","wave_height":0.88,"swell_height":0.66,"swell_direction":151,"sea_surface_temperature":21},{"time":"2025-10-16T17:00","wave_height":0.9,"swell_height":0.66,"swell_direction":151,"sea_surface_temperature":21},{"time":"2025-10-16T18:00","wave_height":0.88,"swell_height":0.64,"swell_direction":151,"sea_surface_temperature":21},{"time":"2025-10-16T19:00","wave_height":0.88,"swell_height":0.6,"swell_direction":150,"sea_surface_temperature":21},{"time":"2025-10-16T20:00","wave_height":0.86,"swell_height":0.58,"swell_direction":150,"sea_surface_temperature":21},{"time":"2025-10-16T21:00","wave_height":0.8,"swell_height":0.52,"swell_direction":153,"sea_surface_temperature":21},{"time":"2025-10-16T22:00","wave_height":0.76,"swell_height":0.46,"swell_direction":155,"sea_surface_temperature":21},{"time":"2025-10-16T23:00","wave_height":0.7,"swell_height":0.4,"swell_direction":158,"sea_surface_temperature":21},{"time":"2025-10-17T00:00","wave_height":0.66,"swell_height":0.42,"swell_direction":153,"sea_surface_temperature":21},{"time":"2025-10-17T01:00","wave_height":0.62,"swell_height":0.42,"swell_direction":148,"sea_surface_temperature":21},{"time":"2025-10-17T02:00","wave_height":0.58,"swell_height":0.44,"swell_direction":143,"sea_surface_temperature":21},{"time":"2025-10-17T03:00","wave_height":0.54,"swell_height":0.42,"swell_direction":143,"sea_surface_temperature":21},{"time":"2025-10-17T04:00","wave_height":0.52,"swell_height":0.38,"swell_direction":142,"sea_surface_temperature":21},{"time":"2025-10-17T05:00","wave_height":0.48,"swell_height":0.36,"swell_direction":142,"sea_surface_temperature":20.9},{"time":"2025-10-17T06:00","wave_height":0.46,"swell_height":0.34,"swell_direction":143,"sea_surface_temperature":20.9},{"time":"2025-10-17T07:00","wave_height":0.42,"swell_height":0.34,"swell_direction":145,"sea_surface_temperature":20.9},{"time":"2025-10-17T08:00","wave_height":0.4,"swell_height":0.32,"swell_direction":146,"sea_surface_temperature":20.9},{"time":"2025-10-17T09:00","wave_height":0.38,"swell_height":0.3,"swell_direction":146,"sea_surface_temperature":20.9},{"time":"2025-10-17T10:00","wave_height":0.38,"swell_height":0.3,"swell_direction":146,"sea_surface_temperature":21},{"time":"2025-10-17T11:00","wave_height":0.36,"swell_height":0.28,"swell_direction":146,"sea_surface_temperature":21},{"time":"2025-10-17T12:00","wave_height":0.36,"swell_height":0.28,"swell_direction":146,"sea_surface_temperature":21},{"time":"2025-10-17T13:00","wave_height":0.36,"swell_height":0.26,"swell_direction":146,"sea_surface_temperature":21},{"time":"2025-10-17T14:00","wave_height":0.36,"swell_height":0.26,"swell_direction":146,"sea_surface_temperature":21},{"time":"2025-10-17T15:00","wave_height":0.36,"swell_height":0.26,"swell_direction":165,"sea_surface_temperature":21},{"time":"2025-10-17T16:00","wave_height":0.34,"swell_height":0.26,"swell_direction":185,"sea_surface_temperature":21},{"time":"2025-10-17T17:00","wave_height":0.34,"swell_height":0.26,"swell_direction":204,"sea_surface_temperature":21},{"time":"2025-10-17T18:00","wave_height":0.34,"swell_height":0.24,"swell_direction":204,"sea_surface_temperature":21},{"time":"2025-10-17T19:00","wave_height":0.34,"swell_height":0.24,"swell_direction":203,"sea_surface_temperature":21},{"time":"2025-10-17T20:00","wave_height":0.34,"swell_height":0.22,"swell_direction":203,"sea_surface_temperature":21},{"time":"2025-10-17T21:00","wave_height":0.32,"swell_height":0.22,"swell_direction":203,"sea_surface_temperature":21},{"time":"2025-10-17T22:00","wave_height":0.32,"swell_height":0.2,"swell_direction":202,"sea_surface_temperature":21},{"time":"2025-10-17T23:00","wave_height":0.3,"swell_height":0.2,"swell_direction":202,"sea_surface_temperature":21},{"time":"2025-10-18T00:00","wave_height":0.28,"swell_height":0.18,"swell_direction":202,"sea_surface_temperature":20.9},{"time":"2025-10-18T01:00","wave_height":0.28,"swell_height":0.16,"swell_direction":202,"sea_surface_temperature":20.9},{"time":"2025-10-18T02:00","wave_height":0.26,"swell_height":0.14,"swell_direction":202,"sea_surface_temperature":20.9},{"time":"2025-10-18T03:00","wave_height":0.24,"swell_height":0.14,"swell_direction":231,"sea_surface_temperature":20.9},{"time":"2025-10-18T04:00","wave_height":0.24,"swell_height":0.14,"swell_direction":259,"sea_surface_temperature":20.9},{"time":"2025-10-18T05:00","wave_height":0.22,"swell_height":0.14,"swell_direction":288,"sea_surface_temperature":20.9},{"time":"2025-10-18T06:00","wave_height":0.22,"swell_height":0.14,"swell_direction":286,"sea_surface_temperature":20.9},{"time":"2025-10-18T07:00","wave_height":0.22,"swell_height":0.16,"swell_direction":285,"sea_surface_temperature":20.9},{"time":"2025-10-18T08:00","wave_height":0.22,"swell_height":0.16,"swell_direction":283,"sea_surface_temperature":20.9},{"time":"2025-10-18T09:00","wave_height":0.22,"swell_height":0.16,"swell_direction":282,"sea_surface_temperature":20.9},{"time":"2025-10-18T10:00","wave_height":0.2,"swell_height":0.16,"swell_direction":282,"sea_surface_temperature":21},{"time":"2025-10-18T11:00","wave_height":0.2,"swell_height":0.16,"swell_direction":281,"sea_surface_temperature":21},{"time":"2025-10-18T12:00","wave_height":0.2,"swell_height":0.16,"swell_direction":281,"sea_surface_temperature":21},{"time":"2025-10-18T13:00","wave_height":0.2,"swell_height":0.16,"swell_direction":280,"sea_surface_temperature":21.1},{"time":"2025-10-18T14:00","wave_height":0.2,"swell_height":0.16,"swell_direction":280,"sea_surface_temperature":21.1},{"time":"2025-10-18T15:00","wave_height":0.2,"swell_height":0.16,"swell_direction":280,"sea_surface_temperature":21.1},{"time":"2025-10-18T16:00","wave_height":0.18,"swell_height":0.16,"swell_direction":280,"sea_surface_temperature":21},{"time":"2025-10-18T17:00","wave_height":0.18,"swell_height":0.16,"swell_direction":280,"sea_surface_temperature":21},{"time":"2025-10-18T18:00","wave_height":0.18,"swell_height":0.16,"swell_direction":280,"sea_surface_temperature":21},{"time":"2025-10-18T19:00","wave_height":0.18,"swell_height":0.16,"swell_direction":279,"sea_surface_temperature":21},{"time":"2025-10-18T20:00","wave_height":0.18,"swell_height":0.16,"swell_direction":279,"sea_surface_temperature":20.9},{"time":"2025-10-18T21:00","wave_height":0.18,"swell_height":0.16,"swell_direction":279,"sea_surface_temperature":20.9},{"time":"2025-10-18T22:00","wave_height":0.18,"swell_height":0.16,"swell_direction":278,"sea_surface_temperature":20.9},{"time":"2025-10-18T23:00","wave_height":0.18,"swell_height":0.16,"swell_direction":278,"sea_surface_temperature":20.9},{"time":"2025-10-19T00:00","wave_height":0.16,"swell_height":0.16,"swell_direction":277,"sea_surface_temperature":20.9},{"time":"2025-10-19T01:00","wave_height":0.16,"swell_height":0.14,"swell_direction":276,"sea_surface_temperature":20.8},{"time":"2025-10-19T02:00","wave_height":0.14,"swell_height":0.14,"swell_direction":275,"sea_surface_temperature":20.8},{"time":"2025-10-19T03:00","wave_height":0.14,"swell_height":0.14,"swell_direction":275,"sea_surface_temperature":20.8},{"time":"2025-10-19T04:00","wave_height":0.14,"swell_height":0.14,"swell_direction":274,"sea_surface_temperature":20.8},{"time":"2025-10-19T05:00","wave_height":0.14,"swell_height":0.14,"swell_direction":274,"sea_surface_temperature":20.8},{"time":"2025-10-19T06:00","wave_height":0.18,"swell_height":0.12,"swell_direction":274,"sea_surface_temperature":20.7},{"time":"2025-10-19T07:00","wave_height":0.24,"swell_height":0.12,"swell_direction":273,"sea_surface_temperature":20.7},{"time":"2025-10-19T08:00","wave_height":0.28,"swell_height":0.1,"swell_direction":273,"sea_surface_temperature":20.7},{"time":"2025-10-19T09:00","wave_height":0.28,"swell_height":0.1,"swell_direction":302,"sea_surface_temperature":20.7},{"time":"2025-10-19T10:00","wave_height":0.3,"swell_height":0.08,"swell_direction":330,"sea_surface_temperature":20.7},{"time":"2025-10-19T11:00","wave_height":0.3,"swell_height":0.08,"swell_direction":359,"sea_surface_temperature":20.8},{"time":"2025-10-19T12:00","wave_height":0.28,"swell_height":0.08,"swell_direction":27,"sea_surface_temperature":20.8},{"time":"2025-10-19T13:00","wave_height":0.28,"swell_height":0.1,"swell_direction":54,"sea_surface_temperature":20.8},{"time":"2025-10-19T14:00","wave_height":0.26,"swell_height":0.1,"swell_direction":82,"sea_surface_temperature":20.8},{"time":"2025-10-19T15:00","wave_height":0.26,"swell_height":0.1,"swell_direction":93,"sea_surface_temperature":20.8},{"time":"2025-10-19T16:00","wave_height":0.28,"swell_height":0.1,"swell_direction":105,"sea_surface_temperature":20.8},{"time":"2025-10-19T17:00","wave_height":0.28,"swell_height":0.1,"swell_direction":116,"sea_surface_temperature":20.7},{"time":"2025-10-19T18:00","wave_height":0.3,"swell_height":0.1,"swell_direction":115,"sea_surface_temperature":20.7},{"time":"2025-10-19T19:00","wave_height":0.34,"swell_height":0.08,"swell_direction":114,"sea_surface_temperature":20.6},{"time":"2025-10-19T20:00","wave_height":0.36,"swell_height":0.08,"swell_direction":113,"sea_surface_temperature":20.6},{"time":"2025-10-19T21:00","wave_height":0.36,"swell_height":0.1,"swell_direction":111,"sea_surface_temperature":20.6},{"time":"2025-10-19T22:00","wave_height":0.38,"swell_height":0.12,"swell_direction":108,"sea_surface_temperature":20.6},{"time":"2025-10-19T23:00","wave_height":0.38,"swell_height":0.14,"swell_direction":106,"sea_surface_temperature":20.5},{"time":"2025-10-20T00:00","wave_height":0.38,"swell_height":0.14,"swell_direction":101,"sea_surface_temperature":20.5},{"time":"2025-10-20T01:00","wave_height":0.36,"swell_height":0.14,"swell_direction":96,"sea_surface_temperature":20.5},{"time":"2025-10-20T02:00","wave_height":0.36,"swell_height":0.14,"swell_direction":91,"sea_surface_temperature":20.5},{"time":"2025-10-20T03:00","wave_height":0.32,"swell_height":0.14,"swell_direction":101,"sea_surface_temperature":20.5},{"time":"2025-10-20T04:00","wave_height":0.3,"swell_height":0.12,"swell_direction":111,"sea_surface_temperature":20.5},{"time":"2025-10-20T05:00","wave_height":0.26,"swell_height":0.12,"swell_direction":121,"sea_surface_temperature":20.5},{"time":"2025-10-20T06:00","wave_height":0.24,"swell_height":0.12,"swell_direction":122,"sea_surface_temperature":20.4},{"time":"2025-10-20T07:00","wave_height":0.22,"swell_height":0.1,"swell_direction":124,"sea_surface_temperature":20.4},{"time":"2025-10-20T08:00","wave_height":0.2,"swell_height":0.1,"swell_direction":125,"sea_surface_temperature":20.4},{"time":"2025-10-20T09:00","wave_height":0.18,"swell_height":0.1,"swell_direction":124,"sea_surface_temperature":20.4},{"time":"2025-10-20T10:00","wave_height":0.16,"swell_height":0.1,"swell_direction":124,"sea_surface_temperature":20.5},{"time":"2025-10-20T11:00","wave_height":0.14,"swell_height":0.1,"swell_direction":123,"sea_surface_temperature":20.5},{"time":"2025-10-20T12:00","wave_height":0.14,"swell_height":0.1,"swell_direction":125,"sea_surface_temperature":20.5},{"time":"2025-10-20T13:00","wave_height":0.12,"swell_height":0.1,"swell_direction":126,"sea_surface_temperature":20.5},{"time":"2025-10-20T14:00","wave_height":0.12,"swell_height":0.1,"swell_direction":128,"sea_surface_temperature":20.5},{"time":"2025-10-20T15:00","wave_height":0.1,"swell_height":0.1,"swell_direction":129,"sea_surface_temperature":20.5},{"time":"2025-10-20T16:00","wave_height":0.1,"swell_height":0.08,"swell_direction":129,"sea_surface_temperature":20.5},{"time":"2025-10-20T17:00","wave_height":0.08,"swell_height":0.08,"swell_direction":130,"sea_surface_temperature":20.5},{"time":"2025-10-20T18:00","wave_height":0.08,"swell_height":0.08,"swell_direction":131,"sea_surface_temperature":20.4},{"time":"2025-10-20T19:00","wave_height":0.08,"swell_height":0.06,"swell_direction":132,"sea_surface_temperature":20.4},{"time":"2025-10-20T20:00","wave_height":0.08,"swell_height":0.06,"swell_direction":133,"sea_surface_temperature":20.4},{"time":"2025-10-20T21:00","wave_height":0.08,"swell_height":0.06,"swell_direction":134,"sea_surface_temperature":20.4},{"time":"2025-10-20T22:00","wave_height":0.06,"swell_height":0.04,"swell_direction":135,"sea_surface_temperature":20.4},{"time":"2025-10-20T23:00","wave_height":0.06,"swell_height":0.04,"swell_direction":136,"sea_surface_temperature":20.3},{"time":"2025-10-21T00:00","wave_height":0.06,"swell_height":0.04,"swell_direction":136,"sea_surface_temperature":20.3},{"time":"2025-10-21T01:00","wave_height":0.06,"swell_height":0.04,"swell_direction":137,"sea_surface_temperature":20.3},{"time":"2025-10-21T02:00","wave_height":0.06,"swell_height":0.04,"swell_direction":137,"sea_surface_temperature":20.3},{"time":"2025-10-21T03:00","wave_height":0.06,"swell_height":0.04,"swell_direction":137,"sea_surface_temperature":20.3},{"time":"2025-10-21T04:00","wave_height":0.04,"swell_height":0.04,"swell_direction":138,"sea_surface_temperature":20.3},{"time":"2025-10-21T05:00","wave_height":0.04,"swell_height":0.04,"swell_direction":138,"sea_surface_temperature":20.2},{"time":"2025-10-21T06:00","wave_height":0.04,"swell_height":0.04,"swell_direction":138,"sea_surface_temperature":20.2},{"time":"2025-10-21T07:00","wave_height":0.04,"swell_height":0.04,"swell_direction":138,"sea_surface_temperature":20.2},{"time":"2025-10-21T08:00","wave_height":0.04,"swell_height":0.04,"swell_direction":138,"sea_surface_temperature":20.2},{"time":"2025-10-21T09:00","wave_height":0.06,"swell_height":0.04,"swell_direction":136,"sea_surface_temperature":20.2},{"time":"2025-10-21T10:00","wave_height":0.06,"swell_height":0.04,"swell_direction":134,"sea_surface_temperature":20.3},{"time":"2025-10-21T11:00","wave_height":0.08,"swell_height":0.04,"swell_direction":132,"sea_surface_temperature":20.3},{"time":"2025-10-21T12:00","wave_height":0.12,"swell_height":0.04,"swell_direction":119,"sea_surface_temperature":20.3},{"time":"2025-10-21T13:00","wave_height":0.16,"swell_height":0.04,"swell_direction":106,"sea_surface_temperature":20.4},{"time":"2025-10-21T14:00","wave_height":0.2,"swell_height":0.04,"swell_direction":93,"sea_surface_temperature":20.4},{"time":"2025-10-21T15:00","wave_height":0.2,"swell_height":0.08,"swell_direction":100,"sea_surface_temperature":20.4},{"time":"2025-10-21T16:00","wave_height":0.22,"swell_height":0.1,"swell_direction":106,"sea_surface_temperature":20.4},{"time":"2025-10-21T17:00","wave_height":0.22,"swell_height":0.14,"swell_direction":113,"sea_surface_temperature":20.4},{"time":"2025-10-21T18:00","wave_height":0.22,"swell_height":0.14,"swell_direction":119,"sea_surface_temperature":20.3},{"time":"2025-10-21T19:00","wave_height":0.2,"swell_height":0.14,"swell_direction":126,"sea_surface_temperature":20.3},{"time":"2025-10-21T20:00","wave_height":0.2,"swell_height":0.14,"swell_direction":132,"sea_surface_temperature":20.3},{"time":"2025-10-21T21:00","wave_height":0.2,"swell_height":0.12,"swell_direction":135,"sea_surface_temperature":20.3},{"time":"2025-10-21T22:00","wave_height":0.2,"swell_height":0.12,"swell_direction":137,"sea_surface_temperature":20.3},{"time":"2025-10-21T23:00","wave_height":0.2,"swell_height":0.1,"swell_direction":140,"sea_surface_temperature":20.2}],"alerts":[],"advice":"Condizioni marine generalmente buone.","tides":{},"days":[{"day_label":"15/10","temp_max":"19.7","temp_min":"18.5","precipitation":"3.80","icon":"🌧️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.6,19.7,19.7,19.5,19.5,19.3,19.2,19.2,19.4,19.2,18.9,18.9,18.7,18.7,19.1,19.2,19.2,19.1,18.7,18.5,18.7,18.8,18.7,18.6],"hourly_winds":[7.1,5.4,4.6,5.7,5.5,7.1,5.8,4,4.2,6.2,8.1,12.2,12.3,11.8,12.9,11.7,12.6,13.5,14.7,14.7,15.8,18.9,22,21.8],"hourly_wind_directions":[60,42,45,55,58,75,83,90,59,54,45,47,52,59,67,72,70,65,59,62,63,51,52,51],"hourly_precips":[0,0,0,0,0,0,0,0,0.1,0.1,0.3,0.3,0.4,0.6,0.4,0.2,0.4,0.2,0.4,0.3,0.1,0,0,0],"hourly_pressures":[1018.7,1018.1,1018.3,1017.6,1017.6,1017.3,1017.5,1017.4,1017.5,1017.9,1018.1,1018.4,1018,1018.1,1016.8,1016.4,1016,1015.5,1015.9,1016.2,1016.5,1016.1,1015.7,1015.3],"pressure_avg":"1017.1"},{"day_label":"16/10","temp_max":"18.5","temp_min":"17.1","precipitation":"7.90","icon":"🌧️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[18.5,18.4,18.4,18.3,18.2,18.2,18.2,18.2,18.1,18,18.2,17.8,17.4,17.1,17.4,17.4,17.3,17.7,17.9,18,18.1,18,17.8,17.9],"hourly_winds":[21.6,20.5,19.7,20.7,21.5,22.1,21.9,21.9,22.2,22.3,24.7,25.2,22.7,19.2,19.6,22.3,21.1,22.3,22.3,20,18.3,17,17,16.8],"hourly_wind_directions":[53,52,50,50,50,56,54,54,58,51,56,56,54,52,47,56,44,34,34,30,22,17,5,350],"hourly_precips":[0,0,0,0,0,0,0,0.1,0.2,0.8,0.3,0.1,0.4,1.6,1.6,0.3,0.8,0.2,0.1,0.1,0.2,0.3,0.6,0.2],"hourly_pressures":[1015.2,1015,1015.2,1014.7,1014.4,1013.7,1013.4,1013.3,1013.7,1014,1014.3,1014.3,1014.2,1013.5,1013,1012.9,1012.9,1012.9,1012.7,1012.6,1012.6,1012.9,1012.9,1012.9],"pressure_avg":"1013.6"},{"day_label":"17/10","temp_max":"20.2","temp_min":"18.3","precipitation":"0.40","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[18.3,18.4,18.5,18.3,18.4,18.4,18.5,18.6,18.7,18.6,18.5,18.9,19.2,19.5,19.9,20.2,20.2,20.1,19.8,19.4,18.8,18.6,18.6,18.7],"hourly_winds":[18.4,18.6,18.9,18.2,19.1,19,17.3,16.4,17.3,18.9,16.3,13.1,11.4,10.9,10,9.7,10,8.5,8.8,4.1,1.5,0.4,2.6,4.3],"hourly_wind_directions":[348,350,347,351,348,350,348,345,337,336,338,344,342,343,345,333,319,298,279,285,284,270,146,114],"hourly_precips":[0.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0,0],"hourly_pressures":[1012.8,1012.5,1012.3,1012.1,1011.7,1011.7,1011.8,1011.9,1012.6,1013.4,1013.8,1013.9,1014.1,1014.1,1014.1,1014.3,1014.6,1014.9,1015.3,1015.7,1016.3,1016.9,1017.3,1017.5],"pressure_avg":"1014.0"},{"day_label":"18/10","temp_max":"19.3","temp_min":"18.3","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[18.8,18.7,18.7,18.5,18.5,18.6,18.5,18.5,18.4,18.4,18.3,18.6,18.8,19,19,19.1,19.2,19.1,19.2,19.2,19.3,19.2,19.1,19],"hourly_winds":[6,5.3,5.7,4.8,3.9,5.1,4.9,5.9,7.2,8.6,11,10.7,9.7,9.9,9.8,10,9.8,10.4,10.6,10.5,9,7.9,7.4,7.6],"hourly_wind_directions":[123,118,125,138,124,129,107,104,117,123,122,130,138,147,156,159,163,166,170,172,164,150,129,109],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1017.5,1017.5,1017.6,1017.7,1017.9,1018.2,1018.6,1019,1019.5,1020.2,1020.6,1020.9,1021.1,1020.9,1020.5,1020.1,1020.1,1020,1020,1020.1,1020.2,1020.4,1020.6,1020.7],"pressure_avg":"1019.6"},{"day_label":"19/10","temp_max":"21.6","temp_min":"17.8","precipitation":"0.00","icon":"☀️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[18.8,18.6,18.4,18.2,18.1,18,17.9,17.8,17.8,18,18.3,18.7,19.3,20,20.6,21.1,21.5,21.6,21.1,20.3,19.6,19.2,18.8,18.5],"hourly_winds":[7.6,7.5,7.9,8.5,8.7,9.2,9.9,10.9,12,13,14.3,14.3,12.2,9.9,8.4,8.4,9.4,10.9,13.2,16.3,17.6,16.5,14.3,12.5],"hourly_wind_directions":[93,73,60,54,52,48,46,46,46,44,43,43,47,57,65,59,50,44,45,47,47,46,43,39],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1020.7,1020.6,1020.4,1020.2,1019.9,1019.7,1019.6,1019.6,1019.7,1019.9,1020.2,1020.2,1019.8,1019.2,1018.6,1018.1,1017.7,1017.4,1017.4,1017.6,1017.7,1017.8,1017.8,1017.8],"pressure_avg":"1019.1"},{"day_label":"20/10","temp_max":"19.8","temp_min":"17.0","precipitation":"0.00","icon":"☀️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[18.2,17.9,17.7,17.5,17.4,17.3,17.1,17,17,17.2,17.5,17.9,18.3,18.9,19.2,19.8,19.7,19.6,19.6,19.6,19.6,19.6,19.6,19.5],"hourly_winds":[11.6,11,10.3,9.8,9.4,9.1,8.8,9,8.7,8.5,8,7,4.2,0.7,2.3,5.2,6.1,6.9,6.7,6.4,5.9,5.9,6.3,6.2],"hourly_wind_directions":[36,32,29,28,32,34,35,37,38,36,36,35,31,360,231,258,270,279,286,297,308,322,336,350],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1017.7,1017.6,1017.4,1017.1,1016.8,1016.5,1016.2,1016,1015.8,1015.8,1015.8,1015.7,1015.3,1014.8,1014.4,1013.9,1013.3,1012.9,1012.8,1012.8,1012.8,1012.8,1012.8,1012.8],"pressure_avg":"1015.0"},{"day_label":"21/10","temp_max":"20.4","temp_min":"17.2","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.2,18.7,18.4,18.1,17.9,17.7,17.5,17.3,17.2,17.4,17.8,18.2,18.7,19.3,19.8,20.1,20.3,20.4,20.2,20,19.8,19.7,19.7,19.6],"hourly_winds":[5.8,5.6,5.9,5.9,5.9,5.6,5.4,5.2,4.7,4.4,4.4,2.8,1.1,5.4,8.6,8.9,7.3,6.5,6.8,7.6,7.4,6.1,5.6,6.2],"hourly_wind_directions":[7,27,43,47,47,50,53,56,58,55,55,50,288,250,248,249,250,251,252,251,247,230,195,173],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1012.6,1012.4,1012.1,1011.8,1011.4,1011.2,1011.1,1011.1,1011.2,1011.5,1011.8,1012,1011.9,1011.6,1011.3,1011.2,1011.1,1011.1,1011.3,1011.5,1011.8,1012,1012.2,1012.3],"pressure_avg":"1011.6"}],"updated_at":"15/10/2025, 20:02:58"};
    let currentDayIndex = 0;
    function toggleDetail(id) {
      const el = document.getElementById(id);
      if (el.classList.contains("active")) {
        el.classList.remove("active");
      } else {
        document.querySelectorAll(".detail-section.active").forEach(x=>x.classList.remove("active"));
        el.classList.add("active");
      }
    }
    function windDirectionName(deg) {
      if (!deg && deg !== 0) return {name:"N/D", abbr:"--", arrow:"↕"};
      const directions = [
        {name:"Tramontana",abbr:"N",arrow:"⬇️"},
        {name:"Grecale",abbr:"NE",arrow:"↙️"},
        {name:"Levante",abbr:"E",arrow:"⬅️"},
        {name:"Scirocco",abbr:"SE",arrow:"↖️"},
        {name:"Ostro",abbr:"S",arrow:"⬆️"},
        {name:"Libeccio",abbr:"SO",arrow:"↗️"},
        {name:"Ponente",abbr:"O",arrow:"➡️"},
        {name:"Maestrale",abbr:"NO",arrow:"↘️"}
      ];
      return directions[Math.floor(((deg + 22.5) % 360)/45)] || {name:"N/D",abbr:"--",arrow:"↕"};
    }
    function mean(arr) {
      if (!arr || !arr.length) return 0;
      return arr.reduce((acc, val) => acc + val, 0) / arr.length;
    }
    function pressureTrend(arr) {
      if (!arr || arr.length < 5) return "N/D";
      const startAvg = (arr[0] + arr[1] + arr[2]) / 3;
      const endAvg = (arr[arr.length-3] + arr[arr.length-2] + arr[arr.length-1]) / 3;
      if (endAvg > startAvg + 1) return "in aumento ⬆️";
      if (startAvg > endAvg + 1) return "in calo ⬇️";
      return "stabile ◼️";
    }
    function rainIcon(mm) {
      if (mm < 0.1) return "";
      if (mm < 0.5) return "💧";
      if (mm < 1) return "💧💧";
      if (mm < 3) return "💧💧💧";
      return "💧💧💧💧";
    }
    function renderToday() {
      const d = DATA.days[currentDayIndex];
      const alerts = (DATA.alerts || []).join(", ") || "Nessuna allerta";
      const advice = DATA.advice || "";
      document.getElementById("todayBox").innerHTML = `
        <h2>${d.day_label} ${d.icon}</h2>
        <div><b>Max:</b> ${d.temp_max}°C • <b>Min:</b> ${d.temp_min}°C</div>
        <div><b>Pioggia:</b> ${d.precipitation} mm ${rainIcon(d.precipitation)}</div>
        <div><b>Vento max:</b> ${d.wind_max} km/h</div>
        <div><b>Pressione media:</b> ${d.pressure_avg} hPa (${pressureTrend(d.hourly_pressures)})</div>
        <div><b>Allerta:</b> ${alerts}</div>
        <div class="message"><b>Consiglio:</b> ${advice}</div>
      `;
    }
    function renderMiniDays() {
      const row1 = document.getElementById("miniRow1");
      const row2 = document.getElementById("miniRow2");
      row1.innerHTML = "";
      row2.innerHTML = "";
      DATA.days.forEach((d, i) => {
        const div = document.createElement("div");
        div.className = "mini-day-card" + (i === currentDayIndex ? " selected" : "");
        div.innerHTML = `
          <div class="date">${d.day_label} ${d.icon}</div>
          <div class="temps"><span style="color:#ffd472;">↑ ${d.temp_max}°</span> <span style="color:#6fd7f8;">↓ ${d.temp_min}°</span></div>
          <div class="wind-precip">
            <span style="color:#86caff;">💨 ${d.wind_max} km/h</span>
            <span style="color:#9fffe1;">${rainIcon(d.precipitation)} ${d.precipitation}mm</span>
          </div>
        `;
        div.onclick = () => {
          currentDayIndex = i;
          renderAll();
        };
        if (i === 0) {
          row1.appendChild(div);
        } else if (i <= 3) {
          row1.appendChild(div);
        } else {
          row2.appendChild(div);
        }
      });
    }
    // For brevity, basic toggling of detail sections and rendering of charts added below.
    function toggleDetail(id) {
      const detailSections = document.querySelectorAll(".detail-section");
      detailSections.forEach(s => {
        if (s.id === id) {
          s.classList.toggle("active");
        } else {
          s.classList.remove("active");
        }
      });
    }
    function renderWind() {
      const d = DATA.days[currentDayIndex];
      const hour = new Date().getHours();
      const windSpeed = d.hourly_winds?.[hour] || d.wind_max || 0;
      const windDeg = d.hourly_wind_directions?.[hour];
      const dirInfo = windDirectionName(windDeg);
      const container = document.getElementById("windBox");
      container.innerHTML = `
        <div class="box-title">🌬️ Vento</div>
        <div class="box-main-info">Corrente: <strong>${windSpeed} km/h</strong></div>
        <div class="box-sub-info">Direzione: <strong>${windDeg}°</strong> (${dirInfo.name}) ${dirInfo.arrow}</div>
        <button class="btn-detail" onclick="toggleDetail('wind-detail')">Dettagli / Grafico</button>
        <div class="detail-section" id="wind-detail">
          <svg width="120" height="120" viewBox="0 0 120 120" style="margin-bottom:8px;">
            ${['N','NE','E','SE','S','SO','O','NO'].map((t,i)=>{
              let angle = i * 45 * Math.PI/180;
              let x = 60 + Math.sin(angle)*48;
              let y = 60 - Math.cos(angle)*48;
              return `<text x="${x.toFixed(1)}" y="${y.toFixed(1)}" fill="#54e2ff" font-size="14" font-weight="bold" text-anchor="middle" dominant-baseline="middle">${t}</text>`;
            }).join('')}
            <line x1="60" y1="60" x2="${(60 + Math.sin((windDeg-180)*Math.PI/180)*40).toFixed(1)}" y2="${(60 - Math.cos((windDeg-180)*Math.PI/180)*40).toFixed(1)}" stroke="#33ccff" stroke-width="4" stroke-linecap="round"/>
          </svg>
          <div class="chart-container"><canvas id="windChart"></canvas></div>
          <div class="info-chips" id="wind-chips"></div>
        </div>
      `;
      setTimeout(()=>{
        const ctx = document.getElementById('windChart').getContext('2d');
        if(window.windChart) window.windChart.destroy();
        window.windChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: d.hourly_labels,
            datasets: [{
              label: 'Vento (km/h)',
              data: d.hourly_winds||[],
              borderColor: '#66E5FF',
              backgroundColor: 'rgba(90,184,255,0.12)',
              fill: true,
              tension: 0.22,
              pointRadius: 4,
              pointHoverRadius: 7
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {legend: {display: false},
              tooltip: {
                enabled: false,
                external: context => {
                  const container = document.getElementById('wind-chips');
                  const tooltip = context.tooltip;
                  if(tooltip.opacity === 0){
                    container.style.opacity = 0; return;
                  }
                  if(!tooltip.body) return;
                  const idx = tooltip.dataPoints[0].dataIndex;
                  container.innerHTML = `
                    <div class="info-chip chip-wind">Ora: ${d.hourly_labels[idx]}</div>
                    <div class="info-chip chip-wind">Velocità: ${d.hourly_winds[idx]} km/h</div>
                    <div class="info-chip chip-wind">Direzione: ${d.hourly_wind_directions[idx]}° (${windDirectionName(d.hourly_wind_directions[idx]).name})</div>`;
                  container.style.opacity = 1;
                }
              }
            },
            scales: {y: {beginAtZero:true}, x: {}},
            interaction: {mode: 'nearest', intersect: false},
            onHover: (evt, activeEls) => {
              if(activeEls.length === 0) {
                const container = document.getElementById('wind-chips');
                container.innerHTML = `<div class="info-chip chip-wind">Ora: --</div><div class="info-chip chip-wind">Velocità: --</div><div class="info-chip chip-wind">Direzione: --</div>`;
              }
            }
          }
        });
      });
    }
    // Similar updated implementations for rain, sea and press with toggle, charts, info-chips go here
    function renderRain() {
      const d = DATA.days[currentDayIndex];
      const container = document.getElementById('rainBox');
      container.innerHTML = `
        <div class="box-title">🌧️ Pioggia</div>
        <div class="box-main-info">Totale oggi: <strong>${d.precipitation.toFixed(1)} mm</strong> ${rainIcon(d.precipitation)}</div>
        <div class="box-sub-info">${d.precipitation > 0 ? "Possibile precipitazione" : "Nessuna pioggia significativa"}</div>
        <button class="btn-detail" onclick="toggleDetail('rain-detail')">Dettagli / Grafico</button>
        <div class="detail-section" id="rain-detail">
          <div class="chart-container"><canvas id="rainChart"></canvas></div>
          <div class="info-chips" id="rain-chips"></div>
        </div>
      `;
      setTimeout(() => {
        const ctx = document.getElementById('rainChart').getContext('2d');
        if(window.rainChart) window.rainChart.destroy();
        window.rainChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: d.hourly_labels,
            datasets: [{
              label: 'Precipitazioni (mm)',
              data: d.hourly_precips,
              backgroundColor: '#52c5f7',
              borderColor: '#52afe7',
              borderWidth: 2
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false },
              tooltip: {
                enabled: false,
                external: context => {
                  const container = document.getElementById('rain-chips');
                  const tooltip = context.tooltip;
                  if (tooltip.opacity === 0) {
                    container.style.opacity = 0;
                    return;
                  }
                  if (!tooltip.body) return;
                  const idx = tooltip.dataPoints[0].dataIndex;
                  container.innerHTML = `<div class="info-chip chip-rain">Ora: ${d.hourly_labels[idx]}</div>
                  <div class="info-chip chip-rain">Precipitazioni: ${d.hourly_precips[idx]} mm</div>`;
                  container.style.opacity = 1;
                }
              }
            },
            scales: { y: { beginAtZero: true }, x: {} },
            interaction: { mode: 'nearest', intersect: false }
          }
        });
      }, 50);
    }
    function renderSea() {
      const marineData = DATA.mergedHourly || [];
      const container = document.getElementById('seaBox');
      const waveMean = mean(marineData.map(m => m.wave_height));
      const seaTemp = mean(marineData.map(m => m.sea_surface_temperature));
      container.innerHTML = `
        <div class="box-title">🌊 Mare</div>
        <div class="box-main-info">Altezza media onda: <b>${waveMean.toFixed(2)} m</b></div>
        <div class="box-sub-info">Temperatura mare: <b>${seaTemp.toFixed(1)} °C</b></div>
        <button class="btn-detail" onclick="toggleDetail('sea-detail')">Dettagli / Grafico</button>
        <div class="detail-section" id="sea-detail">
          <div class="chart-container"><canvas id="seaChart"></canvas></div>
          <div class="info-chips">
            <div class="info-chip chip-temp">Hsig: ${waveMean.toFixed(2)} m</div>
            <div class="info-chip chip-temp">Temperatura: ${seaTemp.toFixed(1)} °C</div>
          </div>
        </div>
      `;
      setTimeout(() => {
        const ctx = document.getElementById('seaChart').getContext('2d');
        if (window.seaChart) window.seaChart.destroy();
        window.seaChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: marineData.map(m => m.time.slice(11, 16)),
            datasets: [
              {
                label: 'Altezza onda (m)',
                data: marineData.map(m => m.wave_height),
                borderColor: '#41f8bd',
                backgroundColor: 'rgba(34, 255, 170, 0.1)',
                fill: true,
                tension: 0.25,
                pointRadius: 2
              },
              {
                label: 'Swell (m)',
                data: marineData.map(m => m.swell_height),
                borderColor: '#21d08a',
                backgroundColor: 'rgba(34, 255, 170, 0.06)',
                fill: true,
                tension: 0.25,
                pointRadius: 2
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: true }
            },
            scales: {
              y: { beginAtZero: true },
              x: {}
            }
          }
        });
      }, 50);
    }
    function renderPress() {
      const d = DATA.days[currentDayIndex];
      const container = document.getElementById('pressBox');
      const arr = d.hourly_pressures || [];
      const pressMean = mean(arr);
      const pressTrend = pressureTrend(arr);
      container.innerHTML = `
        <div class="box-title">🔽 Pressione</div>
        <div class="box-main-info">Media oggi: <b>${pressMean.toFixed(1)} hPa</b></div>
        <div class="box-sub-info">Tendenza: ${pressTrend}</div>
        <button class="btn-detail" onclick="toggleDetail('press-detail')">Dettagli / Grafico</button>
        <div class="detail-section" id="press-detail">
          <div class="chart-container"><canvas id="pressChart"></canvas></div>
          <div class="info-chips">
            <div class="info-chip chip-press">Max: ${Math.max(...arr)} hPa</div>
            <div class="info-chip chip-press">Min: ${Math.min(...arr)} hPa</div>
          </div>
        </div>
      `;
      setTimeout(() => {
        const ctx = document.getElementById('pressChart').getContext('2d');
        if (window.pressChart) window.pressChart.destroy();
        window.pressChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: d.hourly_labels,
            datasets: [{
              label: 'Pressione (hPa)',
              data: arr,
              borderColor: '#ffd472',
              backgroundColor: 'rgba(255, 240, 51, 0.1)',
              fill: true,
              tension: 0.25,
              pointRadius: 2
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: { display: false }
            },
            scales: {
              y: { beginAtZero: false },
              x: {}
            }
          }
        });
      }, 50);
    }
    function renderFooter() {
      document.getElementById('footer').innerHTML = `Powered by Open-Meteo • UI by micheledv74 • Ultimo aggiornamento: <b>${DATA.updated_at}</b>`;
    }
    function renderAll() {
      renderToday();
      renderMiniDays();
      renderWind();
      renderRain();
      renderSea();
      renderPress();
      renderFooter();
    }
    function renderMiniDays() {
      const row1 = document.getElementById('miniRow1');
      const row2 = document.getElementById('miniRow2');
      row1.innerHTML = '';
      row2.innerHTML = '';
      DATA.days.forEach((d, i) => {
        const div = document.createElement('div');
        div.className = 'mini-day-card' + (i === currentDayIndex ? ' selected' : '');
        div.innerHTML = `
          <div class="date">${d.day_label} ${d.icon}</div>
          <div class="temps"><span style="color:#ffd472;">↑ ${d.temp_max}°</span> <span style="color:#6fd7f8;">↓ ${d.temp_min}°</span></div>
          <div class="wind-precip">
            <span style="color:#86caff;">💨 ${d.wind_max} km/h</span>
            <span style="color:#9fffe1;">${rainIcon(d.precipitation)} ${d.precipitation} mm</span>
          </div>
        `;
        div.addEventListener('click', () => {
          currentDayIndex = i;
          renderAll();
        });
        if (i === 0) row1.appendChild(div);
        else if (i <= 3) row1.appendChild(div);
        else row2.appendChild(div);
      });
    }
    renderAll();
  </script>
</body>
</html>
