<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes" />
  <title>Previsioni Procida - Dashboard Meteo</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Roboto&display=swap');
    html { box-sizing: border-box;} *,*:before,*:after { box-sizing: inherit; }
    body { font-family: 'Roboto', Arial, sans-serif; max-width: 1000px; margin: 0 auto; background: linear-gradient(135deg, #26365a, #3498db 92%); color: #f0f8ff; padding: 14px 2px 18px 2px; overflow-x: hidden; min-height: 100vh; }
    .header { font-family: 'Montserrat', sans-serif; font-size: 2.45em; font-weight: 900; text-align: center; color: #cfe9ff; text-shadow: 1px 2px 14px #09172a; letter-spacing: 2px; user-select: none; margin-bottom: 19px; }

    .dashboard {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto;
      gap: 30px 30px;
      justify-items: stretch;
      align-items: stretch;
      width: 98%;
      margin: 0 auto 20px auto;
      max-width: 900px;
    }
    .box {
      background: linear-gradient(125deg, #23406c 92%, #2e8cc9 100%);
      border-radius: 18px;
      box-shadow: 0 8px 26px 0 #06183970;
      padding: 24px 17px 22px 17px;
      min-width: 210px;
      min-height: 215px;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      transition: box-shadow 0.22s, transform 0.22s;
    }
    .box:focus-within,
    .box:hover {
      box-shadow: 0 0 25px #2c9efa99, 0 7px 24px #06183980;
      transform: translateY(-3px) scale(1.012);
      z-index: 2;
    }
    .box-title {
      font-size: 1.30rem;
      font-weight: 900;
      color: #b8f6ff;
      letter-spacing: 0.7px;
      margin-bottom: 8px;
      text-shadow: 1px 1px 7px #03182b56;
      font-family: 'Montserrat', sans-serif;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .box .main { font-weight: 700; font-size: 1.11em; color:#84dbff;}
    .box .desc { margin: 2px 0 0 0; font-size:1.01em; color:#c3ccdf;}
    .wind-info { font-weight: 700; font-size: 1.11em; margin: 0; display: flex; justify-content: center; gap: 12px; }
    .wind-info span { display: inline-block; }
    .wind-info .wind-speed { color: #84dbff; }
    .wind-info .wind-dir { color: #c3ccdf; }
    .folata-max { color: #84dbff; font-weight: 700; font-size: 1.11em; margin-top: 6px; }

    .detail-btn {
      margin: 12px 0 7px 0;
      background: linear-gradient(92deg,#137af7 60%,#269beb 100%);
      color: #fff;
      font-weight:600;
      font-size: 1.1em;
      border: 1.7px solid #a2d8ff;
      border-radius: 9px;
      padding: 10px 28px;
      cursor: pointer;
      outline: none;
      box-shadow: 0 2px 12px #16518545;
      transition: background 0.20s, box-shadow 0.18s;
    }
    .detail-btn:hover,
    .detail-btn:focus {
      background: linear-gradient(92deg,#269beb 20%,#137af7 100%);
      box-shadow: 0 0 18px #24aef7a1;
    }

    .box-summary, .box-summary-row, .box-summary-row2 {
      margin-top: 7px;
    }
    .box-summary-row span,
    .box-summary-row2 span {
      font-size: 1em;
    }

    .summary-label { font-weight: 700; }
    .summary-max { color: #ffd472; }
    .summary-min { color: #6fd7f8; }
    .summary-dir { color: #8effa6; }
    .summary-mean { color: #b6fffa; }
    .summary-range { color: #fee3a1; }
    .summary-std { color: #c2cafd;}
    .summary-trend-up { color: #09e889; }
    .summary-trend-down { color: #ff9a00; }
    .summary-trend-stable { color: #ffd472; }
    .summary-max-mm { color: #a1b4ff; }
    .summary-min-mm { color: #72b6cc; }
    .summary-hour { color: #e0deff;}
    .summary-temp { color: #ffb2e6;}
    .summary-celeste { color: #6fd7f8; }

    .detail-section { display: none; margin-top: 8px; width: 100%; }
    .detail-section.active { display: block; }
    .chart-wrap { width: 99%; max-width: 385px; margin: 0 auto 8px auto; border-radius: 13px; background: #213260d0; padding: 11px 5px 7px 5px;}

    .mini-days { display:flex; flex-wrap:wrap; gap:8px; margin:18px auto 7px auto; justify-content:center;}
    .mini-day { background: #0b1333b0; color: #c6f3ff; border-radius:11px; padding:9px 15px; font-size:1em; min-width:85px; box-shadow: 0 2px 8px #202b3b44; cursor: pointer; user-select: none; }
    .mini-day:hover { background: rgba(79, 117, 203, 0.47); }
    .mini-day.active { background: rgba(91, 144, 197, 0.78); box-shadow: 0 0 12px #dbefff; }

    .footer { margin-top: 32px; text-align: center; color: #dbefff; font-size: 17px; font-weight: 500; text-shadow: 0 2px 6px #283c5880; }

    @media (max-width: 880px) {
      .dashboard {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto auto auto;
        gap: 15px 0;
        max-width: none;
      }
    }
    @media (max-width: 800px) {
      .box { min-width: 180px; max-width: 97vw; }
    }
    @media (max-width: 650px) {
      .header { font-size: 1.17em; }
      .box { width: 100%; max-width: 98vw;}
    }
    @media (max-width: 600px) {
      .box { min-height: 174px; padding: 11px 4px 14px 4px; }
    }
    @media (max-width: 510px) {
      .mini-day { padding: 6px 5px; font-size: 0.93em;}
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="header">PREVISIONI METEO PROCIDA</div>
  <div class="dashboard">
    <section class="box vento" id="windbox"></section>
    <section class="box pioggia" id="rainbox"></section>
    <section class="box mare" id="seabox"></section>
    <section class="box pressione" id="pressbox"></section>
  </div>
  <div class="mini-days" id="miniDaysBox"></div>
  <div class="footer" id="footer"></div>

  <script>
   / --- DATI DIRETTI, NON ARRAY! ---
const DATA = {"mergedHourly":[{"time":"2025-10-17T00:00","wave_height":0.54,"swell_height":0.22,"swell_direction":139,"sea_surface_temperature":20.6},{"time":"2025-10-17T01:00","wave_height":0.48,"swell_height":0.2,"swell_direction":136,"sea_surface_temperature":20.6},{"time":"2025-10-17T02:00","wave_height":0.44,"swell_height":0.2,"swell_direction":134,"sea_surface_temperature":20.6},{"time":"2025-10-17T03:00","wave_height":0.42,"swell_height":0.18,"swell_direction":135,"sea_surface_temperature":20.6},{"time":"2025-10-17T04:00","wave_height":0.42,"swell_height":0.16,"swell_direction":136,"sea_surface_temperature":20.5},{"time":"2025-10-17T05:00","wave_height":0.4,"swell_height":0.14,"swell_direction":137,"sea_surface_temperature":20.5},{"time":"2025-10-17T06:00","wave_height":0.38,"swell_height":0.14,"swell_direction":87,"sea_surface_temperature":20.5},{"time":"2025-10-17T07:00","wave_height":0.34,"swell_height":0.12,"swell_direction":36,"sea_surface_temperature":20.5},{"time":"2025-10-17T08:00","wave_height":0.32,"swell_height":0.12,"swell_direction":346,"sea_surface_temperature":20.5},{"time":"2025-10-17T09:00","wave_height":0.3,"swell_height":0.1,"swell_direction":299,"sea_surface_temperature":20.5},{"time":"2025-10-17T10:00","wave_height":0.28,"swell_height":0.1,"swell_direction":253,"sea_surface_temperature":20.5},{"time":"2025-10-17T11:00","wave_height":0.26,"swell_height":0.08,"swell_direction":206,"sea_surface_temperature":20.6},{"time":"2025-10-17T12:00","wave_height":0.24,"swell_height":0.1,"swell_direction":262,"sea_surface_temperature":20.6},{"time":"2025-10-17T13:00","wave_height":0.22,"swell_height":0.14,"swell_direction":318,"sea_surface_temperature":20.6},{"time":"2025-10-17T14:00","wave_height":0.2,"swell_height":0.16,"swell_direction":14,"sea_surface_temperature":20.6},{"time":"2025-10-17T15:00","wave_height":0.18,"swell_height":0.14,"swell_direction":348,"sea_surface_temperature":20.6},{"time":"2025-10-17T16:00","wave_height":0.16,"swell_height":0.12,"swell_direction":321,"sea_surface_temperature":20.6},{"time":"2025-10-17T17:00","wave_height":0.14,"swell_height":0.1,"swell_direction":295,"sea_surface_temperature":20.6},{"time":"2025-10-17T18:00","wave_height":0.16,"swell_height":0.1,"swell_direction":294,"sea_surface_temperature":20.5},{"time":"2025-10-17T19:00","wave_height":0.2,"swell_height":0.1,"swell_direction":292,"sea_surface_temperature":20.5},{"time":"2025-10-17T20:00","wave_height":0.22,"swell_height":0.1,"swell_direction":291,"sea_surface_temperature":20.5},{"time":"2025-10-17T21:00","wave_height":0.22,"swell_height":0.12,"swell_direction":302,"sea_surface_temperature":20.5},{"time":"2025-10-17T22:00","wave_height":0.22,"swell_height":0.12,"swell_direction":312,"sea_surface_temperature":20.5},{"time":"2025-10-17T23:00","wave_height":0.22,"swell_height":0.14,"swell_direction":323,"sea_surface_temperature":20.5},{"time":"2025-10-18T00:00","wave_height":0.2,"swell_height":0.14,"swell_direction":311,"sea_surface_temperature":20.5},{"time":"2025-10-18T01:00","wave_height":0.18,"swell_height":0.14,"swell_direction":299,"sea_surface_temperature":20.4},{"time":"2025-10-18T02:00","wave_height":0.16,"swell_height":0.14,"swell_direction":287,"sea_surface_temperature":20.4},{"time":"2025-10-18T03:00","wave_height":0.16,"swell_height":0.14,"swell_direction":286,"sea_surface_temperature":20.4},{"time":"2025-10-18T04:00","wave_height":0.14,"swell_height":0.12,"swell_direction":285,"sea_surface_temperature":20.4},{"time":"2025-10-18T05:00","wave_height":0.14,"swell_height":0.12,"swell_direction":284,"sea_surface_temperature":20.4},{"time":"2025-10-18T06:00","wave_height":0.14,"swell_height":0.12,"swell_direction":283,"sea_surface_temperature":20.3},{"time":"2025-10-18T07:00","wave_height":0.14,"swell_height":0.12,"swell_direction":282,"sea_surface_temperature":20.3},{"time":"2025-10-18T08:00","wave_height":0.14,"swell_height":0.12,"swell_direction":281,"sea_surface_temperature":20.3},{"time":"2025-10-18T09:00","wave_height":0.14,"swell_height":0.12,"swell_direction":280,"sea_surface_temperature":20.3},{"time":"2025-10-18T10:00","wave_height":0.14,"swell_height":0.12,"swell_direction":278,"sea_surface_temperature":20.4},{"time":"2025-10-18T11:00","wave_height":0.14,"swell_height":0.12,"swell_direction":277,"sea_surface_temperature":20.4},{"time":"2025-10-18T12:00","wave_height":0.14,"swell_height":0.12,"swell_direction":277,"sea_surface_temperature":20.4},{"time":"2025-10-18T13:00","wave_height":0.14,"swell_height":0.12,"swell_direction":276,"sea_surface_temperature":20.4},{"time":"2025-10-18T14:00","wave_height":0.14,"swell_height":0.12,"swell_direction":276,"sea_surface_temperature":20.4},{"time":"2025-10-18T15:00","wave_height":0.14,"swell_height":0.12,"swell_direction":276,"sea_surface_temperature":20.4},{"time":"2025-10-18T16:00","wave_height":0.14,"swell_height":0.14,"swell_direction":276,"sea_surface_temperature":20.4},{"time":"2025-10-18T17:00","wave_height":0.14,"swell_height":0.14,"swell_direction":276,"sea_surface_temperature":20.4},{"time":"2025-10-18T18:00","wave_height":0.14,"swell_height":0.14,"swell_direction":277,"sea_surface_temperature":20.4},{"time":"2025-10-18T19:00","wave_height":0.14,"swell_height":0.14,"swell_direction":277,"sea_surface_temperature":20.3},{"time":"2025-10-18T20:00","wave_height":0.14,"swell_height":0.14,"swell_direction":278,"sea_surface_temperature":20.3},{"time":"2025-10-18T21:00","wave_height":0.14,"swell_height":0.14,"swell_direction":278,"sea_surface_temperature":20.3},{"time":"2025-10-18T22:00","wave_height":0.14,"swell_height":0.14,"swell_direction":279,"sea_surface_temperature":20.2},{"time":"2025-10-18T23:00","wave_height":0.14,"swell_height":0.14,"swell_direction":279,"sea_surface_temperature":20.2},{"time":"2025-10-19T00:00","wave_height":0.14,"swell_height":0.14,"swell_direction":279,"sea_surface_temperature":20.2},{"time":"2025-10-19T01:00","wave_height":0.14,"swell_height":0.12,"swell_direction":279,"sea_surface_temperature":20.2},{"time":"2025-10-19T02:00","wave_height":0.14,"swell_height":0.12,"swell_direction":279,"sea_surface_temperature":20.1},{"time":"2025-10-19T03:00","wave_height":0.14,"swell_height":0.12,"swell_direction":279,"sea_surface_temperature":20.1},{"time":"2025-10-19T04:00","wave_height":0.16,"swell_height":0.1,"swell_direction":278,"sea_surface_temperature":20.1},{"time":"2025-10-19T05:00","wave_height":0.16,"swell_height":0.1,"swell_direction":278,"sea_surface_temperature":20},{"time":"2025-10-19T06:00","wave_height":0.22,"swell_height":0.1,"swell_direction":278,"sea_surface_temperature":20},{"time":"2025-10-19T07:00","wave_height":0.26,"swell_height":0.08,"swell_direction":278,"sea_surface_temperature":20},{"time":"2025-10-19T08:00","wave_height":0.32,"swell_height":0.08,"swell_direction":278,"sea_surface_temperature":20},{"time":"2025-10-19T09:00","wave_height":0.32,"swell_height":0.08,"swell_direction":218,"sea_surface_temperature":20},{"time":"2025-10-19T10:00","wave_height":0.3,"swell_height":0.1,"swell_direction":158,"sea_surface_temperature":20},{"time":"2025-10-19T11:00","wave_height":0.3,"swell_height":0.1,"swell_direction":98,"sea_surface_temperature":20},{"time":"2025-10-19T12:00","wave_height":0.28,"swell_height":0.12,"swell_direction":74,"sea_surface_temperature":20},{"time":"2025-10-19T13:00","wave_height":0.24,"swell_height":0.16,"swell_direction":51,"sea_surface_temperature":20},{"time":"2025-10-19T14:00","wave_height":0.22,"swell_height":0.18,"swell_direction":27,"sea_surface_temperature":20},{"time":"2025-10-19T15:00","wave_height":0.2,"swell_height":0.14,"swell_direction":40,"sea_surface_temperature":20},{"time":"2025-10-19T16:00","wave_height":0.16,"swell_height":0.12,"swell_direction":54,"sea_surface_temperature":20},{"time":"2025-10-19T17:00","wave_height":0.14,"swell_height":0.08,"swell_direction":67,"sea_surface_temperature":20},{"time":"2025-10-19T18:00","wave_height":0.16,"swell_height":0.06,"swell_direction":70,"sea_surface_temperature":20},{"time":"2025-10-19T19:00","wave_height":0.18,"swell_height":0.06,"swell_direction":72,"sea_surface_temperature":19.9},{"time":"2025-10-19T20:00","wave_height":0.2,"swell_height":0.04,"swell_direction":75,"sea_surface_temperature":19.9},{"time":"2025-10-19T21:00","wave_height":0.2,"swell_height":0.06,"swell_direction":77,"sea_surface_temperature":19.9},{"time":"2025-10-19T22:00","wave_height":0.22,"swell_height":0.06,"swell_direction":80,"sea_surface_temperature":19.9},{"time":"2025-10-19T23:00","wave_height":0.22,"swell_height":0.08,"swell_direction":82,"sea_surface_temperature":19.9},{"time":"2025-10-20T00:00","wave_height":0.2,"swell_height":0.08,"swell_direction":53,"sea_surface_temperature":19.9},{"time":"2025-10-20T01:00","wave_height":0.2,"swell_height":0.1,"swell_direction":24,"sea_surface_temperature":19.8},{"time":"2025-10-20T02:00","wave_height":0.18,"swell_height":0.1,"swell_direction":355,"sea_surface_temperature":19.8},{"time":"2025-10-20T03:00","wave_height":0.16,"swell_height":0.1,"swell_direction":14,"sea_surface_temperature":19.8},{"time":"2025-10-20T04:00","wave_height":0.16,"swell_height":0.1,"swell_direction":32,"sea_surface_temperature":19.8},{"time":"2025-10-20T05:00","wave_height":0.14,"swell_height":0.1,"swell_direction":51,"sea_surface_temperature":19.8},{"time":"2025-10-20T06:00","wave_height":0.12,"swell_height":0.1,"swell_direction":13,"sea_surface_temperature":19.8},{"time":"2025-10-20T07:00","wave_height":0.12,"swell_height":0.08,"swell_direction":334,"sea_surface_temperature":19.8},{"time":"2025-10-20T08:00","wave_height":0.1,"swell_height":0.08,"swell_direction":296,"sea_surface_temperature":19.8},{"time":"2025-10-20T09:00","wave_height":0.1,"swell_height":0.08,"swell_direction":295,"sea_surface_temperature":19.8},{"time":"2025-10-20T10:00","wave_height":0.08,"swell_height":0.06,"swell_direction":295,"sea_surface_temperature":19.9},{"time":"2025-10-20T11:00","wave_height":0.08,"swell_height":0.06,"swell_direction":294,"sea_surface_temperature":19.9},{"time":"2025-10-20T12:00","wave_height":0.08,"swell_height":0.06,"swell_direction":294,"sea_surface_temperature":20},{"time":"2025-10-20T13:00","wave_height":0.06,"swell_height":0.04,"swell_direction":293,"sea_surface_temperature":20},{"time":"2025-10-20T14:00","wave_height":0.06,"swell_height":0.04,"swell_direction":293,"sea_surface_temperature":20},{"time":"2025-10-20T15:00","wave_height":0.06,"swell_height":0.04,"swell_direction":293,"sea_surface_temperature":20},{"time":"2025-10-20T16:00","wave_height":0.04,"swell_height":0.04,"swell_direction":292,"sea_surface_temperature":20},{"time":"2025-10-20T17:00","wave_height":0.04,"swell_height":0.04,"swell_direction":292,"sea_surface_temperature":20},{"time":"2025-10-20T18:00","wave_height":0.04,"swell_height":0.04,"swell_direction":292,"sea_surface_temperature":20},{"time":"2025-10-20T19:00","wave_height":0.04,"swell_height":0.04,"swell_direction":292,"sea_surface_temperature":20},{"time":"2025-10-20T20:00","wave_height":0.04,"swell_height":0.04,"swell_direction":292,"sea_surface_temperature":20},{"time":"2025-10-20T21:00","wave_height":0.04,"swell_height":0.04,"swell_direction":292,"sea_surface_temperature":20},{"time":"2025-10-20T22:00","wave_height":0.04,"swell_height":0.04,"swell_direction":292,"sea_surface_temperature":19.9},{"time":"2025-10-20T23:00","wave_height":0.04,"swell_height":0.04,"swell_direction":292,"sea_surface_temperature":19.9},{"time":"2025-10-21T00:00","wave_height":0.04,"swell_height":0.04,"swell_direction":292,"sea_surface_temperature":19.9},{"time":"2025-10-21T01:00","wave_height":0.04,"swell_height":0.02,"swell_direction":293,"sea_surface_temperature":19.9},{"time":"2025-10-21T02:00","wave_height":0.04,"swell_height":0.02,"swell_direction":293,"sea_surface_temperature":19.9},{"time":"2025-10-21T03:00","wave_height":0.06,"swell_height":0.02,"swell_direction":274,"sea_surface_temperature":19.9},{"time":"2025-10-21T04:00","wave_height":0.06,"swell_height":0.04,"swell_direction":255,"sea_surface_temperature":19.9},{"time":"2025-10-21T05:00","wave_height":0.08,"swell_height":0.04,"swell_direction":236,"sea_surface_temperature":19.8},{"time":"2025-10-21T06:00","wave_height":0.12,"swell_height":0.08,"swell_direction":237,"sea_surface_temperature":19.8},{"time":"2025-10-21T07:00","wave_height":0.16,"swell_height":0.1,"swell_direction":239,"sea_surface_temperature":19.8},{"time":"2025-10-21T08:00","wave_height":0.2,"swell_height":0.14,"swell_direction":240,"sea_surface_temperature":19.8},{"time":"2025-10-21T09:00","wave_height":0.22,"swell_height":0.16,"swell_direction":242,"sea_surface_temperature":19.8},{"time":"2025-10-21T10:00","wave_height":0.26,"swell_height":0.2,"swell_direction":243,"sea_surface_temperature":19.8},{"time":"2025-10-21T11:00","wave_height":0.28,"swell_height":0.22,"swell_direction":245,"sea_surface_temperature":19.8},{"time":"2025-10-21T12:00","wave_height":0.28,"swell_height":0.24,"swell_direction":247,"sea_surface_temperature":19.9},{"time":"2025-10-21T13:00","wave_height":0.3,"swell_height":0.24,"swell_direction":248,"sea_surface_temperature":19.9},{"time":"2025-10-21T14:00","wave_height":0.3,"swell_height":0.26,"swell_direction":250,"sea_surface_temperature":19.9},{"time":"2025-10-21T15:00","wave_height":0.32,"swell_height":0.26,"swell_direction":253,"sea_surface_temperature":19.9},{"time":"2025-10-21T16:00","wave_height":0.32,"swell_height":0.26,"swell_direction":257,"sea_surface_temperature":19.9},{"time":"2025-10-21T17:00","wave_height":0.34,"swell_height":0.26,"swell_direction":260,"sea_surface_temperature":19.9},{"time":"2025-10-21T18:00","wave_height":0.36,"swell_height":0.28,"swell_direction":258,"sea_surface_temperature":19.9},{"time":"2025-10-21T19:00","wave_height":0.36,"swell_height":0.32,"swell_direction":256,"sea_surface_temperature":19.9},{"time":"2025-10-21T20:00","wave_height":0.38,"swell_height":0.34,"swell_direction":254,"sea_surface_temperature":19.9},{"time":"2025-10-21T21:00","wave_height":0.42,"swell_height":0.34,"swell_direction":253,"sea_surface_temperature":19.9},{"time":"2025-10-21T22:00","wave_height":0.44,"swell_height":0.34,"swell_direction":253,"sea_surface_temperature":19.9},{"time":"2025-10-21T23:00","wave_height":0.48,"swell_height":0.34,"swell_direction":252,"sea_surface_temperature":19.9},{"time":"2025-10-22T00:00","wave_height":0.54,"swell_height":0.34,"swell_direction":245,"sea_surface_temperature":19.8},{"time":"2025-10-22T01:00","wave_height":0.58,"swell_height":0.32,"swell_direction":238,"sea_surface_temperature":19.8},{"time":"2025-10-22T02:00","wave_height":0.64,"swell_height":0.32,"swell_direction":231,"sea_surface_temperature":19.8},{"time":"2025-10-22T03:00","wave_height":0.64,"swell_height":0.34,"swell_direction":233,"sea_surface_temperature":19.8},{"time":"2025-10-22T04:00","wave_height":0.66,"swell_height":0.36,"swell_direction":236,"sea_surface_temperature":19.8},{"time":"2025-10-22T05:00","wave_height":0.66,"swell_height":0.38,"swell_direction":238,"sea_surface_temperature":19.8},{"time":"2025-10-22T06:00","wave_height":0.64,"swell_height":0.38,"swell_direction":235,"sea_surface_temperature":19.8},{"time":"2025-10-22T07:00","wave_height":0.6,"swell_height":0.38,"swell_direction":233,"sea_surface_temperature":19.8},{"time":"2025-10-22T08:00","wave_height":0.58,"swell_height":0.38,"swell_direction":230,"sea_surface_temperature":19.8},{"time":"2025-10-22T09:00","wave_height":0.54,"swell_height":0.38,"swell_direction":228,"sea_surface_temperature":19.8},{"time":"2025-10-22T10:00","wave_height":0.52,"swell_height":0.38,"swell_direction":226,"sea_surface_temperature":19.9},{"time":"2025-10-22T11:00","wave_height":0.48,"swell_height":0.38,"swell_direction":224,"sea_surface_temperature":19.9},{"time":"2025-10-22T12:00","wave_height":0.48,"swell_height":0.36,"swell_direction":222,"sea_surface_temperature":19.9},{"time":"2025-10-22T13:00","wave_height":0.46,"swell_height":0.36,"swell_direction":221,"sea_surface_temperature":20},{"time":"2025-10-22T14:00","wave_height":0.46,"swell_height":0.34,"swell_direction":219,"sea_surface_temperature":20},{"time":"2025-10-22T15:00","wave_height":0.46,"swell_height":0.38,"swell_direction":221,"sea_surface_temperature":20},{"time":"2025-10-22T16:00","wave_height":0.48,"swell_height":0.4,"swell_direction":223,"sea_surface_temperature":20},{"time":"2025-10-22T17:00","wave_height":0.48,"swell_height":0.44,"swell_direction":225,"sea_surface_temperature":20},{"time":"2025-10-22T18:00","wave_height":0.48,"swell_height":0.44,"swell_direction":226,"sea_surface_temperature":20},{"time":"2025-10-22T19:00","wave_height":0.5,"swell_height":0.46,"swell_direction":226,"sea_surface_temperature":20},{"time":"2025-10-22T20:00","wave_height":0.5,"swell_height":0.46,"swell_direction":227,"sea_surface_temperature":20},{"time":"2025-10-22T21:00","wave_height":0.5,"swell_height":0.46,"swell_direction":228,"sea_surface_temperature":20},{"time":"2025-10-22T22:00","wave_height":0.5,"swell_height":0.44,"swell_direction":228,"sea_surface_temperature":20},{"time":"2025-10-22T23:00","wave_height":0.5,"swell_height":0.44,"swell_direction":229,"sea_surface_temperature":20},{"time":"2025-10-23T00:00","wave_height":0.5,"swell_height":0.44,"swell_direction":230,"sea_surface_temperature":20},{"time":"2025-10-23T01:00","wave_height":0.48,"swell_height":0.42,"swell_direction":231,"sea_surface_temperature":20},{"time":"2025-10-23T02:00","wave_height":0.48,"swell_height":0.42,"swell_direction":232,"sea_surface_temperature":20},{"time":"2025-10-23T03:00","wave_height":0.48,"swell_height":0.38,"swell_direction":232,"sea_surface_temperature":20},{"time":"2025-10-23T04:00","wave_height":0.48,"swell_height":0.36,"swell_direction":231,"sea_surface_temperature":20},{"time":"2025-10-23T05:00","wave_height":0.48,"swell_height":0.32,"swell_direction":231,"sea_surface_temperature":20},{"time":"2025-10-23T06:00","wave_height":0.48,"swell_height":0.34,"swell_direction":233,"sea_surface_temperature":20},{"time":"2025-10-23T07:00","wave_height":0.48,"swell_height":0.36,"swell_direction":234,"sea_surface_temperature":20},{"time":"2025-10-23T08:00","wave_height":0.48,"swell_height":0.38,"swell_direction":236,"sea_surface_temperature":20},{"time":"2025-10-23T09:00","wave_height":0.48,"swell_height":0.38,"swell_direction":236,"sea_surface_temperature":20},{"time":"2025-10-23T10:00","wave_height":0.48,"swell_height":0.36,"swell_direction":237,"sea_surface_temperature":20},{"time":"2025-10-23T11:00","wave_height":0.48,"swell_height":0.36,"swell_direction":237,"sea_surface_temperature":20},{"time":"2025-10-23T12:00","wave_height":0.48,"swell_height":0.36,"swell_direction":238,"sea_surface_temperature":20.1},{"time":"2025-10-23T13:00","wave_height":0.46,"swell_height":0.34,"swell_direction":239,"sea_surface_temperature":20.1},{"time":"2025-10-23T14:00","wave_height":0.46,"swell_height":0.34,"swell_direction":240,"sea_surface_temperature":20.1},{"time":"2025-10-23T15:00","wave_height":0.44,"swell_height":0.32,"swell_direction":239,"sea_surface_temperature":20.1},{"time":"2025-10-23T16:00","wave_height":0.44,"swell_height":0.32,"swell_direction":238,"sea_surface_temperature":20.2},{"time":"2025-10-23T17:00","wave_height":0.42,"swell_height":0.3,"swell_direction":237,"sea_surface_temperature":20.2},{"time":"2025-10-23T18:00","wave_height":0.4,"swell_height":0.3,"swell_direction":237,"sea_surface_temperature":20.2},{"time":"2025-10-23T19:00","wave_height":0.4,"swell_height":0.3,"swell_direction":237,"sea_surface_temperature":20.2},{"time":"2025-10-23T20:00","wave_height":0.38,"swell_height":0.3,"swell_direction":237,"sea_surface_temperature":20.2},{"time":"2025-10-23T21:00","wave_height":0.38,"swell_height":0.3,"swell_direction":237,"sea_surface_temperature":20.2},{"time":"2025-10-23T22:00","wave_height":0.36,"swell_height":0.28,"swell_direction":237,"sea_surface_temperature":20.2},{"time":"2025-10-23T23:00","wave_height":0.36,"swell_height":0.28,"swell_direction":237,"sea_surface_temperature":20.2}],"alerts":[],"advice":"Condizioni marine generalmente buone.","tides":{},"days":[{"day_label":"17/10","temp_max":"20.3","temp_min":"17.5","precipitation":"0.20","icon":"‚õÖ","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[17.5,17.8,18,18.1,18.2,18.3,18.3,18.4,18.5,18.7,18.8,19,19.3,19.6,19.8,20.1,20.2,20.3,19.9,20,19.6,19.5,19.4,19.3],"hourly_winds":[18,16.8,16.6,15.1,15.5,15.5,15.5,15.5,15.2,15.5,15.2,15.4,15.1,13.6,12.3,10.8,11.2,10.8,11.2,11.3,9.9,7.9,7.2,7.2],"hourly_wind_directions":[26,10,5,3,3,4,1,355,355,356,356,349,342,349,345,345,356,2,356,9,10,3,360,3],"hourly_precips":[0.2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1014.2,1013.9,1013.6,1013.3,1012.9,1013,1013.1,1013.1,1013.5,1014.1,1014.7,1014.8,1015,1014.8,1014.9,1015.1,1015.2,1015.1,1015.7,1016.2,1016.6,1017,1017.4,1017.8],"pressure_avg":"1014.8"},{"day_label":"18/10","temp_max":"19.6","temp_min":"18.5","precipitation":"0.10","icon":"üå§Ô∏è","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.2,19.1,19.1,19,19,18.9,18.8,18.6,18.5,18.5,18.6,18.9,19,19.2,19.3,19.5,19.6,19.6,19.6,19.6,19.5,19.4,19.2,19.1],"hourly_winds":[6.2,5.6,3.5,2.6,3.7,3.3,3.8,4.8,5.4,5.8,6.5,6,3.3,5,5.6,6.6,7.1,7.3,6.5,6,4.7,5.4,6.5,8.1],"hourly_wind_directions":[10,15,24,34,29,41,49,63,82,112,124,123,139,159,153,158,156,160,161,155,122,90,87,69],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0.1,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1017.7,1017.8,1018,1017.9,1017.8,1018,1018.3,1018.6,1019.1,1019.8,1020.3,1020.5,1020.5,1020.2,1019.7,1019.3,1019,1018.9,1019.1,1019.6,1019.6,1019.6,1019.8,1019.9],"pressure_avg":"1019.1"},{"day_label":"19/10","temp_max":"21.1","temp_min":"17.4","precipitation":"0.00","icon":"‚òÄÔ∏è","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[18.9,18.6,18.2,18,17.8,17.7,17.6,17.5,17.4,17.5,17.9,18.6,19.3,20,20.7,21.1,21.1,21,20.7,20,19.4,18.9,18.5,18.1],"hourly_winds":[8.8,11.8,12,13.3,13.6,15.5,16.2,17.3,17.7,17.9,18.7,20.1,20.4,18.4,16.1,15.6,17.5,17.3,17.4,19.1,17.7,16.5,16.4,15.5],"hourly_wind_directions":[55,38,41,41,40,36,37,36,39,38,40,44,48,50,56,56,53,54,50,47,51,46,40,36],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1019.8,1019.4,1019.3,1018.9,1018.7,1018.5,1018.5,1018.3,1018.6,1018.9,1019,1018.7,1018.5,1017.9,1017.2,1016.7,1016.4,1016.4,1016.6,1016.9,1017.1,1017.1,1017.3,1017.3],"pressure_avg":"1018.0"},{"day_label":"20/10","temp_max":"19.4","temp_min":"16.9","precipitation":"0.00","icon":"‚òÄÔ∏è","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[17.8,17.6,17.5,17.4,17.3,17.2,17.1,16.9,16.9,17,17.3,17.7,18,18.4,18.8,19,19.2,19.3,19.3,19.2,19.2,19.2,19.4,19.4],"hourly_winds":[14.8,14,13.2,12.4,11.4,10.6,10.1,9.2,8.7,8.2,7.5,6.7,4.9,4.5,6.5,8.2,9.6,10,9.8,9,8,7.2,6.3,5.8],"hourly_wind_directions":[26,23,26,26,28,28,27,26,24,29,35,36,17,331,304,293,290,285,278,268,260,252,246,240],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1017.2,1016.8,1016.4,1016.2,1015.9,1015.8,1015.8,1015.8,1015.9,1016.1,1016.3,1016.4,1016.2,1015.8,1015.5,1015.2,1014.9,1014.7,1014.7,1014.9,1015.1,1015.3,1015.4,1015.5],"pressure_avg":"1015.7"},{"day_label":"21/10","temp_max":"20.5","temp_min":"19.0","precipitation":"0.30","icon":"‚õÖ","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.4,19.3,19.3,19.2,19.1,19,19,19.1,19.1,19.1,19,19,19.1,19.2,19.4,19.5,19.6,19.7,19.9,20.2,20.3,20.5,20.4,20.2],"hourly_winds":[6.6,7.7,8,7.1,5.6,4.4,4.3,4.5,5.4,7.3,10.4,12.6,13.4,13.6,13.4,13.2,12.9,12.4,11,10.1,9.7,24.5,27.1,29.6],"hourly_wind_directions":[241,242,243,240,230,215,204,194,184,169,160,156,160,163,166,163,157,154,161,174,184,154,155,156],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1],"hourly_pressures":[1015.5,1015.4,1015.3,1015,1014.6,1014.4,1014.4,1014.5,1014.7,1015,1015.3,1015.5,1015.4,1015.1,1014.9,1014.7,1014.5,1014.4,1014.4,1014.4,1014.4,1009.5,1009.1,1008.7],"pressure_avg":"1014.1"},{"day_label":"22/10","temp_max":"20.5","temp_min":"17.8","precipitation":"22.50","icon":"üå§Ô∏è","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.7,19.2,18.7,18.4,18.1,18,17.8,17.8,17.9,18.5,19.2,19.9,20.2,20.4,20.5,20.5,20.4,20.3,20.3,20.3,20.4,20.3,20.3,20.3],"hourly_winds":[32.4,34.9,35.6,33.9,32.5,31.6,30.9,29.4,27.2,22.7,16.6,10.4,4,3.2,8.1,10.5,11.2,12,12.7,13.4,14.5,16.6,19.2,20.5],"hourly_wind_directions":[156,155,152,143,129,117,109,102,97,94,91,90,95,243,257,264,272,279,285,290,293,292,287,285],"hourly_precips":[1.1,1.1,1.1,4.8,4.8,4.8,1.4,1.4,1.4,0,0,0,0.1,0.1,0.1,0,0,0,0,0,0,0.1,0.1,0.1],"hourly_pressures":[1008.3,1007.9,1007.4,1006.7,1005.9,1005.2,1004.7,1004.3,1004.2,1004.4,1004.8,1005.2,1005.4,1005.6,1005.8,1006,1006.3,1006.7,1007.3,1008,1008.6,1009.1,1009.6,1010],"pressure_avg":"1006.6"},{"day_label":"23/10","temp_max":"21.4","temp_min":"20.4","precipitation":"0.00","icon":"üå§Ô∏è","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[20.4,20.6,20.7,20.7,20.7,20.6,20.6,20.5,20.6,20.7,21,21.1,21.2,21.2,21.2,21.3,21.4,21.4,21.4,21.3,21.2,21.2,21.1,21.1],"hourly_winds":[19,15.7,12.9,10.7,8.8,7,4.8,2.5,1.1,0,1.5,2.5,5.4,10.2,12.8,11.9,9.7,9.2,9.4,9.8,10.4,11.2,11.9,12.7],"hourly_wind_directions":[285,286,288,290,289,291,297,315,342,270,194,225,266,278,280,270,248,222,203,188,178,174,175,173],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1010.3,1010.5,1010.8,1011.1,1011.4,1011.7,1012,1012.4,1012.8,1013.3,1013.7,1014.1,1014.3,1014.3,1014.3,1014.2,1014,1013.9,1014.2,1014.6,1014.9,1015.1,1015.2,1015.2],"pressure_avg":"1013.3"}],"updated_at":"17/10/2025, 01:21:35"};
const days = DATA.days;
const mergedHourly = DATA.mergedHourly || [];
const alerts = DATA.alerts || [];
const advice = DATA.advice || "";
const updated_at = DATA.updated_at;
let current = 0;
let tempChart = null, windChart = null, rainChart = null, marineChart = null;
    let windChart, rainChart, seaChart, pressChart;

    function rainIcon(valmm) {
      if (valmm < 0.1) return '';
      if (valmm < 0.5) return 'üíß';
      if (valmm < 1) return 'üíßüíß';
      if (valmm < 3) return 'üíßüíßüíß';
      if (valmm < 10) return 'üíßüíßüíßüíß';
      return 'üíßüíßüíßüíßüíß';
    }

    function windDirectionName(deg) {
      const winds = [
        { name: "Tramontana", abbr: "N" }, { name: "Grecale", abbr: "NE" },
        { name: "Levante", abbr: "E" }, { name: "Scirocco", abbr: "SE" },
        { name: "Ostro", abbr: "S" }, { name: "Libeccio", abbr: "SO" },
        { name: "Ponente", abbr: "O" }, { name: "Maestrale", abbr: "NO" }
      ];
      const idx = Math.floor(((deg + 22.5) % 360) / 45);
      return winds[idx] ? winds[idx].name + " (" + winds[idx].abbr + ")" : "N/D";
    }

    function calculateMean(arr) { if (!arr.length) return 0; return arr.reduce((a, b) => a + b, 0) / arr.length; }
    function calculateRange(arr) { if (!arr.length) return 0; return Math.max(...arr) - Math.min(...arr); }
    function calculateStdDev(arr) { if (!arr.length) return 0; const m = calculateMean(arr); return Math.sqrt(arr.reduce((a, b) => a + (b - m) ** 2, 0) / arr.length); }

    function pressureTrend(arr) {
      if (!arr || arr.length < 5) return "N/D";
      const meanStart = (arr[0] + arr[1] + arr[2]) / 3, meanEnd = (arr[arr.length - 3] + arr[arr.length - 2] + arr[arr.length - 1]) / 3;
      if (meanEnd > meanStart + 1) return '<span class="summary-trend-up">in aumento ‚¨ÜÔ∏è (alta)</span>';
      if (meanStart > meanEnd + 1) return '<span class="summary-trend-down">in calo ‚¨áÔ∏è (bassa)</span>';
      return '<span class="summary-trend-stable">stabile ‚ÜîÔ∏è</span>';
    }

    function toggleDetail(id) {
      let el = document.getElementById(id);
      document.querySelectorAll('.detail-section').forEach(e => {
        if (e !== el) e.classList.remove('active');
      });
      el.classList.toggle('active');
    }

    function renderMiniDays() {
      let html = "";
      DATA.days.forEach((d, i) => {
        html += `<div class="mini-day${i === selectedDayIndex ? " active" : ""}" onclick="selectDay(${i})">
            ${d.day_label} <span class="icon">${d.icon}</span>
          </div>`;
      });
      document.getElementById("miniDaysBox").innerHTML = html;
    }

    function selectDay(dayIndex) {
      selectedDayIndex = dayIndex;
      renderAll();
    }

    function renderWind() {
      const d = DATA.days[selectedDayIndex];
      const windSpeed = d.hourly_winds ? d.hourly_winds[new Date().getHours()] : d.wind_max || "--";
      const windDeg = d.hourly_wind_directions ? d.hourly_wind_directions[new Date().getHours()] : d.wind_dir || "--";
      const windDirTxt = windDirectionName(windDeg);
      const max = d.hourly_winds ? Math.max(...d.hourly_winds) : d.wind_max || "--";
      const min = d.hourly_winds ? Math.min(...d.hourly_winds) : d.wind_min || "--";
      const maxDir = d.hourly_wind_directions ? windDirectionName(Math.max(...d.hourly_wind_directions)) : windDirTxt;
      document.getElementById("windbox").innerHTML = `
        <div class="box-title">üå¨Ô∏è Vento ${d.day_label}</div>
        <p class="wind-info"><span class="wind-speed">üçÉ ${windSpeed} km/h</span><span class="wind-dir">‚éã ${windDeg}¬∞ ${windDirTxt}</span></p>
        <div class="folata-max">Folata max: <b>${d.wind_gust || d.wind_max || "--"} km/h</b></div>
        <button class="detail-btn" onclick="toggleDetail('wind-detail')">Dettagli / Grafico</button>
        <div class="detail-section" id="wind-detail"><div class="chart-wrap"><canvas id="windchart"></canvas></div></div>
        <div class="box-summary">
          <div class="box-summary-row">
            <span class="summary-label summary-max">Massimo: ${max} km/h</span>
            <span class="summary-label summary-min">Minimo: ${min} km/h</span>
          </div>
          <div class="box-summary-row2">
            <span class="summary-label summary-dir">Direzione max: ${maxDir}</span>
          </div>
        </div>
      `;
      if (windChart) windChart.destroy();
      const ctx = document.getElementById('windchart').getContext('2d');
      windChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: d.hourly_labels || [],
          datasets: [{
            label: 'Vento (km/h)',
            data: d.hourly_winds || [],
            borderColor: '#66E5FF',
            backgroundColor: 'rgba(90,184,255,0.12)',
            fill: true,
            tension: 0.21,
            pointRadius: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: true }, x: {} }
        }
      });
    }

    function renderRain() {
      const d = DATA.days[selectedDayIndex];
      const pioggia = d.precipitation || 0;
      const max = d.hourly_precips ? Math.max(...d.hourly_precips) : 0;
      const oraMax = d.hourly_labels && d.hourly_precips ? d.hourly_labels[d.hourly_precips.indexOf(max)] : '--';
      document.getElementById("rainbox").innerHTML = `
        <div class="box-title">üåßÔ∏è Pioggia ${d.day_label}</div>
        <div class="main">Totale oggi: <b>${pioggia.toFixed(1)} mm</b> ${rainIcon(pioggia)}</div>
        <div class="desc"><b>Max oraria:</b> ${max} mm &nbsp; <b>Ora pi√π piovosa:</b> ${oraMax}</div>
        <button class="detail-btn" onclick="toggleDetail('rain-detail')">Dettagli / Grafico</button>
        <div class="detail-section" id="rain-detail"><div class="chart-wrap"><canvas id="rainchart"></canvas></div></div>
        <div class="box-summary">
          <div class="box-summary-row">
            <span class="summary-label summary-max">Max oraria: ${max} mm</span>
            <span class="summary-label summary-hour">Ora pi√π piovosa: ${oraMax}</span>
          </div>
        </div>
      `;
      if (rainChart) rainChart.destroy();
      const ctx = document.getElementById('rainchart').getContext('2d');
      rainChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: d.hourly_labels || [],
          datasets: [{
            label: 'Precipitazioni (mm)',
            data: d.hourly_precips || [],
            backgroundColor: '#52c5f7',
            borderColor: '#52afe7',
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: true }, x: {} }
        }
      });
    }

    function renderSea() {
      const merged = DATA.sea[selectedDayIndex] || [];
      const waveMean = calculateMean(merged.map(h => h.wave_height));
      const waveRange = calculateRange(merged.map(h => h.wave_height));
      const waveStdDev = calculateStdDev(merged.map(h => h.wave_height));
      const seaTemp = calculateMean(merged.map(h => h.sea_surface_temperature));
      document.getElementById("seabox").innerHTML = `
        <div class="box-title">üåä Mare ${DATA.days[selectedDayIndex].day_label}</div>
        <div class="main">Altezza media onda: <b>${waveMean.toFixed(2)} m</b></div>
        <div class="desc">Temperatura mare: <b>${seaTemp.toFixed(1)} ¬∞C</b></div>
        <button class="detail-btn" onclick="toggleDetail('sea-detail')">Dettagli / Grafico</button>
        <div class="detail-section" id="sea-detail"><div class="chart-wrap"><canvas id="seachart"></canvas></div></div>
        <div class="box-summary">
          <div class="box-summary-row">
            <span class="summary-label summary-mean">Hsig: ${waveMean.toFixed(2)} m</span>
            <span class="summary-label summary-range">Range: ${waveRange.toFixed(2)} m</span>
            <span class="summary-label summary-std">Dev.Std.: ${waveStdDev.toFixed(2)} m</span>
          </div>
        </div>
      `;
      if (seaChart) seaChart.destroy();
      const ctx = document.getElementById('seachart').getContext('2d');
      seaChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: merged.map(h => h.time),
          datasets: [
            { label: 'Onda (m)', data: merged.map(h => h.wave_height), borderColor: '#41f8bd', backgroundColor: 'rgba(34,255,170,0.10)', fill: true, tension: 0.22, pointRadius: 2, pointBackgroundColor: '#25A9FA' },
            { label: 'Swell (m)', data: merged.map(h => h.swell_height), borderColor: '#21D08A', backgroundColor: 'rgba(34,255,170,0.06)', fill: true, tension: 0.18, pointRadius: 2, pointBackgroundColor: '#21D08A' }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: true } },
          scales: { y: { beginAtZero: true }, x: {} }
        }
      });
    }

    function renderPress() {
      const d = DATA.days[selectedDayIndex];
      const arr = d.hourly_pressures || [];
      const pressMean = calculateMean(arr);
      document.getElementById("pressbox").innerHTML = `
        <div class="box-title">üîΩ Pressione ${d.day_label}</div>
        <div class="main">Media oggi: <b>${pressMean.toFixed(1)} hPa</b></div>
        <div class="desc">Tendenza: ${pressureTrend(arr)}</div>
        <button class="detail-btn" onclick="toggleDetail('press-detail')">Dettagli / Grafico</button>
        <div class="detail-section" id="press-detail"><div class="chart-wrap"><canvas id="presschart"></canvas></div></div>
        <div class="box-summary">
          <div class="box-summary-row">
            <span class="summary-label summary-max">Max: ${Math.max(...arr)} hPa</span>
            <span class="summary-label summary-min">Min: ${Math.min(...arr)} hPa</span>
          </div>
        </div>
      `;
      if (pressChart) pressChart.destroy();
      const ctx = document.getElementById('presschart').getContext('2d');
      pressChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: d.hourly_labels || [],
          datasets: [{
            label: 'Pressione (hPa)',
            data: arr,
            borderColor: '#ffd472',
            backgroundColor: 'rgba(255,240,51,0.10)',
            fill: true,
            tension: 0.22,
            pointRadius: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: { legend: { display: false } },
          scales: { y: { beginAtZero: false }, x: {} }
        }
      });
    }

    function renderFooter() {
      document.getElementById("footer").innerHTML = `Powered by Open-Meteo ‚Ä¢ UI by micheledv74 ‚Ä¢ Ultimo agg.: <span id="updated_stamp">${DATA.days[0].day_label}</span>`;
    }

    function renderAll() {
      renderWind();
      renderRain();
      renderSea();
      renderPress();
      renderMiniDays();
      renderFooter();
    }

    renderAll();
  </script>
</body>
</html>
