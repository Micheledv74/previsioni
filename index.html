<script>
const DATA = {"mergedHourly":[{"time":"2025-10-12T00:00","wave_height":0.26,"swell_height":0.12,"swell_direction":211},{"time":"2025-10-12T01:00","wave_height":0.28,"swell_height":0.1,"swell_direction":210},{"time":"2025-10-12T02:00","wave_height":0.28,"swell_height":0.1,"swell_direction":210},{"time":"2025-10-12T03:00","wave_height":0.28,"swell_height":0.1,"swell_direction":177},{"time":"2025-10-12T04:00","wave_height":0.3,"swell_height":0.12,"swell_direction":145},{"time":"2025-10-12T05:00","wave_height":0.3,"swell_height":0.12,"swell_direction":112},{"time":"2025-10-12T06:00","wave_height":0.28,"swell_height":0.12,"swell_direction":108},{"time":"2025-10-12T07:00","wave_height":0.26,"swell_height":0.14,"swell_direction":105},{"time":"2025-10-12T08:00","wave_height":0.24,"swell_height":0.14,"swell_direction":101},{"time":"2025-10-12T09:00","wave_height":0.2,"swell_height":0.12,"swell_direction":102},{"time":"2025-10-12T10:00","wave_height":0.18,"swell_height":0.12,"swell_direction":104},{"time":"2025-10-12T11:00","wave_height":0.14,"swell_height":0.1,"swell_direction":105},{"time":"2025-10-12T12:00","wave_height":0.14,"swell_height":0.1,"swell_direction":107},{"time":"2025-10-12T13:00","wave_height":0.12,"swell_height":0.08,"swell_direction":110},{"time":"2025-10-12T14:00","wave_height":0.12,"swell_height":0.08,"swell_direction":112},{"time":"2025-10-12T15:00","wave_height":0.1,"swell_height":0.06,"swell_direction":143},{"time":"2025-10-12T16:00","wave_height":0.1,"swell_height":0.06,"swell_direction":173},{"time":"2025-10-12T17:00","wave_height":0.08,"swell_height":0.04,"swell_direction":204},{"time":"2025-10-12T18:00","wave_height":0.08,"swell_height":0.04,"swell_direction":205},{"time":"2025-10-12T19:00","wave_height":0.08,"swell_height":0.04,"swell_direction":207},{"time":"2025-10-12T20:00","wave_height":0.08,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-12T21:00","wave_height":0.08,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-12T22:00","wave_height":0.06,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-12T23:00","wave_height":0.06,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T00:00","wave_height":0.06,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T01:00","wave_height":0.04,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T02:00","wave_height":0.04,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T03:00","wave_height":0.04,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T04:00","wave_height":0.04,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T05:00","wave_height":0.04,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T06:00","wave_height":0.04,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T07:00","wave_height":0.04,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T08:00","wave_height":0.04,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T09:00","wave_height":0.04,"swell_height":0.04,"swell_direction":208},{"time":"2025-10-13T10:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T11:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T12:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T13:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T14:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T15:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T16:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T17:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T18:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T19:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T20:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T21:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T22:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-13T23:00","wave_height":0.04,"swell_height":0.02,"swell_direction":208},{"time":"2025-10-14T00:00","wave_height":0.04,"swell_height":0.02,"swell_direction":241},{"time":"2025-10-14T01:00","wave_height":0.04,"swell_height":0.02,"swell_direction":275},{"time":"2025-10-14T02:00","wave_height":0.04,"swell_height":0.02,"swell_direction":308},{"time":"2025-10-14T03:00","wave_height":0.04,"swell_height":0.02,"swell_direction":309},{"time":"2025-10-14T04:00","wave_height":0.04,"swell_height":0.04,"swell_direction":309},{"time":"2025-10-14T05:00","wave_height":0.04,"swell_height":0.04,"swell_direction":310},{"time":"2025-10-14T06:00","wave_height":0.04,"swell_height":0.04,"swell_direction":310},{"time":"2025-10-14T07:00","wave_height":0.04,"swell_height":0.04,"swell_direction":309},{"time":"2025-10-14T08:00","wave_height":0.04,"swell_height":0.04,"swell_direction":309},{"time":"2025-10-14T09:00","wave_height":0.04,"swell_height":0.04,"swell_direction":308},{"time":"2025-10-14T10:00","wave_height":0.04,"swell_height":0.04,"swell_direction":308},{"time":"2025-10-14T11:00","wave_height":0.04,"swell_height":0.04,"swell_direction":307},{"time":"2025-10-14T12:00","wave_height":0.04,"swell_height":0.04,"swell_direction":306},{"time":"2025-10-14T13:00","wave_height":0.04,"swell_height":0.04,"swell_direction":306},{"time":"2025-10-14T14:00","wave_height":0.04,"swell_height":0.04,"swell_direction":305},{"time":"2025-10-14T15:00","wave_height":0.04,"swell_height":0.04,"swell_direction":304},{"time":"2025-10-14T16:00","wave_height":0.04,"swell_height":0.02,"swell_direction":304},{"time":"2025-10-14T17:00","wave_height":0.04,"swell_height":0.02,"swell_direction":303},{"time":"2025-10-14T18:00","wave_height":0.04,"swell_height":0.02,"swell_direction":302},{"time":"2025-10-14T19:00","wave_height":0.04,"swell_height":0.02,"swell_direction":302},{"time":"2025-10-14T20:00","wave_height":0.04,"swell_height":0.02,"swell_direction":301},{"time":"2025-10-14T21:00","wave_height":0.04,"swell_height":0.02,"swell_direction":273},{"time":"2025-10-14T22:00","wave_height":0.02,"swell_height":0.02,"swell_direction":245},{"time":"2025-10-14T23:00","wave_height":0.02,"swell_height":0.02,"swell_direction":217},{"time":"2025-10-15T00:00","wave_height":0.02,"swell_height":0.02,"swell_direction":217},{"time":"2025-10-15T01:00","wave_height":0.02,"swell_height":0.02,"swell_direction":217},{"time":"2025-10-15T02:00","wave_height":0.02,"swell_height":0.02,"swell_direction":217},{"time":"2025-10-15T03:00","wave_height":0.02,"swell_height":0.02,"swell_direction":218},{"time":"2025-10-15T04:00","wave_height":0.04,"swell_height":0.02,"swell_direction":219},{"time":"2025-10-15T05:00","wave_height":0.04,"swell_height":0.02,"swell_direction":220},{"time":"2025-10-15T06:00","wave_height":0.04,"swell_height":0.02,"swell_direction":220},{"time":"2025-10-15T07:00","wave_height":0.04,"swell_height":0.04,"swell_direction":220},{"time":"2025-10-15T08:00","wave_height":0.04,"swell_height":0.04,"swell_direction":220},{"time":"2025-10-15T09:00","wave_height":0.06,"swell_height":0.04,"swell_direction":220},{"time":"2025-10-15T10:00","wave_height":0.06,"swell_height":0.06,"swell_direction":219},{"time":"2025-10-15T11:00","wave_height":0.08,"swell_height":0.06,"swell_direction":219},{"time":"2025-10-15T12:00","wave_height":0.08,"swell_height":0.08,"swell_direction":219},{"time":"2025-10-15T13:00","wave_height":0.1,"swell_height":0.08,"swell_direction":219},{"time":"2025-10-15T14:00","wave_height":0.1,"swell_height":0.1,"swell_direction":219},{"time":"2025-10-15T15:00","wave_height":0.12,"swell_height":0.1,"swell_direction":219},{"time":"2025-10-15T16:00","wave_height":0.12,"swell_height":0.12,"swell_direction":218},{"time":"2025-10-15T17:00","wave_height":0.14,"swell_height":0.12,"swell_direction":218},{"time":"2025-10-15T18:00","wave_height":0.14,"swell_height":0.12,"swell_direction":217},{"time":"2025-10-15T19:00","wave_height":0.16,"swell_height":0.14,"swell_direction":217},{"time":"2025-10-15T20:00","wave_height":0.16,"swell_height":0.14,"swell_direction":216},{"time":"2025-10-15T21:00","wave_height":0.22,"swell_height":0.14,"swell_direction":216},{"time":"2025-10-15T22:00","wave_height":0.3,"swell_height":0.14,"swell_direction":215},{"time":"2025-10-15T23:00","wave_height":0.36,"swell_height":0.14,"swell_direction":215},{"time":"2025-10-16T00:00","wave_height":0.38,"swell_height":0.14,"swell_direction":215},{"time":"2025-10-16T01:00","wave_height":0.38,"swell_height":0.14,"swell_direction":215},{"time":"2025-10-16T02:00","wave_height":0.4,"swell_height":0.14,"swell_direction":215},{"time":"2025-10-16T03:00","wave_height":0.42,"swell_height":0.14,"swell_direction":215},{"time":"2025-10-16T04:00","wave_height":0.46,"swell_height":0.14,"swell_direction":214},{"time":"2025-10-16T05:00","wave_height":0.48,"swell_height":0.14,"swell_direction":214},{"time":"2025-10-16T06:00","wave_height":0.52,"swell_height":0.16,"swell_direction":194},{"time":"2025-10-16T07:00","wave_height":0.54,"swell_height":0.2,"swell_direction":174},{"time":"2025-10-16T08:00","wave_height":0.58,"swell_height":0.22,"swell_direction":154},{"time":"2025-10-16T09:00","wave_height":0.58,"swell_height":0.26,"swell_direction":153},{"time":"2025-10-16T10:00","wave_height":0.6,"swell_height":0.3,"swell_direction":153},{"time":"2025-10-16T11:00","wave_height":0.6,"swell_height":0.34,"swell_direction":152},{"time":"2025-10-16T12:00","wave_height":0.58,"swell_height":0.36,"swell_direction":151},{"time":"2025-10-16T13:00","wave_height":0.54,"swell_height":0.38,"swell_direction":149},{"time":"2025-10-16T14:00","wave_height":0.52,"swell_height":0.4,"swell_direction":148},{"time":"2025-10-16T15:00","wave_height":0.5,"swell_height":0.4,"swell_direction":148},{"time":"2025-10-16T16:00","wave_height":0.5,"swell_height":0.42,"swell_direction":148},{"time":"2025-10-16T17:00","wave_height":0.48,"swell_height":0.42,"swell_direction":148},{"time":"2025-10-16T18:00","wave_height":0.5,"swell_height":0.42,"swell_direction":149},{"time":"2025-10-16T19:00","wave_height":0.54,"swell_height":0.4,"swell_direction":151},{"time":"2025-10-16T20:00","wave_height":0.56,"swell_height":0.4,"swell_direction":152},{"time":"2025-10-16T21:00","wave_height":0.58,"swell_height":0.38,"swell_direction":154},{"time":"2025-10-16T22:00","wave_height":0.6,"swell_height":0.38,"swell_direction":157},{"time":"2025-10-16T23:00","wave_height":0.62,"swell_height":0.36,"swell_direction":159},{"time":"2025-10-17T00:00","wave_height":0.6,"swell_height":0.36,"swell_direction":154},{"time":"2025-10-17T01:00","wave_height":0.56,"swell_height":0.36,"swell_direction":149},{"time":"2025-10-17T02:00","wave_height":0.54,"swell_height":0.36,"swell_direction":144},{"time":"2025-10-17T03:00","wave_height":0.54,"swell_height":0.34,"swell_direction":145},{"time":"2025-10-17T04:00","wave_height":0.52,"swell_height":0.34,"swell_direction":145},{"time":"2025-10-17T05:00","wave_height":0.52,"swell_height":0.32,"swell_direction":146},{"time":"2025-10-17T06:00","wave_height":0.52,"swell_height":0.3,"swell_direction":146},{"time":"2025-10-17T07:00","wave_height":0.5,"swell_height":0.28,"swell_direction":147},{"time":"2025-10-17T08:00","wave_height":0.5,"swell_height":0.26,"swell_direction":147},{"time":"2025-10-17T09:00","wave_height":0.46,"swell_height":0.24,"swell_direction":147},{"time":"2025-10-17T10:00","wave_height":0.44,"swell_height":0.24,"swell_direction":147},{"time":"2025-10-17T11:00","wave_height":0.4,"swell_height":0.22,"swell_direction":147},{"time":"2025-10-17T12:00","wave_height":0.36,"swell_height":0.2,"swell_direction":147},{"time":"2025-10-17T13:00","wave_height":0.34,"swell_height":0.2,"swell_direction":147},{"time":"2025-10-17T14:00","wave_height":0.3,"swell_height":0.18,"swell_direction":147},{"time":"2025-10-17T15:00","wave_height":0.26,"swell_height":0.16,"swell_direction":147},{"time":"2025-10-17T16:00","wave_height":0.24,"swell_height":0.16,"swell_direction":147},{"time":"2025-10-17T17:00","wave_height":0.2,"swell_height":0.14,"swell_direction":147},{"time":"2025-10-17T18:00","wave_height":0.18,"swell_height":0.12,"swell_direction":175},{"time":"2025-10-17T19:00","wave_height":0.16,"swell_height":0.1,"swell_direction":202},{"time":"2025-10-17T20:00","wave_height":0.14,"swell_height":0.08,"swell_direction":230},{"time":"2025-10-17T21:00","wave_height":0.14,"swell_height":0.08,"swell_direction":231},{"time":"2025-10-17T22:00","wave_height":0.14,"swell_height":0.08,"swell_direction":231},{"time":"2025-10-17T23:00","wave_height":0.14,"swell_height":0.08,"swell_direction":232},{"time":"2025-10-18T00:00","wave_height":0.14,"swell_height":0.08,"swell_direction":234},{"time":"2025-10-18T01:00","wave_height":0.12,"swell_height":0.06,"swell_direction":235},{"time":"2025-10-18T02:00","wave_height":0.12,"swell_height":0.06,"swell_direction":237},{"time":"2025-10-18T03:00","wave_height":0.12,"swell_height":0.06,"swell_direction":239},{"time":"2025-10-18T04:00","wave_height":0.1,"swell_height":0.04,"swell_direction":242},{"time":"2025-10-18T05:00","wave_height":0.1,"swell_height":0.04,"swell_direction":244},{"time":"2025-10-18T06:00","wave_height":0.1,"swell_height":0.04,"swell_direction":242},{"time":"2025-10-18T07:00","wave_height":0.08,"swell_height":0.04,"swell_direction":240},{"time":"2025-10-18T08:00","wave_height":0.08,"swell_height":0.04,"swell_direction":238},{"time":"2025-10-18T09:00","wave_height":0.08,"swell_height":0.04,"swell_direction":238},{"time":"2025-10-18T10:00","wave_height":0.1,"swell_height":0.06,"swell_direction":238},{"time":"2025-10-18T11:00","wave_height":0.1,"swell_height":0.06,"swell_direction":238},{"time":"2025-10-18T12:00","wave_height":0.1,"swell_height":0.06,"swell_direction":202},{"time":"2025-10-18T13:00","wave_height":0.12,"swell_height":0.08,"swell_direction":166},{"time":"2025-10-18T14:00","wave_height":0.12,"swell_height":0.08,"swell_direction":130},{"time":"2025-10-18T15:00","wave_height":0.14,"swell_height":0.08,"swell_direction":124},{"time":"2025-10-18T16:00","wave_height":0.16,"swell_height":0.06,"swell_direction":118},{"time":"2025-10-18T17:00","wave_height":0.18,"swell_height":0.06,"swell_direction":112},{"time":"2025-10-18T18:00","wave_height":0.18,"swell_height":0.08,"swell_direction":120},{"time":"2025-10-18T19:00","wave_height":0.18,"swell_height":0.08,"swell_direction":127},{"time":"2025-10-18T20:00","wave_height":0.18,"swell_height":0.1,"swell_direction":135},{"time":"2025-10-18T21:00","wave_height":0.18,"swell_height":0.12,"swell_direction":136},{"time":"2025-10-18T22:00","wave_height":0.2,"swell_height":0.16,"swell_direction":137},{"time":"2025-10-18T23:00","wave_height":0.2,"swell_height":0.18,"swell_direction":138}],"alerts":[],"advice":"Condizioni marine generalmente buone.","tides":{},"days":[{"day_label":"12/10","temp_max":"21.2","temp_min":"19.3","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[21.1,20.6,20.3,20.1,20,19.7,19.5,19.5,19.3,19.4,19.6,20,20.3,20.6,20.7,21,21.2,21.2,21,20.8,20.6,20.5,20.4,20.3],"hourly_winds":[8.1,9.2,10,11.6,12.3,11.4,10.4,9.1,8.9,8.1,6.6,5.4,3.5,3.4,4.6,5.1,4.9,4.5,4.1,4,4.2,4.3,4,3.1],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"13/10","temp_max":"21.1","temp_min":"19.4","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[20.2,20.1,19.9,19.8,19.7,19.6,19.5,19.5,19.4,19.5,19.7,20,20.2,20.4,20.5,21,21.1,20.9,20.8,20.7,20.7,20.7,20.7,20.4],"hourly_winds":[2.2,1.5,2.2,1.8,0.8,0.8,2.4,3.1,4,3.3,2.8,2.7,1.8,3.1,4.5,6.2,8,9,8.4,7.1,7.3,5.5,3.6,3.4],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"14/10","temp_max":"20.3","temp_min":"19.3","precipitation":"0.10","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[20.1,20,19.9,19.8,19.6,19.4,19.4,19.4,19.3,19.3,19.4,19.6,20,20.2,20.3,20.2,20.1,20.1,20,20.1,20.1,20,19.9,19.7],"hourly_winds":[2.3,3.3,4,5.4,5.4,4.1,3.8,4.4,4.7,5.4,5.9,6.1,7.1,7.9,8.1,7.9,9.2,9.7,7.9,4,3.6,2.5,4.5,4.8],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1]},{"day_label":"15/10","temp_max":"20.7","temp_min":"19.1","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.5,19.4,19.5,19.4,19.3,19.2,19.1,19.1,19.2,19.3,19.3,19.5,19.6,19.9,20.2,20.5,20.6,20.7,20.3,19.8,19.8,19.7,19.7,19.6],"hourly_winds":[5.4,6.8,6.4,8.4,8.7,9,8.6,7.9,8.1,10,11.8,11.6,12.1,12.1,12,11.6,11.9,13,13.2,12.2,8,7.4,8.3,10.1],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"16/10","temp_max":"19.5","temp_min":"17.1","precipitation":"26.10","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.5,19.3,19.1,18.9,18.6,18.4,18.1,17.7,17.5,17.3,17.1,17.1,17.4,17.8,18.1,18.2,18.1,18.1,18.2,18.3,18.4,18.4,18.3,18.3],"hourly_winds":[12.2,15,16.7,17,16.3,15.9,15,13.7,13.2,14.2,16.2,17.9,19.2,20.1,20.5,20.1,19.5,18.7,18.7,19.1,19.1,19.1,19.5,19.4],"hourly_precips":[0,0,0,0.3,0.3,0.3,1.4,1.4,1.4,2.3,2.3,2.3,2.4,2.4,2.4,0.5,0.5,0.5,0.4,0.4,0.4,1.4,1.4,1.4]},{"day_label":"17/10","temp_max":"20.5","temp_min":"18.3","precipitation":"15.90","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[18.3,18.4,18.6,18.8,19,19.2,19.1,19,19,19,19.1,19.3,19.5,19.8,20,20.2,19.9,19.8,19.9,20.2,20.4,20.5,20.4,20.4],"hourly_winds":[18.8,18.1,17.7,20,23.4,24.2,18.6,9.4,1.5,7.8,15.3,20.4,21.3,20.4,19.1,22.7,22.3,22.4,23.1,24.5,25.1,24.4,22.9,21.4],"hourly_precips":[0.9,0.9,0.9,1.8,1.8,1.8,2,2,2,0.6,0.6,0.6,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"18/10","temp_max":"20.5","temp_min":"18.7","precipitation":"0.90","icon":"🌤️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[20.4,20.5,20.5,20.4,20.4,20.3,20.3,20.2,20.1,19.9,19.6,19.5,19.6,19.9,20,19.9,19.7,19.5,19.4,19.3,19.1,19,18.8,18.7],"hourly_winds":[19.7,17.7,15.5,13.4,11.1,9.1,7.6,6.5,5.7,5.7,6.6,6.9,5.9,5.1,5.8,8,10.3,12.4,13.9,14.9,14.8,14,12.5,11],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0,0,0,0,0,0,0.2,0.2,0.2]}],"updated_at":"12/10/2025, 18:55:44"};
const days = DATA.days;
const mergedHourly = DATA.mergedHourly || [];
const alerts = DATA.alerts || [];
const advice = DATA.advice || "";
const updated_at = DATA.updated_at;
let current = 0;

// --- UTILITY ---
function rainIntensityIcon(valmm) {
  if (valmm < 0.1) return '';
  if (valmm < 0.5) return '💧';
  if (valmm < 1) return '💧💧';
  if (valmm < 3) return '💧💧💧';
  if (valmm < 10) return '💧💧💧💧';
  return '💧💧💧💧💧';
}
function windDescriptor(speed) {
  if (speed < 6) return "calmo";
  if (speed < 13) return "brezza";
  if (speed < 25) return "ventoso";
  return "molto forte";
}
function dailyAdvice(day) {
  if (parseFloat(day.precipitation) > 5.0) return "🗞️ Potrebbe piovere forte, porta un ombrello e valuta attività al coperto.";
  if (parseFloat(day.temp_max) >= 34) return "🗞️ Giornata molto calda: resta idratato e cerca zone ombreggiate.";
  if (parseFloat(day.temp_max) - parseFloat(day.temp_min) > 15) return "🗞️ Attenzione: forti escursioni termiche oggi.";
  if (parseFloat(day.precipitation) > 0.2) return "🗞️ Possibile pioggia, attività all'aperto da valutare.";
  if (parseFloat(day.temp_min) < 5) return "🗞️ Giornata fredda, copriti bene!";
  if (parseFloat(day.wind_max || 0) > 30) return "🗞️ Previsto vento molto forte, massima cautela!";
  return "🗞️ Giornata generalmente serena, goditela!";
}
function humanDirection(deg) {
  if (deg == null) return '--';
  const directions = ['N','NNE','NE','ENE','E','ESE','SE','SSE','S','SSW','SW','WSW','W','WNW','NW','NNW'];
  const ix = Math.round(deg / 22.5) % 16;
  return directions[ix];
}

// --- MARINE FILTER: Ritorna solo le ore marine del giorno selezionato ---
function getMarineDataForDay() {
  const day = days && days[current];
  if (!day || !mergedHourly.length) return [];
  // Estrapola la data giorno "2025-10-12" da uno degli oggetti mergedHourly
  let someTime = mergedHourly[0].time; // "2025-10-12T00:00"
  const pref_year = someTime.slice(0, 4);
  // Converte "12/10" in "2025-10-12"
  const [dd, mm] = day.day_label.split('/');
  const dateString = `${pref_year}-${mm.padStart(2,'0')}-${dd.padStart(2,'0')}`;
  return mergedHourly.filter(h => h.time && h.time.startsWith(dateString));
}

// --- SEZIONE METEO ---
function renderMainToday() {
  const d = days && days[current];
  if (!d) return;
  let tempData = d.hourly_temps || [];
  let windData = d.hourly_winds || [];
  let precipData = d.hourly_precips || [];
  let timeData = d.hourly_labels || [];
  const tmax = Math.max(...tempData);
  const tmin = Math.min(...tempData);
  const imax = tempData.indexOf(tmax);
  const imin = tempData.indexOf(tmin);
  const tmax_hh = imax !== -1 && timeData[imax] ? timeData[imax] : "--:--";
  const tmin_hh = imin !== -1 && timeData[imin] ? timeData[imin] : "--:--";
  const ptotal = precipData.reduce((a,b)=>a+b,0);
  const rainIcon = rainIntensityIcon(ptotal);
  const windmax = Math.max(...windData);
  const iwmax = windData.indexOf(windmax);
  const windmax_hh = iwmax !== -1 && timeData[iwmax] ? timeData[iwmax] : "--:--";
  const windlast = windData[windData.length-1];
  const advice = dailyAdvice({...d, wind_max: windmax});
  document.getElementById('maininfo').innerHTML = `
    <div class="slot-icon">
      <span class="main-icon">${d.icon}</span>
    </div>
    <div class="slots-info">
      <div class="slot-meteo">
        <div class="main-values">
          <span class="main-temp">${tmax.toFixed(1)}°</span>
          <span class="main-temp-min">${tmin.toFixed(1)}°</span>
        </div>
        <div class="main-details"><span class="rain-icon">🌧️</span> Precipitazioni: ${ptotal.toFixed(1)} mm ${rainIcon}</div>
      </div>
      <div class="slot-meteo">
        <div class="info-title">Temperature/Orari</div>
        <div class="data-up">↗️ max: <b>${tmax.toFixed(1)}°C</b> alle ${tmax_hh} </div>
        <div class="data-down">↘️ min: <b>${tmin.toFixed(1)}°C</b> alle ${tmin_hh}</div>
      </div>
      <div class="slot-meteo">
        <div class="info-title">Vento</div>
        <div class="data-wind">💨 max: <b>${windmax.toFixed(1)} km/h</b> (${windDescriptor(windmax)}) alle ${windmax_hh}</div>
        <div class="data-wind">💨 ora: <b>${windlast.toFixed(1)} km/h</b></div>
      </div>
      <div class="advice-row"><span class="main-advice">${advice}</span></div>
    </div>
  `;
}
function renderTabs() {
  const tabbar = document.getElementById('tabbar');
  tabbar.innerHTML = '';
  if (!days) return;
  days.forEach((d, idx) => {
    const el = document.createElement('div');
    el.className = idx === current ? 'tab active' : 'tab';
    el.role = 'tab';
    el.id = `tab-${idx}`;
    el.tabIndex = idx === current ? 0 : -1;
    el.setAttribute('aria-selected', idx === current ? 'true' : 'false');
    el.setAttribute('aria-controls', `tabpanel-${idx}`);
    el.setAttribute('aria-label', `Previsioni giorno ${d.day_label}`);
    el.innerHTML = `<div class="bigicon" aria-hidden="true">${d.icon}</div>
        <div>${d.day_label}</div>
        <div><span class="tempmax">${d.temp_max}°</span> <span class="tempmin">${d.temp_min}°</span></div>`;
    el.onclick = () => { switchTab(idx); };
    el.onkeydown = (e) => {
      if(e.key === 'ArrowRight') { switchTab((idx + 1) % days.length); }
      else if(e.key === 'ArrowLeft') { switchTab((idx - 1 + days.length) % days.length); }
      else if(e.key === "Enter" || e.key === " ") { switchTab(idx); }
    };
    tabbar.appendChild(el);
  });
}
function switchTab(idx) {
  current = idx;
  renderAll();
  const tab = document.getElementById(`tab-${idx}`);
  if(tab) tab.focus();
}
let tempChart = null, windChart = null, rainChart = null;
function renderCharts() {
  const d = days && days[current];
  if (!d) return;
  document.getElementById('chartcontainer').innerHTML =
    `<section class="card card-anim" role="region" aria-label="Grafico temperatura oraria">
      <div class="chart-title">Temperatura oraria (°C)</div>
      <div class="canvas-wrap"><canvas id="chart"></canvas></div>
      <div id="chartdesc" hidden>Grafico temperatura in gradi Celsius per ogni ora del giorno.</div>
    </section>`;
  const ctx1 = document.getElementById('chart').getContext('2d');
  if (tempChart) tempChart.destroy();
  tempChart = new Chart(ctx1, {
    type: 'line',
    data: {
      labels: d.hourly_labels,
      datasets: [{
        label: 'Temperatura (°C)',
        data: d.hourly_temps,
        borderColor: 'rgba(255,214,91,1)',
        backgroundColor: 'rgba(255,214,91,0.10)',
        fill: true,
        tension: 0.3,
        pointRadius: 2
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display:false }, tooltip: {mode:'index',intersect:false} },
      scales: {
        y: { beginAtZero: false, title: { display: true, text: '°C', color: '#fff' }, ticks: { color:'#fff', font: {weight:'bold'} }},
        x: { title: { display: true, text: 'Ora locale', color: '#fff' }, ticks: { color: '#fff', font: {weight:'bold', size:15}, maxRotation:0, minRotation:0 } }
      }
    }
  });

  document.getElementById('windchartcontainer').innerHTML =
    `<section class="card card-anim" role="region" aria-label="Grafico vento orario">
      <div class="chart-title">Vento orario (km/h)</div>
      <div class="canvas-wrap"><canvas id="windchart"></canvas></div>
      <div id="winddesc" hidden>Grafico velocità del vento in chilometri orari per ogni ora del giorno.</div>
    </section>`;
  const ctx2 = document.getElementById('windchart').getContext('2d');
  if (windChart) windChart.destroy();
  windChart = new Chart(ctx2, {
    type: 'line',
    data: {
      labels: d.hourly_labels,
      datasets: [{
        label: 'Vento (km/h)',
        data: d.hourly_winds,
        borderColor: 'rgba(90,184,255,1)',
        backgroundColor: 'rgba(90,184,255,0.18)',
        fill: true,
        tension: 0.3,
        pointRadius: 2
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display:false}, tooltip: {mode:'index',intersect:false} },
      scales: {
        y: { beginAtZero: true, title: { display: true, text: 'km/h', color: '#fff' }, ticks: { color:'#fff', font: {weight:'bold'} }},
        x: { title: { display: true, text: 'Ora locale', color: '#fff' }, ticks: { color: '#fff', font: {weight:'bold', size:15}, maxRotation:0, minRotation:0 } }
      }
    }
  });

  document.getElementById('rainchartcontainer').innerHTML =
    `<section class="card card-anim" role="region" aria-label="Grafico precipitazioni orarie">
      <div class="chart-title">Precipitazioni orarie (mm)</div>
      <div class="canvas-wrap"><canvas id="rainchart"></canvas></div>
      <div id="raindesc" hidden>Grafico precipitazioni in millimetri per ogni ora del giorno.</div>
    </section>`;
  const ctx3 = document.getElementById('rainchart').getContext('2d');
  if (rainChart) rainChart.destroy();
  rainChart = new Chart(ctx3, {
    type: 'bar',
    data: {
      labels: d.hourly_labels,
      datasets: [{
        label: 'Precipitazioni (mm)',
        data: d.hourly_precips,
        backgroundColor: 'rgba(30,180,255,0.73)',
        borderColor: 'rgba(13,80,180,1)',
        borderWidth: 1,
        minBarLength: 1
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display:false}, tooltip: {mode:'index',intersect:false} },
      scales: {
        y: { beginAtZero: true, title: { display: true, text: 'mm', color: '#fff' }, ticks: { color:'#fff', font: {weight:'bold'} }},
        x: { title: { display: true, text: 'Ora locale', color: '#fff' }, ticks: { color: '#fff', font: {weight:'bold', size:15}, maxRotation:0, minRotation:0 } }
      }
    }
  });
}

// --- SEZIONE MARINE sincrona con il giorno ---
let marineChart = null;
function renderMarine() {
  const marineForDay = getMarineDataForDay();
  const divSummary = document.getElementById('marine-summary');
  if (marineForDay.length) {
    const h = marineForDay[0];
    divSummary.textContent = `Altezza onda: ${(h.wave_height??0).toFixed(2)}m, direzione swell: ${humanDirection(h.swell_direction)} (${h.swell_direction??'-'}°), altezza swell: ${(h.swell_height??0).toFixed(2)}m.`;
  } else {
    divSummary.textContent = "Dati marine non disponibili.";
  }
  const ctx = document.getElementById('marine-wave-chart').getContext('2d');
  const labels = marineForDay.map(h => h.time && h.time.length > 11 ? h.time.slice(11, 16) : h.time || "");
  const waves = marineForDay.map(h => h.wave_height);
  const swells = marineForDay.map(h => h.swell_height);
  if (marineChart && marineChart.destroy) marineChart.destroy();
  marineChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [
        {
          label: 'Altezza onda (m)',
          borderColor: 'rgba(30,144,255,0.88)',
          backgroundColor: 'rgba(30,144,255,0.23)',
          fill: true, data: waves, tension: 0.3, pointRadius: 1.8,
        },
        {
          label: 'Altezza swell (m)',
          borderColor: 'rgba(8,206,120,0.86)',
          backgroundColor: 'rgba(60,255,210,0.12)',
          fill: true, data: swells, tension: 0.3, pointRadius: 1.8,
        }
      ]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      plugins: {
        legend: { labels: { color: '#a8cff8', font:{size:12} }, display: true},
        tooltip: { mode: 'index', intersect: false }
      },
      scales: {
        y: { beginAtZero: true, title: { display: true, text: 'm', color: '#a8cff8' }, ticks: { color: '#a8cff8', font: { size: 11 } } },
        x: { title: { display: false }, ticks: { color: '#a8cff8', font: { size: 10 }, maxTicksLimit: 8 } }
      }
    }
  });
  const divAlerts = document.getElementById('marine-alerts');
  if(alerts && alerts.length > 0) {
    divAlerts.innerHTML = alerts.map(a=>`⚠️ ${a.message}`).join('<br>');
  } else {
    divAlerts.textContent = `🗞️ ${advice}`;
  }
}

// --- RENDERING ALL ---
function renderAll() {
  if (!days || days.length === 0) {
    document.body.innerHTML = "<h2 style='color:#fff'>Nessun dato meteo disponibile!</h2>";
    return;
  }
  renderMainToday();
  renderTabs();
  renderCharts();
  renderMarine(); // sempre qui per sincronizzare!
  document.getElementById('footer').innerHTML = `Powered by Open-Meteo • UI by micheledv74 • Ultimo agg.: <span id="updated_stamp">${updated_at}</span>`;
}

// --- INIZIALIZZA ---
renderAll();
</script>
