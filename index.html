<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Previsioni Procida - Meteo Giornaliero</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@600;800&family=Roboto&display=swap');
    body {
      font-family: 'Roboto', Arial, sans-serif;
      max-width: 900px;
      margin: 40px auto;
      background: linear-gradient(135deg, #1c2c54, #2a3a7f 80%, #3498db 95%);
      color: #f0f8ff;
      padding: 20px;
      overflow-x: hidden;
    }
    .header {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.8rem;
      font-weight: 800;
      text-align: center;
      margin-bottom: 36px;
      color: #bce7ff;
      text-shadow: 2px 2px 8px #0a2b56;
      letter-spacing: 3px;
      user-select: none;
    }
    .tabs {
      display: flex;
      gap: 14px;
      margin-bottom: 34px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .tab {
      background: rgba(255, 255, 255, 0.18);
      border: 2.5px solid #61c8ff;
      padding: 16px 28px;
      border-radius: 14px;
      cursor: pointer;
      transition: background 0.3s, border-color 0.3s;
      box-shadow: 0 2px 16px #61c8ff40;
      min-width: 110px;
      display: flex;
      flex-direction: column;
      align-items: center;
      user-select: none;
    }
    .tab.active {
      background: #0580ff;
      color: #fff;
      border-color: #00aeff;
      box-shadow: 0 4px 28px #00c0ff88;
      font-weight: 700;
    }
    .tab:hover {
      background: #3399ff;
      border-color: #3399ff;
      box-shadow: 0 3px 26px #3399ff99;
    }
    .tab .bigicon {
      font-size: 2.2rem;
      margin-bottom: 4px;
      filter: drop-shadow(0 2px 5px #0378cccc);
      user-select: none;
    }
    .tab div {
      font-weight: 600;
      font-size: 1rem;
    }
    .tempmax {
      font-size: 1.1rem;
      font-weight: 800;
      letter-spacing: -0.7px;
      margin-right: 6px;
      color: #fff57d;
      user-select: text;
    }
    .tempmin {
      font-size: 0.9rem;
      color: #9bd9ff;
      font-weight: 600;
      user-select: text;
    }
    .card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 22px;
      padding: 30px 26px 24px 26px;
      margin-bottom: 28px;
      box-shadow: 0 4px 20px #0a1b3a88;
      display: flex;
      gap: 28px;
      align-items: center;
      animation: fadeIn 0.5s ease forwards;
      user-select: none;
      overflow: hidden;
      position: relative;
    }
    .card.underline {
      border-bottom: 3px solid #33aaffaa;
    }
    .bigicon {
      font-size: 96px;
      filter: drop-shadow(0 3px 9px #0592e8dd);
      user-select: none;
      flex-shrink: 0;
    }
    .tempmax.card-temp {
      font-size: 72px;
      font-weight: 900;
      letter-spacing: -1.5px;
      color: #ffea5a;
      text-shadow: 0 0 20px #ffc500aa;
      user-select: text;
    }
    .tempmin.card-temp {
      font-size: 36px;
      color: #7fcfff;
      font-weight: 700;
      user-select: text;
    }
    .details {
      font-size: 18px;
      color: #c1e9ffcc;
      line-height: 1.35;
      user-select: text;
    }
    .chart-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 6px;
      letter-spacing: 0.15em;
      color: #aaddff;
      text-shadow: 0 0 8px #0c2e62;
      user-select: none;
    }
    .chart-container {
      width: 100%;
      max-width: 900px;
      margin: 0 auto 28px auto;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }
    .canvas-wrap {
      width: 100%;
      aspect-ratio: 16/6;
      max-width: 100%;
      display: block;
      overflow: hidden;
      border-radius: 16px;
      position: relative;
      background: none;
    }
    canvas {
      width: 100% !important;
      height: 100% !important;
      display: block;
      background: rgba(255, 255, 255, 0.12);
      border-radius: 14px;
      box-shadow: 0 0 24px #2886d9bb;
      transition: box-shadow 0.3s ease;
      position: relative;
    }
    #daycard .bigicon {
      margin-bottom: 12px;
    }
    .footer {
      margin-top: 24px;
      text-align: center;
      color: #a9d2ffcc;
      font-size: 18px;
      font-weight: 600;
      user-select: none;
      text-shadow: 1px 1px 2px #00000065;
    }
    @keyframes fadeIn {
      from {opacity: 0; transform: translateY(25px);}
      to {opacity: 1; transform: translateY(0);}
    }
    @media (max-width: 700px) {
      .chart-container { max-width: 99vw; padding: 0 1vw;}
      .main-card, .card { font-size: 1em; }
      .bigicon { font-size: 55px; }
      .tempmax.card-temp { font-size: 48px; }
      .tempmin.card-temp { font-size: 24px; }
      .tab { padding: 10px 6px; font-size: 1em;}
      .canvas-wrap { aspect-ratio: 1.3/1;}
    }
    @media (orientation: landscape) and (max-width: 820px) {
      .chart-container { max-width: 97vw; min-width: 120px;}
      .canvas-wrap { aspect-ratio: 2/1; }
      canvas { min-height: 110px;}
    }
    ::selection {
      background: #81baffb3;
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="header">PREVISIONI METEO - PROCIDA</div>
<div id="tabbar" class="tabs" role="tablist" aria-label="Seleziona giorno previsioni"></div>
<div id="daycard" role="main" aria-live="polite"></div>
<div class="chart-container" id="chartcontainer"></div>
<div class="chart-container" id="windchartcontainer"></div>
<div class="chart-container" id="rainchartcontainer"></div>
<div class="footer" aria-label="Footer sito">Powered by Open-Meteo • UI by micheledv74</div>
<script>
const DATA = {"days":[{"day_label":"11/10","temp_max":"23.4","temp_min":"19.8","precipitation":"0.00","icon":"☀️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[21,20.9,20.8,20.7,20.3,19.9,19.9,19.9,19.8,20,20.5,21.4,22.2,22.8,23.4,23,21.6,21.8,21.6,21.6,21.4,21.3,21.1,21.3],"hourly_winds":[5.6,4.7,5.4,5.2,5.1,4.7,5.4,5.8,6.5,6.2,6.6,7.7,8.2,7.3,5.2,7.5,12.2,11.2,11.8,11.6,10,8,5.5,5.7],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"12/10","temp_max":"21.4","temp_min":"19.5","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[21,20.6,20.3,20.2,20,19.9,19.7,19.5,19.5,19.6,19.8,20.1,20.4,20.7,20.8,21.1,21.3,21.4,21.1,20.8,20.6,20.5,20.5,20.4],"hourly_winds":[8.3,8.9,9.4,10.2,11,11.3,11.3,10.2,9.2,8.1,7.1,5.5,3.7,4,4.9,4.8,4.8,6.9,7,6.2,6.2,5.9,4.5,2.9],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"13/10","temp_max":"21.1","temp_min":"19.3","precipitation":"0.00","icon":"☀️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[20.2,20,19.8,19.7,19.5,19.5,19.5,19.4,19.3,19.3,19.5,19.8,20.1,20.3,20.4,20.7,21.1,21,20.8,20.7,20.6,20.6,20.4,20.2],"hourly_winds":[2.1,2.2,2.9,2.5,2.5,2.2,2.5,2.5,3.3,3.6,3.2,2.1,0,1.1,2.4,5.2,8.3,9.4,9,7.1,7.4,6.5,4.3,2.9],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"14/10","temp_max":"20.3","temp_min":"19.1","precipitation":"0.00","icon":"☀️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[20,19.9,19.7,19.6,19.4,19.3,19.3,19.2,19.1,19.1,19.2,19.6,19.8,20.1,20.3,20.2,20.1,20,20,20,20,19.9,19.8,19.8],"hourly_winds":[3.2,3,3,4.7,3,3.3,3.7,4.1,4.7,5.8,5.8,5.5,6.4,6.5,7.3,8.6,9.4,9.8,6.3,1.8,2.2,3.5,5,5.8],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"15/10","temp_max":"21.8","temp_min":"18.8","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.7,19.7,19.6,19.6,19.6,19.6,19.6,19.5,19.5,19.5,19.6,19.8,20.3,20.9,21.4,21.7,21.8,21.7,21.2,20.6,20,19.5,19.1,18.8],"hourly_winds":[6.4,6.5,7.2,7.8,8.7,9.8,11.9,14,16.1,17.6,18.6,18.7,16.5,13.8,13,13.7,15.7,17.7,19.5,21.4,23.1,23.4,22.7,22.2],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"16/10","temp_max":"20.5","temp_min":"17.5","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[18.6,18.4,18.3,18.2,18.1,18,18,17.9,18,18.2,18.6,19.1,19.6,20.1,20.5,19,18.9,18.7,18.4,18,17.7,17.6,17.5,17.5],"hourly_winds":[22.3,22.1,22.4,22.9,23.8,24.3,23.8,23.1,22.6,22.8,23.3,23.2,22.4,21.8,21.6,24.5,23.1,21.3,19.9,18.7,17.7,16.1,14.5,13],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"17/10","temp_max":"19.5","temp_min":"16.6","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[17.5,17.4,17.3,17.2,17.1,16.9,16.8,16.6,16.6,16.9,17.4,17.9,18.5,19.1,19.5,19.5,19.3,19.2,19.2,19.2,19.2,19.1,19,18.9],"hourly_winds":[11.8,10.8,10,9.7,9.2,8.9,8.8,8.9,8.8,9,9,8.8,8.3,9.5,11.4,12.3,12.3,12,10.9,9.4,7.9,7.2,6.7,6.4],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}],"updated_at":"11/10/2025, 18:04:55"};
const days = DATA.days;
const updated_at = DATA.updated_at;
let current = 0;

function renderTabs() {
  const tabbar = document.getElementById('tabbar');
  tabbar.innerHTML = '';
  days.forEach((d, idx) => {
    const el = document.createElement('div');
    el.className = idx === current ? 'tab active' : 'tab';
    el.role = 'tab';
    el.id = `tab-${idx}`;
    el.tabIndex = idx === current ? 0 : -1;
    el.setAttribute('aria-selected', idx === current ? 'true' : 'false');
    el.setAttribute('aria-controls', `tabpanel-${idx}`);
    el.setAttribute('aria-label', `Previsioni giorno ${d.day_label}`);
    el.innerHTML = `<div class="bigicon" aria-hidden="true">${d.icon}</div>
        <div>${d.day_label}</div>
        <div><span class="tempmax">${d.temp_max}°</span> <span class="tempmin">${d.temp_min}°</span></div>`;
    el.onclick = () => { switchTab(idx); };
    el.onkeydown = (e) => {
      if(e.key === 'ArrowRight') { switchTab((idx + 1) % days.length); }
      else if(e.key === 'ArrowLeft') { switchTab((idx - 1 + days.length) % days.length); }
      else if(e.key === "Enter" || e.key === " ") { switchTab(idx); }
    };
    tabbar.appendChild(el);
  });
}

function switchTab(idx) {
  current = idx;
  renderAll();
  const tab = document.getElementById(`tab-${idx}`);
  if(tab) tab.focus();
}

function renderCard() {
  const d = days[current];
  const card = `<section class="card underline card-anim" role="tabpanel" id="tabpanel-${current}" tabindex="0" aria-labelledby="tab-${current}">
    <div style="display:flex;align-items:center;gap:28px;">
      <div class="bigicon" aria-hidden="true">${d.icon}</div>
      <div>
        <h2 class="tempmax card-temp">${d.temp_max}°C <span class="tempmin card-temp">${d.temp_min}°C</span></h2>
        <p class="details">Precipitazioni: ${d.precipitation} mm</p>
      </div>
    </div>
  </section>`;
  document.getElementById('daycard').innerHTML = card;
}

let tempChart = null, windChart = null, rainChart = null;

function renderCharts() {
  const d = days[current];
  document.getElementById('chartcontainer').innerHTML =
    `<section class="card card-anim" role="region" aria-label="Grafico temperatura oraria">
      <div class="chart-title">Temperatura oraria (°C)</div>
      <div class="canvas-wrap"><canvas id="chart"></canvas></div>
      <div id="chartdesc" hidden>Grafico temperatura in gradi Celsius per ogni ora del giorno.</div>
    </section>`;
  const ctx1 = document.getElementById('chart').getContext('2d');
  if (tempChart) tempChart.destroy();
  tempChart = new Chart(ctx1, {
    type: 'line',
    data: {
      labels: d.hourly_labels,
      datasets: [{
        label: 'Temperatura (°C)',
        data: d.hourly_temps,
        borderColor: 'rgba(255,214,91,1)',
        backgroundColor: 'rgba(255,214,91,0.15)',
        fill: true,
        tension: 0.3,
        pointRadius: 2
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display:false }, tooltip: {mode:'index',intersect:false} },
      scales: {
        y: { beginAtZero: false, title: { display: true, text: '°C', color: '#fff' }, ticks: { color:'#fff', font: {weight:'bold'} }},
        x: { title: { display: true, text: 'Ora locale', color: '#fff' }, ticks: { color: '#fff', font: {weight:'bold', size:15}, maxRotation:0, minRotation:0 } }
      }
    }
  });

  document.getElementById('windchartcontainer').innerHTML =
    `<section class="card card-anim" role="region" aria-label="Grafico vento orario">
      <div class="chart-title">Vento orario (km/h)</div>
      <div class="canvas-wrap"><canvas id="windchart"></canvas></div>
      <div id="winddesc" hidden>Grafico velocità del vento in chilometri orari per ogni ora del giorno.</div>
    </section>`;
  const ctx2 = document.getElementById('windchart').getContext('2d');
  if (windChart) windChart.destroy();
  windChart = new Chart(ctx2, {
    type: 'line',
    data: {
      labels: d.hourly_labels,
      datasets: [{
        label: 'Vento (km/h)',
        data: d.hourly_winds,
        borderColor: 'rgba(90,184,255,1)',
        backgroundColor: 'rgba(90,184,255,0.18)',
        fill: true,
        tension: 0.3,
        pointRadius: 2
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display:false}, tooltip: {mode:'index',intersect:false} },
      scales: {
        y: { beginAtZero: true, title: { display: true, text: 'km/h', color: '#fff' }, ticks: { color:'#fff', font: {weight:'bold'} }},
        x: { title: { display: true, text: 'Ora locale', color: '#fff' }, ticks: { color: '#fff', font: {weight:'bold', size:15}, maxRotation:0, minRotation:0 } }
      }
    }
  });

  document.getElementById('rainchartcontainer').innerHTML =
    `<section class="card card-anim" role="region" aria-label="Grafico precipitazioni orarie">
      <div class="chart-title">Precipitazioni orarie (mm)</div>
      <div class="canvas-wrap"><canvas id="rainchart"></canvas></div>
      <div id="raindesc" hidden>Grafico precipitazioni in millimetri per ogni ora del giorno.</div>
    </section>`;
  const ctx3 = document.getElementById('rainchart').getContext('2d');
  if (rainChart) rainChart.destroy();
  rainChart = new Chart(ctx3, {
    type: 'bar',
    data: {
      labels: d.hourly_labels,
      datasets: [{
        label: 'Precipitazioni (mm)',
        data: d.hourly_precips,
        backgroundColor: 'rgba(30,180,255,0.73)',
        borderColor: 'rgba(13,80,180,1)',
        borderWidth: 1,
        minBarLength: 1
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display:false}, tooltip: {mode:'index',intersect:false} },
      scales: {
        y: { beginAtZero: true, title: { display: true, text: 'mm', color: '#fff' }, ticks: { color:'#fff', font: {weight:'bold'} }},
        x: { title: { display: true, text: 'Ora locale', color: '#fff' }, ticks: { color: '#fff', font: {weight:'bold', size:15}, maxRotation:0, minRotation:0 } }
      }
    }
  });
}

function renderAll() {
  if (!days || days.length === 0) {
    document.body.innerHTML = "<h2 style='color:#fff'>Nessun dato meteo disponibile!</h2>";
    return;
  }
  renderTabs();
  renderCard();
  renderCharts();
  document.querySelector('.footer').textContent = `Powered by Open-Meteo • UI by micheledv74  • Ultimo agg.: ${updated_at}`;
}
renderAll();
</script>
</body>
</html>
