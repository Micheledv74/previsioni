<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meteo Procida - Previsioni 7 Giorni</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.12/css/weather-icons.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-gradient-start: #1c1c1e;
      --bg-gradient-end: #2c2c2e;
      --card-bg: rgba(255, 255, 255, 0.1);
      --card-border: rgba(255, 255, 255, 0.2);
      --text-primary: #ffffff;
      --text-secondary: #a0a0a0;
      --accent-blue: #007aff;
      --accent-green: #34c759;
      --accent-orange: #ff9500;
      --accent-red: #ff3b30;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
      color: var(--text-primary);
      min-height: 100vh;
      padding: 20px;
      line-height: 1.6;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    header {
      text-align: center;
      margin-bottom: 40px;
      padding: 30px 20px;
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      border: 1px solid var(--card-border);
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 1.1rem;
      color: var(--text-secondary);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--card-border);
      border-radius: 15px;
      padding: 20px;
      text-align: center;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      margin: 10px 0;
    }

    .stat-label {
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .days-container {
      display: grid;
      gap: 20px;
    }

    .day-card {
      background: var(--card-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--card-border);
      border-radius: 20px;
      padding: 25px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .day-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .day-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 1px solid var(--card-border);
    }

    .day-date {
      font-size: 1.3rem;
      font-weight: 600;
    }

    .day-temps {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .temp-high {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--accent-orange);
    }

    .temp-low {
      font-size: 1.3rem;
      color: var(--text-secondary);
    }

    .weather-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .weather-section {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 12px;
      padding: 15px;
    }

    .section-title {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.95rem;
      color: var(--text-secondary);
      margin-bottom: 10px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .weather-icon {
      font-size: 1.5rem;
    }

    .period-item {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
      padding: 10px;
      margin: 8px 0;
      font-size: 0.95rem;
    }

    .period-time {
      font-weight: 600;
      color: var(--accent-blue);
    }

    .intensity-leggera { color: var(--accent-green); }
    .intensity-moderata { color: var(--accent-orange); }
    .intensity-forte { color: var(--accent-red); }

    .summary-section {
      background: rgba(0, 0, 0, 0.2);
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
    }

    .summary-text {
      font-size: 1.05rem;
      line-height: 1.8;
      color: var(--text-primary);
    }

    .advice-list {
      list-style: none;
      margin-top: 15px;
    }

    .advice-item {
      background: rgba(0, 122, 255, 0.1);
      border-left: 3px solid var(--accent-blue);
      border-radius: 8px;
      padding: 12px 15px;
      margin: 10px 0;
      font-size: 0.95rem;
    }

    .alerts {
      background: rgba(255, 59, 48, 0.1);
      border-left: 3px solid var(--accent-red);
      border-radius: 8px;
      padding: 15px;
      margin: 15px 0;
    }

    .details-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }

    .detail-item {
      text-align: center;
      padding: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 8px;
    }

    .detail-value {
      font-size: 1.3rem;
      font-weight: 600;
      margin: 5px 0;
    }

    .detail-label {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    footer {
      text-align: center;
      margin-top: 40px;
      padding: 20px;
      color: var(--text-secondary);
      font-size: 0.9rem;
    }

    .error-message {
      background: rgba(255, 59, 48, 0.2);
      border: 1px solid var(--accent-red);
      border-radius: 15px;
      padding: 30px;
      text-align: center;
      margin: 20px 0;
    }

    @media (max-width: 768px) {
      h1 { font-size: 2rem; }
      .weather-grid { grid-template-columns: 1fr; }
      .stats-grid { grid-template-columns: 1fr 1fr; }
      .day-temps { flex-direction: column; gap: 5px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üåä Meteo Procida</h1>
      <div class="subtitle">
        <i class="wi wi-day-sunny"></i>
        <span>Previsioni 7 giorni - Analisi AI Multi-Fonte</span>
      </div>
    </header>

    <div id="stats-container"></div>
    <div id="forecast-container"></div>

    <footer>
      <p>Dati aggregati da Open-Meteo, Marine Open-Meteo, Weatherbit, Meteoblue e ilmeteo.it</p>
      <p>Analisi meteorologica professionale powered by AI</p>
      <p id="last-update"></p>
    </footer>
  </div>

  <script>
    // IMPORTANTE: In n8n, usa questa sintassi per iniettare i dati
    const weatherData = {"location":"Procida, Italia","generatedAt":"2025-10-21T10:30:00Z","days":[{"date":"2025-10-21","temp":{"min":17.5,"max":19.8,"feels_like":18.7},"rain":{"probability":85,"total_mm":11.5,"periods":[{"start":"09:15","end":"12:45","intensity":"moderata"},{"start":"15:45","end":"18:15","intensity":"leggera"}]},"wind":{"periods":[{"start":"00:00","end":"09:30","speed_kmh":20,"gusts_kmh":32,"direction":"SE","intensity":"moderato"},{"start":"09:30","end":"23:59","speed_kmh":28,"gusts_kmh":45,"direction":"S","intensity":"forte"}]},"pressure":{"value_hPa":1009,"trend":"in calo"},"sea":{"condition":"mosso","wave_height_m":1.4,"swell_direction":"Sud"},"humidity":88,"uv_index":3,"sunrise":"07:15","sunset":"18:08","moon_phase":"Luna calante","summary":"La giornata odierna a Procida sar√† caratterizzata da un cielo prevalentemente coperto con precipitazioni a intermittenza. Una prima fase di piogge moderate √® attesa tra le 09:15 e le 12:45, seguita da una pausa temporanea nel primo pomeriggio. Successivamente, tra le 15:45 e le 18:15, si manifesteranno piogge pi√π leggere. Il vento, inizialmente moderato da Sud-Est, rinforzer√† gradualmente dopo le 09:30, diventando forte da Sud con raffiche che potranno toccare i 45 km/h. La pressione atmosferica √® in diminuzione, indicando condizioni di instabilit√†. Il mare si presenter√† mosso per gran parte della giornata, con onde che potranno raggiungere 1.4 metri.","advice":["Si raccomanda di portare un ombrello o un impermeabile per l'intera giornata, con attenzione particolare alla mattinata.","A causa del vento forte e del mare mosso, si consiglia massima cautela per la navigazione e di evitare uscite con piccole imbarcazioni.","Assicurare oggetti esterni come vasi, tende da sole e arredi da giardino per prevenire danni dovuti alle raffiche di vento."],"alerts":[]},{"date":"2025-10-22","temp":{"min":16.8,"max":18.5,"feels_like":17.5},"rain":{"probability":30,"total_mm":1,"periods":[{"start":"03:00","end":"05:00","intensity":"leggera"}]},"wind":{"periods":[{"start":"00:00","end":"08:00","speed_kmh":35,"gusts_kmh":55,"direction":"S-SO","intensity":"forte"},{"start":"08:00","end":"16:00","speed_kmh":25,"gusts_kmh":40,"direction":"SO","intensity":"moderato"},{"start":"16:00","end":"23:59","speed_kmh":18,"gusts_kmh":28,"direction":"O","intensity":"leggero"}]},"pressure":{"value_hPa":1012,"trend":"in aumento"},"sea":{"condition":"molto mosso","wave_height_m":2.2,"swell_direction":"Sud-Ovest"},"humidity":80,"uv_index":4,"sunrise":"07:16","sunset":"18:07","moon_phase":"Luna calante","summary":"Mercoled√¨ 22 ottobre vedr√† Procida risentir ancora degli effetti della perturbazione notturna, con residue piogge leggere in attenuazione prima dell'alba. Il cielo tender√† a schiarirsi nel corso della mattinata, lasciando spazio a schiarite sempre pi√π ampie nel pomeriggio. Il vento sar√† il protagonista, forte da Sud-SudOvest nelle prime ore, con raffiche fino a 55 km/h, per poi diminuire gradualmente d'intensit√† e ruotare a Ovest nel tardo pomeriggio e sera. L'aumento della pressione indica un miglioramento generale. Le condizioni del mare rimarranno molto mosse per gran parte della giornata, con onde significative, ma si attender√† una progressiva attenuazione entro sera.","advice":["Prestare attenzione al forte vento nelle prime ore del giorno, specie se in prossimit√† di strutture esposte o alberi.","Il mare sar√† molto mosso: si sconsiglia vivamente qualsiasi attivit√† nautica o balneare.","Considerare che la visibilit√† potrebbe essere ridotta al mattino presto in caso di pioggia residua."],"alerts":["Vento forte al mattino","Mare molto mosso"]},{"date":"2025-10-23","temp":{"min":15,"max":17,"feels_like":16},"rain":{"probability":0,"total_mm":0,"periods":[]},"wind":{"periods":[{"start":"00:00","end":"10:00","speed_kmh":15,"gusts_kmh":25,"direction":"N-NO","intensity":"leggero"},{"start":"10:00","end":"23:59","speed_kmh":10,"gusts_kmh":20,"direction":"NO","intensity":"leggero"}]},"pressure":{"value_hPa":1018,"trend":"in aumento"},"sea":{"condition":"poco mosso","wave_height_m":0.8,"swell_direction":"Nord-Ovest"},"humidity":75,"uv_index":5,"sunrise":"07:17","sunset":"18:06","moon_phase":"Luna calante","summary":"Gioved√¨ si preannuncia una giornata serena e asciutta su Procida, grazie all'influenza di un'alta pressione in rafforzamento. Il cielo sar√† limpido o al pi√π velato da nubi alte, con ampi spazi di sole per l'intera giornata. Le temperature subiranno un lieve calo, soprattutto nelle minime notturne, attestandosi su valori pi√π freschi ma gradevoli. Il vento sar√† debole o al pi√π leggero, proveniente dai quadranti settentrionali, con raffiche quasi impercettibili. La pressione atmosferica continuer√† a salire, stabilizzando ulteriormente le condizioni meteo. Il mare, ancora leggermente mosso al mattino per la residuale onda lunga, tender√† a divenire poco mosso nel corso della giornata, con condizioni ideali per le attivit√† marittime.","advice":["Approfittare della giornata di sole per attivit√† all'aperto; non dimenticare una protezione solare leggera per le ore centrali.","Le condizioni marine saranno in miglioramento, favorevoli per gite in barca e attivit√† costiere.","Considerare le temperature pi√π fresche del mattino e della sera, specialmente se si prevede di stare all'aperto."],"alerts":[]},{"date":"2025-10-24","temp":{"min":15.5,"max":18,"feels_like":17},"rain":{"probability":0,"total_mm":0,"periods":[]},"wind":{"periods":[{"start":"00:00","end":"23:59","speed_kmh":8,"gusts_kmh":15,"direction":"Variabile","intensity":"leggero"}]},"pressure":{"value_hPa":1021,"trend":"stabile"},"sea":{"condition":"calmo","wave_height_m":0.3,"swell_direction":"Variabile"},"humidity":70,"uv_index":5,"sunrise":"07:18","sunset":"18:05","moon_phase":"Luna calante","summary":"Venerd√¨ su Procida sar√† una giornata all'insegna della stabilit√† e del bel tempo, con cielo sereno e temperature miti. L'alta pressione si manterr√† ben salda, garantendo assenza di nuvolosit√† significativa per l'intera durata del giorno. Le temperature massime si riporteranno su valori gradevoli, mentre le minime rimarranno fresche ma senza eccessi. Il vento sar√† molto debole, con direzione variabile e raffiche quasi assenti, rendendo l'aria particolarmente calma. La pressione atmosferica si manterr√† stabile su valori elevati. Le condizioni del mare saranno eccellenti, con assenza di onde e acque calme per tutta la giornata, ideali per ogni tipo di attivit√† marittima e per godersi il litorale procidano.","advice":["Giornata perfetta per escursioni, passeggiate e attivit√† ricreative all'aria aperta; non dimenticare gli occhiali da sole.","Le condizioni di mare calmo sono ottimali per la pesca, le immersioni e la balneazione (per i pi√π coraggiosi).","√à un buon momento per la manutenzione delle imbarcazioni o per spostamenti via mare, data l'assenza di vento e onde."],"alerts":[]},{"date":"2025-10-25","temp":{"min":16,"max":19,"feels_like":18},"rain":{"probability":40,"total_mm":0.5,"periods":[{"start":"21:00","end":"23:59","intensity":"leggera"}]},"wind":{"periods":[{"start":"00:00","end":"14:00","speed_kmh":12,"gusts_kmh":20,"direction":"E","intensity":"leggero"},{"start":"14:00","end":"23:59","speed_kmh":22,"gusts_kmh":35,"direction":"SE","intensity":"moderato"}]},"pressure":{"value_hPa":1017,"trend":"in lieve calo"},"sea":{"condition":"poco mosso","wave_height_m":0.6,"swell_direction":"Sud-Est"},"humidity":78,"uv_index":4,"sunrise":"07:19","sunset":"18:04","moon_phase":"Luna nuova","summary":"Sabato vedr√† un graduale cambiamento delle condizioni meteo su Procida, precursore di una nuova fase di instabilit√†. La mattinata sar√† ancora piuttosto soleggiata o con nubi sparse e temperature miti. Nel corso del pomeriggio, la nuvolosit√† aumenter√† progressivamente, e in serata √® prevista la possibilit√† di leggere piogge isolate, concentrate soprattutto dopo le 21:00. Il vento, che al mattino soffier√† leggero da Est, tender√† a rinforzare dal pomeriggio, divenendo moderato da Sud-Est con raffiche fino a 35 km/h. La pressione atmosferica inizier√† una lenta discesa. Il mare, inizialmente calmo o quasi, diverr√† poco mosso a partire dal pomeriggio, con un'onda lunga in formazione da Sud-Est.","advice":["Godetevi la mattinata all'aperto, ma tenete d'occhio l'evoluzione del cielo nel pomeriggio e preparatevi a eventuali piogge serali.","Chi intende uscire in barca nel pomeriggio o in serata dovr√† considerare l'aumento del vento e del moto ondoso.","Controllare gli aggiornamenti serali, la tendenza √® al peggioramento per la giornata successiva."],"alerts":[]},{"date":"2025-10-26","temp":{"min":14.5,"max":16.5,"feels_like":15},"rain":{"probability":95,"total_mm":20,"periods":[{"start":"02:00","end":"08:00","intensity":"moderata"},{"start":"10:00","end":"14:00","intensity":"forte"},{"start":"16:00","end":"22:00","intensity":"moderata"}]},"wind":{"periods":[{"start":"00:00","end":"10:00","speed_kmh":40,"gusts_kmh":60,"direction":"S-SO","intensity":"forte"},{"start":"10:00","end":"23:59","speed_kmh":50,"gusts_kmh":75,"direction":"SO","intensity":"molto forte"}]},"pressure":{"value_hPa":998,"trend":"in forte calo"},"sea":{"condition":"molto mosso","wave_height_m":2.8,"swell_direction":"Sud-Ovest"},"humidity":92,"uv_index":1,"sunrise":"07:20","sunset":"18:02","moon_phase":"Luna nuova","summary":"Domenica 26 ottobre sar√† una giornata di forte maltempo per Procida. Dalle prime ore del giorno si prevedono piogge diffuse, inizialmente moderate e poi intense tra le 10:00 e le 14:00, con accumuli significativi e possibili rovesci di forte intensit√†. Nel pomeriggio e sera le precipitazioni torneranno a essere moderate. Il vento sar√† l'elemento pi√π critico: inizialmente forte da Sud-SudOvest con raffiche fino a 60 km/h, subir√† un ulteriore rinforzo dopo le 10:00, diventando molto forte da Sud-Ovest, con raffiche estreme che potranno superare i 75 km/h. La pressione atmosferica croller√†, indicando una profonda depressione. Il mare sar√† agitato o molto agitato, con onde che potranno raggiungere quasi i 3 metri, rendendo la navigazione estremamente pericolosa. Massima allerta per l'intera giornata.","advice":["Evitare spostamenti non strettamente necessari e rimanere al riparo per l'intera giornata a causa delle intense piogge e del vento fortissimo.","Sospendere qualsiasi attivit√† nautica o balneare; il mare sar√† molto agitato e pericoloso.","Verificare il corretto ancoraggio di barche e natanti, e mettere in sicurezza qualsiasi oggetto esposto all'esterno che possa essere danneggiato o volare via a causa delle raffiche eccezionali."],"alerts":["ALLERTA ROSSA: Maltempo estremo, piogge abbondanti e persistenti","ALLERTA ROSSA: Vento molto forte con raffiche superiori a 75 km/h","ALLERTA ROSSA: Mare molto mosso o agitato con onde alte e pericolose"]},{"date":"2025-10-27","temp":{"min":13,"max":15.5,"feels_like":14},"rain":{"probability":60,"total_mm":5,"periods":[{"start":"00:00","end":"04:00","intensity":"moderata"},{"start":"04:00","end":"07:00","intensity":"leggera"}]},"wind":{"periods":[{"start":"00:00","end":"06:00","speed_kmh":45,"gusts_kmh":65,"direction":"O-SO","intensity":"molto forte"},{"start":"06:00","end":"14:00","speed_kmh":30,"gusts_kmh":50,"direction":"O","intensity":"forte"},{"start":"14:00","end":"23:59","speed_kmh":20,"gusts_kmh":35,"direction":"NO","intensity":"moderato"}]},"pressure":{"value_hPa":1005,"trend":"in aumento"},"sea":{"condition":"agitato","wave_height_m":3.2,"swell_direction":"Ovest"},"humidity":85,"uv_index":2,"sunrise":"07:21","sunset":"18:01","moon_phase":"Luna nuova","summary":"Luned√¨ 27 ottobre sar√† ancora una giornata perturbata per Procida, seppur con segnali di lento miglioramento nel corso del giorno. La notte e l'alba saranno caratterizzate da piogge moderate e poi leggere, che tenderanno a cessare entro la mattinata, lasciando spazio a cieli nuvolosi ma con occasionali schiarite pomeridiane. Le temperature subiranno un ulteriore calo, rendendo l'aria pi√π fredda e umida. Il vento rimarr√† molto forte da Ovest-SudOvest nelle prime ore, con raffiche fino a 65 km/h, per poi diminuire gradualmente d'intensit√† nel corso della giornata, pur mantenendosi forte o moderato. La pressione atmosferica inizier√† a risalire. Il mare, inizialmente agitato con onde oltre i 3 metri, si manterr√† molto mosso per gran parte del giorno, calando solo verso sera.","advice":["Nonostante un lieve miglioramento, le condizioni rimangono difficili: prestare massima attenzione ai residui di pioggia e al vento ancora intenso.","Evitare ancora attivit√† in mare aperto a causa del mare agitato e molto mosso; le condizioni rimarranno impegnative per i primi due terzi della giornata.","Indossare abbigliamento caldo e impermeabile, considerando il calo delle temperature e l'umidit√† elevata."],"alerts":["ALLERTA ARANCIONE: Vento forte e mare molto mosso/agitato","ALLERTA GIALLA: Piogge residue al mattino"]}],"processedAt":"2025-10-21T15:29:01.661Z","totalDays":7,"weekStats":{"maxTemp":19.8,"minTemp":13,"avgTemp":"17.8","rainyDays":5}};

    // Funzioni helper
    function formatDate(dateStr) {
      const date = new Date(dateStr);
      const giorni = ['Domenica', 'Luned√¨', 'Marted√¨', 'Mercoled√¨', 'Gioved√¨', 'Venerd√¨', 'Sabato'];
      const mesi = ['Gen', 'Feb', 'Mar', 'Apr', 'Mag', 'Giu', 'Lug', 'Ago', 'Set', 'Ott', 'Nov', 'Dic'];
      return `${giorni[date.getDay()]} ${date.getDate()} ${mesi[date.getMonth()]}`;
    }

    function getWeatherIcon(condition) {
      const icons = {
        'sereno': 'wi-day-sunny',
        'parzialmente nuvoloso': 'wi-day-cloudy',
        'nuvoloso': 'wi-cloudy',
        'pioggia': 'wi-rain',
        'temporale': 'wi-thunderstorm',
        'neve': 'wi-snow',
        'nebbia': 'wi-fog'
      };
      return icons[condition] || 'wi-day-cloudy';
    }

    function renderStats() {
      if (!weatherData || !weatherData.weekStats) return;
      const stats = weatherData.weekStats;
      
      const html = `
        <div class="stats-grid">
          <div class="stat-card">
            <i class="wi wi-thermometer weather-icon" style="color: var(--accent-orange);"></i>
            <div class="stat-value">${stats.maxTemp}¬∞C</div>
            <div class="stat-label">Temp. Massima</div>
          </div>
          <div class="stat-card">
            <i class="wi wi-thermometer-exterior weather-icon" style="color: var(--accent-blue);"></i>
            <div class="stat-value">${stats.minTemp}¬∞C</div>
            <div class="stat-label">Temp. Minima</div>
          </div>
          <div class="stat-card">
            <i class="wi wi-thermometer weather-icon" style="color: var(--accent-green);"></i>
            <div class="stat-value">${stats.avgTemp}¬∞C</div>
            <div class="stat-label">Temp. Media</div>
          </div>
          <div class="stat-card">
            <i class="wi wi-rain weather-icon" style="color: var(--accent-blue);"></i>
            <div class="stat-value">${stats.rainyDays}</div>
            <div class="stat-label">Giorni di Pioggia</div>
          </div>
        </div>
      `;
      
      document.getElementById('stats-container').innerHTML = html;
    }

    function renderForecast() {
      if (!weatherData || !weatherData.days) {
        document.getElementById('forecast-container').innerHTML = `
          <div class="error-message">
            <h2>‚ö†Ô∏è Errore nel caricamento dei dati</h2>
            <p>Impossibile recuperare le previsioni meteo. Riprova pi√π tardi.</p>
          </div>
        `;
        return;
      }

      const html = weatherData.days.map(day => `
        <div class="day-card">
          <div class="day-header">
            <div class="day-date">${formatDate(day.date)}</div>
            <div class="day-temps">
              <span class="temp-high">${day.temp?.max || '--'}¬∞</span>
              <span class="temp-low">${day.temp?.min || '--'}¬∞</span>
            </div>
          </div>

          <div class="weather-grid">
            ${day.rain && day.rain.periods && day.rain.periods.length > 0 ? `
              <div class="weather-section">
                <div class="section-title">
                  <i class="wi wi-rain weather-icon"></i>
                  Precipitazioni (${day.rain.probability}% - ${day.rain.total_mm}mm)
                </div>
                ${day.rain.periods.map(p => `
                  <div class="period-item">
                    <span class="period-time">${p.start} - ${p.end}</span>
                    <span class="intensity-${p.intensity}"> ‚Ä¢ ${p.intensity}</span>
                  </div>
                `).join('')}
              </div>
            ` : ''}

            ${day.wind && day.wind.periods ? `
              <div class="weather-section">
                <div class="section-title">
                  <i class="wi wi-strong-wind weather-icon"></i>
                  Vento
                </div>
                ${day.wind.periods.map(p => `
                  <div class="period-item">
                    <span class="period-time">${p.start} - ${p.end}</span><br>
                    <i class="wi wi-wind towards-${p.direction.toLowerCase()}-deg"></i>
                    ${p.direction} ${p.speed_kmh}km/h
                    <span class="intensity-${p.intensity}"> (${p.intensity})</span>
                  </div>
                `).join('')}
              </div>
            ` : ''}

            ${day.sea ? `
              <div class="weather-section">
                <div class="section-title">
                  <i class="wi wi-tsunami weather-icon"></i>
                  Condizioni Mare
                </div>
                <div class="period-item">
                  <strong>${day.sea.condition}</strong><br>
                  Onde: ${day.sea.wave_height_m}m<br>
                  Direzione: ${day.sea.swell_direction}
                </div>
              </div>
            ` : ''}
          </div>

          <div class="details-grid">
            <div class="detail-item">
              <i class="wi wi-barometer weather-icon"></i>
              <div class="detail-value">${day.pressure?.value_hPa || '--'}</div>
              <div class="detail-label">hPa ${day.pressure?.trend || ''}</div>
            </div>
            <div class="detail-item">
              <i class="wi wi-humidity weather-icon"></i>
              <div class="detail-value">${day.humidity || '--'}%</div>
              <div class="detail-label">Umidit√†</div>
            </div>
            <div class="detail-item">
              <i class="wi wi-day-sunny weather-icon"></i>
              <div class="detail-value">${day.uv_index || '--'}</div>
              <div class="detail-label">UV Index</div>
            </div>
            <div class="detail-item">
              <i class="wi wi-sunrise weather-icon"></i>
              <div class="detail-value">${day.sunrise || '--'}</div>
              <div class="detail-label">Alba</div>
            </div>
            <div class="detail-item">
              <i class="wi wi-sunset weather-icon"></i>
              <div class="detail-value">${day.sunset || '--'}</div>
              <div class="detail-label">Tramonto</div>
            </div>
            <div class="detail-item">
              <i class="wi wi-moon-alt-new weather-icon"></i>
              <div class="detail-label">${day.moon_phase || 'N/D'}</div>
            </div>
          </div>

          ${day.summary ? `
            <div class="summary-section">
              <div class="section-title">
                <i class="wi wi-cloud weather-icon"></i>
                Analisi Meteorologica
              </div>
              <p class="summary-text">${day.summary}</p>
            </div>
          ` : ''}

          ${day.advice && day.advice.length > 0 ? `
            <ul class="advice-list">
              ${day.advice.map(a => `<li class="advice-item">üí° ${a}</li>`).join('')}
            </ul>
          ` : ''}

          ${day.alerts && day.alerts.length > 0 ? `
            <div class="alerts">
              <strong>‚ö†Ô∏è ALLERTE METEO:</strong>
              ${day.alerts.map(a => `<p>${a}</p>`).join('')}
            </div>
          ` : ''}
        </div>
      `).join('');

      document.getElementById('forecast-container').innerHTML = html;
    }

    function updateTimestamp() {
      if (weatherData && weatherData.generatedAt) {
        const date = new Date(weatherData.generatedAt);
        document.getElementById('last-update').textContent = 
          `Ultimo aggiornamento: ${date.toLocaleString('it-IT')}`;
      }
    }

    // Inizializzazione
    renderStats();
    renderForecast();
    updateTimestamp();
  </script>
</body>
</html>