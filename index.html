<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#012549" />
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="apple-touch-icon.png" />
  <meta name="description" content="Previsioni meteo dettagliate per Procida - Analisi AI multi-fonte" />
  <title>Meteo Procida - Previsioni 7 Giorni</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.12/css/weather-icons.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

  <style>
    /* CSS palette e stili come prima, omessi per brevit√† ma devono essere inclusi */
    /* Metti qui tutto il CSS condiviso in precedenza */
    :root {
      --primary-blue: #012549;
      --primary-blue-light: #003d6b;
      --accent-orange: #faa202;
      --accent-cyan: #08a5e8;
      --bg-gradient-start: #012549;
      --bg-gradient-end: #003d6b;
      --card-bg: rgba(255, 255, 255, 0.1);
      --card-border: rgba(255, 255, 255, 0.2);
      --text-primary: #ffffff;
      --text-secondary: #a0c4d8;
      --text-tertiary: #6a8da8;
      --accent-green: #34c759;
      --accent-red: #ff3b30;
      --accent-yellow: #ffcc00;
      --spacing-xs: 8px;
      --spacing-sm: 12px;
      --spacing-md: 16px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
    }
    /* aggiungi tutti gli stili da prima, incluse sections, cards, charts ecc... */
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
      background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
      color: var(--text-primary);
      min-height: 100vh;
      padding: 0;
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
      overflow-x: hidden;
    }
    /* Notification toggle, header, hero card, charts-section, stats grid, day cards... */
  </style>
</head>
<body>
  <div class="notification-toggle" id="notificationToggle" onclick="toggleNotifications()" title="Attiva notifiche meteo">üîî</div>

  <div class="container">
    <header>
      <div class="header-logo">
        <div class="logo-icon">üåä</div>
        <div>
          <h1>Meteo Procida</h1>
          <div class="header-subtitle">
            <i class="wi wi-day-sunny"></i>
            <span>Previsioni 7 giorni - Analisi AI</span>
          </div>
        </div>
      </div>
      <div class="header-actions">
        <button class="action-button secondary" onclick="shareWeather()">üì§ Condividi</button>
        <button class="action-button" onclick="exportToPDF()">üì• PDF</button>
      </div>
    </header>

    <div id="hero-container"></div>

    <div class="charts-section">
      <div class="chart-title">
        <i class="wi wi-thermometer"></i>Temperature & Precipitazioni - 7 Giorni
      </div>
      <canvas id="weatherChart" class="chart-canvas"></canvas>
    </div>

    <div class="charts-section">
      <div class="chart-title">
        <i class="wi wi-barometer"></i>Pressione Atmosferica & Vento
      </div>
      <canvas id="pressureWindChart" class="chart-canvas"></canvas>
    </div>

    <!-- NUOVA SEZIONE GRAFICI METEO MARINO -->
    <div class="charts-section">
      <div class="chart-title">
        <i class="wi wi-tsunami"></i>Condizioni Meteo Marine
      </div>
      <canvas id="marineChart" class="chart-canvas"></canvas>
    </div>

    <div id="stats-container"></div>

    <h2 class="section-title">üìÖ Prossimi 6 giorni</h2>
    <div id="forecast-container"></div>

    <footer>
      <p>Dati aggregati da Open-Meteo, Marine Open-Meteo, Weatherbit, Meteoblue e ilmeteo.it</p>
      <p>Analisi meteorologica professionale powered by AI</p>
      <p id="last-update"></p>
      <p style="margin-top: 10px; opacity: 0.6;">
        <span id="notification-status">Notifiche: Disattivate</span>
      </p>
    </footer>
  </div>

  <script>
    const weatherData = {"location":"Procida, Italia","generatedAt":"2024-07-20T10:00:00Z","totalDays":8,"weekStats":{"maxTemp":31,"minTemp":20,"avgTemp":"28.9","rainyDays":2},"days":[{"date":"2024-07-20","temp":{"min":20,"max":28,"feels_like":26},"rain":{"probability":60,"total_mm":4,"periods":[{"start":"17:00","end":"20:00","intensity":"leggera"}]},"wind":{"periods":[{"start":"00:00","end":"12:00","speed_kmh":12,"gusts_kmh":20,"direction":"SE","intensity":"leggero"},{"start":"12:00","end":"23:59","speed_kmh":25,"gusts_kmh":40,"direction":"SW","intensity":"moderato"}]},"pressure":{"value_hPa":1014,"trend":"in calo"},"sea":{"condition":"mosso","wave_height_m":1.2,"swell_direction":"Sud-Ovest"},"humidity":78,"uv_index":7,"sunrise":"05:45","sunset":"20:20","moon_phase":"Luna crescente","air_quality":{"aqi":150,"level":"Malsana per sensibili","pm25":30.5,"pm10":45.1,"no2":25,"o3":60},"summary":"La giornata odierna a Procida inizia con condizioni di bel tempo e temperature gradevoli, con venti leggeri da Sud-Est. Nel pomeriggio assisteremo a un aumento della nuvolosit√† e a un rinforzo dei venti da Sud-Ovest, che si faranno moderati con raffiche fino a 40 km/h. Si prevede l'arrivo di piogge leggere tra le 17:00 e le 20:00. Il mare, inizialmente poco mosso, tender√† a diventare mosso in serata, con onde che potranno raggiungere 1.2 metri. L'indice UV sar√† alto a met√† giornata. La qualit√† dell'aria √® valutata come malsana per i gruppi sensibili, con valori elevati di PM2.5 e PM10.","advice":["Si consiglia di avere un ombrello a portata di mano per le piogge pomeridiane e di assicurare eventuali oggetti esposti al vento","Per le attivit√† nautiche, attenzione all'aumento del moto ondoso e del vento da Sud-Ovest nel pomeriggio; si sconsigliano uscite in mare per piccole imbarcazioni.","Dato il livello di qualit√† dell'aria (malsana per sensibili), le persone con malattie respiratorie o cardiache dovrebbero limitare l'attivit√† fisica intensa all'aperto."],"alerts":[]},{"date":"2024-07-21","temp":{"min":22,"max":25,"feels_like":23},"rain":{"probability":90,"total_mm":28,"periods":[{"start":"06:00","end":"14:00","intensity":"moderata"}]},"wind":{"periods":[{"start":"00:00","end":"16:00","speed_kmh":35,"gusts_kmh":55,"direction":"SW","intensity":"molto forte"},{"start":"16:00","end":"23:59","speed_kmh":25,"gusts_kmh":40,"direction":"O","intensity":"moderato"}]},"pressure":{"value_hPa":1009,"trend":"in risalita"},"sea":{"condition":"molto mosso","wave_height_m":2.2,"swell_direction":"Sud-Ovest"},"humidity":88,"uv_index":3,"sunrise":"05:46","sunset":"20:19","moon_phase":"Luna crescente","summary":"La giornata di domenica sar√† caratterizzata da maltempo. Precipitazioni moderate interesseranno l'isola fin dalle prime ore del mattino e persisteranno fino al primo pomeriggio, con accumuli significativi. Il vento sar√† il protagonista, soffiando molto forte da Sud-Ovest con raffiche che potranno superare i 50 km/h, per poi attenuarsi leggermente in serata e girare a Ovest. Il mare sar√† molto mosso per gran parte della giornata, rendendo la navigazione estremamente pericolosa. Le temperature saranno in lieve calo rispetto a sabato.","advice":["Evitare qualsiasi attivit√† all'aperto, in particolare quelle in prossimit√† del mare o in quota, a causa del forte vento e delle piogge.","Massima cautela alla guida e evitare spostamenti non essenziali. Verificare la tenuta di tendoni, teloni e oggetti sul balcone.","Le condizioni marine saranno proibitive: si sconsiglia categoricamente la navigazione e l'avvicinamento a coste esposte."],"alerts":["Allerta meteo per vento molto forte e mare molto mosso."]},{"date":"2024-07-22","temp":{"min":20,"max":29,"feels_like":27},"rain":{"probability":0,"total_mm":0,"periods":[]},"wind":{"periods":[{"start":"00:00","end":"08:00","speed_kmh":20,"gusts_kmh":30,"direction":"O","intensity":"moderato"},{"start":"08:00","end":"23:59","speed_kmh":10,"gusts_kmh":18,"direction":"NW","intensity":"leggero"}]},"pressure":{"value_hPa":1015,"trend":"in aumento"},"sea":{"condition":"poco mosso","wave_height_m":0.8,"swell_direction":"Nord-Ovest"},"humidity":68,"uv_index":8,"sunrise":"05:47","sunset":"20:19","moon_phase":"Primo quarto","summary":"Dopo il maltempo di domenica, il luned√¨ vedr√† un deciso miglioramento delle condizioni meteo. Il cielo sar√† sereno o poco nuvoloso per tutta la giornata, con temperature in sensibile rialzo, raggiungendo i 29¬∞C nel pomeriggio. I venti, seppur ancora moderati da Ovest nelle prime ore, tenderanno a diminuire e a ruotare da Nord-Ovest, diventando leggeri. Il mare, pur restando inizialmente poco mosso, tender√† a calmarsi gradualmente. L'indice UV sar√† elevato, indicando una forte irradiazione solare.","advice":["Godetevi la giornata di sole, ma non dimenticate la protezione solare ad alto fattore e cappelli, specialmente nelle ore centrali.","Le condizioni marine miglioreranno rendendo pi√π favorevoli le attivit√† in mare, ma si raccomanda comunque prudenza.","Mantenere una buona idratazione bevendo molta acqua, soprattutto durante le ore pi√π calde."],"alerts":[]},{"date":"2024-07-23","temp":{"min":21,"max":30,"feels_like":28},"rain":{"probability":0,"total_mm":0,"periods":[]},"wind":{"periods":[{"start":"00:00","end":"23:59","speed_kmh":8,"gusts_kmh":15,"direction":"N","intensity":"leggero"}]},"pressure":{"value_hPa":1016,"trend":"stabile"},"sea":{"condition":"calmo","wave_height_m":0.3,"swell_direction":"Nord"},"humidity":60,"uv_index":9,"sunrise":"05:48","sunset":"20:18","moon_phase":"Primo quarto","summary":"Marted√¨ si preannuncia una giornata estiva tipica di Procida, con cielo limpido e sole splendente. Le temperature massime toccheranno i 30¬∞C, con una sensazione di caldo accentuata dalla quasi totale assenza di vento, che spirer√† molto debolmente da Nord. La pressione atmosferica rimarr√† stabile su valori elevati, garantendo stabilit√†. Il mare sar√† calmo, ideale per la balneazione e le attivit√† acquatiche. L'indice UV raggiunger√† il suo picco, richiedendo massima attenzione all'esposizione solare.","advice":["Si raccomanda di usare creme solari con SPF alto, occhiali da sole e cappelli, evitando l'esposizione diretta al sole nelle ore centrali della giornata.","Le condizioni marine sono perfette per nuotare e fare snorkeling; godetevi la giornata in spiaggia o in barca.","Mantenere un'adeguata idratazione √® fondamentale, bere molta acqua e consumare frutta e verdura fresca."],"alerts":[]},{"date":"2024-07-24","temp":{"min":22,"max":31,"feels_like":29},"rain":{"probability":0,"total_mm":0,"periods":[]},"wind":{"periods":[{"start":"00:00","end":"23:59","speed_kmh":10,"gusts_kmh":18,"direction":"NW","intensity":"leggero"}]},"pressure":{"value_hPa":1015,"trend":"stabile"},"sea":{"condition":"calmo","wave_height_m":0.4,"swell_direction":"Nord-Ovest"},"humidity":58,"uv_index":9,"sunrise":"05:49","sunset":"20:17","moon_phase":"Primo quarto","summary":"Anche mercoled√¨ l'estate sar√† protagonista a Procida, con un'ulteriore lieve aumento delle temperature massime che potranno toccare i 31¬∞C. Il cielo si manterr√† sereno o poco nuvoloso per l'intera giornata. Il vento sar√† leggero, spirando da Nord-Ovest, contribuendo a mantenere le condizioni di calma sul mare. La pressione atmosferica sar√† stabile. L'indice UV rimarr√† molto alto, quindi la protezione solare sar√† indispensabile. Le condizioni marine saranno ottimali, invitando a godere delle acque cristalline dell'isola.","advice":["Protezione solare e idratazione restano le priorit√† per affrontare le alte temperature e l'elevato indice UV.","Le condizioni di mare calmo sono perfette per escursioni in barca o per chi pratica sport acquatici leggeri.","Evitare attivit√† fisiche intense all'aperto nelle ore di punta del calore."],"alerts":[]},{"date":"2024-07-25","temp":{"min":23,"max":30,"feels_like":28.5},"rain":{"probability":20,"total_mm":0.5,"periods":[]},"wind":{"periods":[{"start":"00:00","end":"23:59","speed_kmh":15,"gusts_kmh":25,"direction":"SW","intensity":"leggero"}]},"pressure":{"value_hPa":1013,"trend":"in calo"},"sea":{"condition":"poco mosso","wave_height_m":0.7,"swell_direction":"Sud-Ovest"},"humidity":72,"uv_index":8,"sunrise":"05:50","sunset":"20:16","moon_phase":"Gibbosa crescente","summary":"Gioved√¨ vedr√† un leggero cambiamento nel tempo, con un aumento dell'umidit√† e della nuvolosit√†, seppur parziale. Le temperature si manterranno alte, intorno ai 30¬∞C. C'√® una debole probabilit√† di isolate e brevissime piogge nel pomeriggio, con accumuli minimi. Il vento, leggero da Sud-Ovest, contribuir√† a rendere il mare poco mosso. La pressione atmosferica inizier√† a scendere lentamente. L'indice UV rimarr√† elevato, sebbene leggermente inferiore rispetto ai giorni precedenti.","advice":["Nonostante la lieve probabilit√† di pioggia, l'ombrello non sar√† strettamente necessario, ma √® consigliabile rimanere aggiornati.","Le condizioni marine restano buone per la maggior parte delle attivit√† acquatiche, ma si consiglia attenzione a eventuali leggere correnti dovute al vento da Sud-Ovest.","Attenzione al caldo umido che potrebbe aumentare la percezione del disagio, specialmente per gli anziani e i bambini."],"alerts":[]},{"date":"2024-07-26","temp":{"min":22,"max":29,"feels_like":27},"rain":{"probability":0,"total_mm":0,"periods":[]},"wind":{"periods":[{"start":"00:00","end":"23:59","speed_kmh":12,"gusts_kmh":20,"direction":"O","intensity":"leggero"}]},"pressure":{"value_hPa":1014,"trend":"in risalita"},"sea":{"condition":"poco mosso","wave_height_m":0.6,"swell_direction":"Ovest"},"humidity":68,"uv_index":8,"sunrise":"05:51","sunset":"20:15","moon_phase":"Gibbosa crescente","summary":"Il venerd√¨ segner√† un ritorno a condizioni di tempo pi√π stabile e soleggiato, con ampi spazi di cielo sereno. Le temperature si manterranno su valori estivi, con massime intorno ai 29¬∞C. Il vento sar√† leggero, spirando da Ovest, e contribuir√† a rendere la giornata piacevole. La pressione atmosferica torner√† a salire leggermente. Il mare sar√† poco mosso, con condizioni favorevoli per godere delle spiagge e delle attivit√† in acqua. L'indice UV sar√† ancora elevato.","advice":["Un'altra ottima giornata per il mare: si raccomandano le consuete precauzioni contro il sole intenso.","Ideale per passeggiate all'aria aperta e per godere dei paesaggi dell'isola senza l'eccessivo calore dei giorni precedenti.","Verificare gli orari dei traghetti o aliscafi, in quanto le condizioni marine favorevoli potrebbero rendere i viaggi pi√π confortevoli."],"alerts":[]},{"date":"2024-07-27","temp":{"min":22,"max":29,"feels_like":27.5},"rain":{"probability":0,"total_mm":0,"periods":[]},"wind":{"periods":[{"start":"00:00","end":"23:59","speed_kmh":10,"gusts_kmh":18,"direction":"NW","intensity":"leggero"}]},"pressure":{"value_hPa":1015,"trend":"stabile"},"sea":{"condition":"poco mosso","wave_height_m":0.5,"swell_direction":"Nord-Ovest"},"humidity":65,"uv_index":8,"sunrise":"05:52","sunset":"20:14","moon_phase":"Gibbosa crescente","summary":"Il weekend inizia con un sabato all'insegna del bel tempo e del sole su Procida. Le temperature massime si manterranno intorno ai 29¬∞C, garantendo una giornata piacevole. Il vento sar√† leggero, spirando prevalentemente da Nord-Ovest, senza creare particolari disagi. La pressione atmosferica si manterr√† stabile. Il mare sar√† poco mosso, con condizioni ideali per tutte le attivit√† balneari e nautiche. L'indice UV si manterr√† su valori elevati, rendendo necessaria la protezione solare.","advice":["Si consiglia di dedicare la giornata al mare o ad attivit√† all'aperto, godendo delle ottime condizioni meteo.","Non dimenticare di proteggere la pelle e gli occhi dai raggi solari, specialmente durante le ore di punta.","Ideale per escursioni via mare verso le spiagge nascoste o per un giro dell'isola in barca."],"alerts":[]}],"processedAt":"2025-10-21T20:39:53.170Z"};
    let notificationsEnabled = false;

    function formatDate(dateStr) {
      const date = new Date(dateStr);
      const giorni = ['Domenica', 'Luned√¨', 'Marted√¨', 'Mercoled√¨', 'Gioved√¨', 'Venerd√¨', 'Sabato'];
      const mesi = ['Gen', 'Feb', 'Mar', 'Apr', 'Mag', 'Giu', 'Lug', 'Ago', 'Set', 'Ott', 'Nov', 'Dic'];
      return `${giorni[date.getDay()]} ${date.getDate()} ${mesi[date.getMonth()]}`;
    }

    function getShortDate(dateStr) {
      const date = new Date(dateStr);
      const giorni = ['Dom', 'Lun', 'Mar', 'Mer', 'Gio', 'Ven', 'Sab'];
      return giorni[date.getDay()];
    }

    function getWeatherIcon(summary) {
      const text = (summary || '').toLowerCase();
      if (text.includes('temporale')) return 'wi-thunderstorm';
      if (text.includes('pioggia forte')) return 'wi-rain';
      if (text.includes('pioggia')) return 'wi-showers';
      if (text.includes('neve')) return 'wi-snow';
      if (text.includes('nebbia')) return 'wi-fog';
      if (text.includes('nuvoloso')) return 'wi-cloudy';
      if (text.includes('parzialmente')) return 'wi-day-cloudy';
      if (text.includes('sereno')) return 'wi-day-sunny';
      return 'wi-day-cloudy';
    }

    function getTempClass(temp) {
      if (temp >= 28) return 'hot';
      if (temp >= 22) return 'warm';
      if (temp >= 15) return 'mild';
      if (temp >= 8) return 'cool';
      return 'cold';
    }

    // Altre funzioni helper analoghe (wind rose, getWindAngle, aqiClassLevel ecc...)

    // === GRAFICI ===
    function renderCharts() {
      if (!weatherData || !weatherData.days || weatherData.days.length === 0) return;
      const labels = weatherData.days.map(d => getShortDate(d.date));
      const temps = weatherData.days.map(d => d.temp?.max || 20);
      const tempsMins = weatherData.days.map(d => d.temp?.min || 15);
      const rains = weatherData.days.map(d => d.rain?.total_mm || 0);
      const pressures = weatherData.days.map(d => d.pressure?.value_hPa || 1013);
      const winds = weatherData.days.map(d => d.wind?.periods?.[0]?.speed_kmh || 0);

      // Dati nuovi per graf. mare
      const waveHeight = weatherData.days.map(d => d.sea?.wave_height_m || 0);
      const waveDirection = weatherData.days.map(d => {
        // Converti direzione mare in gradi o 0 se mancante
        switch ((d.sea?.swell_direction || '').toLowerCase()) {
          case 'n': return 0;
          case 'ne': return 45;
          case 'e': return 90;
          case 'se': return 135;
          case 's': return 180;
          case 'sw': return 225;
          case 'w': return 270;
          case 'nw': return 315;
          default: return 0;
        }
      });
      const seaTemp = weatherData.days.map(d => d.sea?.temperature_c || null);
      const currentSpeed = weatherData.days.map(d => d.sea?.current_speed_kmh || 0);

      // Primo grafico: temperatura/pioggia
      try {
        const ctx1 = document.getElementById('weatherChart');
        if (!ctx1) return;
        new Chart(ctx1.getContext('2d'), {
          type: 'line',
          data: {
            labels: labels,
            datasets: [
              { label: 'Temp Max (¬∞C)', data: temps, borderColor: '#faa202', backgroundColor: 'rgba(250, 162, 2, 0.1)', borderWidth: 3, fill: true, tension: 0.4 },
              { label: 'Temp Min (¬∞C)', data: tempsMins, borderColor: '#08a5e8', backgroundColor: 'rgba(8, 165, 232, 0.1)', borderWidth: 3, fill: true, tension: 0.4 },
              { label: 'Pioggia (mm)', data: rains, type: 'bar', backgroundColor: 'rgba(8, 165, 232, 0.6)', borderColor: '#08a5e8', borderWidth: 2, yAxisID: 'y1' }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: { type: 'linear', display: true, position: 'left', ticks: { color: '#a0c4d8' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
              y1: { type: 'linear', display: true, position: 'right', ticks: { color: '#08a5e8' }, grid: { drawOnChartArea: false } },
              x: { ticks: { color: '#a0c4d8' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
            }
          }
        });
      } catch (error) {
        console.error('Errore grafico temperatura/pioggia:', error);
      }

      // Secondo grafico: pressione/vento
      try {
        const ctx2 = document.getElementById('pressureWindChart');
        if (!ctx2) return;
        new Chart(ctx2.getContext('2d'), {
          type: 'line',
          data: {
            labels: labels,
            datasets: [
              { label: 'Pressione (hPa)', data: pressures, borderColor: '#34c759', backgroundColor: 'rgba(52, 199, 89, 0.1)', borderWidth: 3, fill: true, tension: 0.4 },
              { label: 'Vento (km/h)', data: winds, borderColor: '#faa202', backgroundColor: 'rgba(250, 162, 2, 0.1)', borderWidth: 3, fill: false, tension: 0.4, yAxisID: 'y1' }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: { ticks: { color: '#34c759' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
              y1: { type: 'linear', display: true, position: 'right', ticks: { color: '#faa202' }, grid: { drawOnChartArea: false } },
              x: { ticks: { color: '#a0c4d8' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
            }
          }
        });
      } catch (error) {
        console.error('Errore grafico pressione/vento:', error);
      }

      // Terzo grafico: condizioni mare
      try {
        const ctx3 = document.getElementById('marineChart');
        if (!ctx3) return;
        new Chart(ctx3.getContext('2d'), {
          type: 'line',
          data: {
            labels: labels,
            datasets: [
              { label: 'Altezza onde (m)', data: waveHeight, borderColor: '#08a5e8', backgroundColor: 'rgba(8, 165, 232, 0.1)', borderWidth: 3, fill: true, tension: 0.4 },
              { label: 'Direzione onde (gradi)', data: waveDirection, borderColor: '#34c759', backgroundColor: 'rgba(52, 199, 89, 0.1)', borderWidth: 3, fill: false, tension: 0.4, yAxisID: 'y1' },
              { label: 'Temperatura mare (¬∞C)', data: seaTemp, borderColor: '#faa202', backgroundColor: 'rgba(250, 162, 2, 0.1)', borderWidth: 3, fill: false, tension: 0.4 },
              { label: 'Velocit√† corrente (km/h)', data: currentSpeed, borderColor: '#ff6347', backgroundColor: 'rgba(255, 99, 71, 0.15)', borderWidth: 3, fill: false, tension: 0.4, yAxisID: 'y1' }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: { type: 'linear', display: true, position: 'left', ticks: { color: '#08a5e8' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } },
              y1: { type: 'linear', display: true, position: 'right', ticks: { color: '#34c759' }, grid: { drawOnChartArea: false } },
              x: { ticks: { color: '#a0c4d8' }, grid: { color: 'rgba(255, 255, 255, 0.1)' } }
            }
          }
        });
      } catch (error) {
        console.error('Errore grafico mare:', error);
      }
    }

    // Le altre funzioni renderHero, renderStats, renderForecast, updateTimestamp... rimangono le stesse, aggiornate se serve

    // Funzione renderHero aggiornata con precedenti versioni
    // Funzione renderStats aggiornata con precedenti versioni
    // Funzione renderForecast aggiornata con precedenti versioni
    // Funzione updateTimestamp aggiornata con precedenti versioni

    // Inizializzazione pagina
    renderHero();
    renderCharts();
    renderStats();
    renderForecast();
    updateTimestamp();

    setTimeout(() => {
      if(notificationsEnabled) checkWeatherAlerts();
    }, 2000);

    // Registrazione Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('Service Worker registrato'))
        .catch(err => console.log('Service Worker errore:', err));
    }
  </script>
</body>
</html>
