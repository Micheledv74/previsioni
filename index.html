<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Previsioni Procida - Meteo Giornaliero</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Roboto&display=swap');
    body {
      font-family: 'Roboto', Arial, sans-serif;
      max-width: 950px;
      margin: 40px auto;
      background: linear-gradient(135deg, #26365a, #2a3a7f 85%, #3498db 97%);
      color: #f0f8ff;
      padding: 22px 12px 22px 12px;
      overflow-x: hidden;
    }
    .header {
      font-family: 'Montserrat', sans-serif;
      font-size: 2.6rem;
      font-weight: 900;
      text-align: center;
      color: #cfe9ff;
      text-shadow: 1px 2px 15px #09172a;
      letter-spacing: 2px;
      user-select: none;
      margin-bottom: 35px;
    }
    .footer {
      margin-top: 25px;
      text-align: center;
      color: #cbefff;
      font-size: 17px;
      font-weight: 500;
    }
    /* Blocchi sezione marine compatti */
    #marine-conditions {
      max-width:680px;
      margin: 22px auto 0 auto;
      background: rgba(20,30,55,0.41);
      border-radius: 20px;
      padding: 12px 9px 14px 12px;
      box-shadow: 0 0 12px #1352a4bb;
      color: #a8cff8;
      font-family: Arial, sans-serif;
    }
    #marine-conditions h3 {
      font-weight: 700;
      font-size: 1.35rem;
      margin: 8px 0 7px 0;
      color: #e0f0ff;
      text-align:left;
    }
    #marine-summary {
      margin-bottom: 6px;
      font-size: 1.06rem;
    }
    .marine-chart-wrap {
      width:100%;
      max-width:375px;
      height:112px;
      margin:0 auto 4px auto;
    }
    #marine-alerts { 
      margin-top: 4px;
      color: #ffcc66;
      font-weight: 700;
      font-size: 1.05rem;
      min-height:18px;
    }
    @media (max-width: 700px) {
      #marine-conditions { max-width:99vw;padding: 7px 1vw; }
      .marine-chart-wrap { max-width:98vw; height:90px; }
    }
    /* ...altri stili come da template originale */
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="header">PREVISIONI METEO - PROCIDA</div>
<!-- Qui va la dashboard meteo classica -->

<!-- Blocco condizioni marine compatto -->
<section id="marine-conditions">
  <h3>Condizioni Marine</h3>
  <div id="marine-summary"></div>
  <div class="marine-chart-wrap">
    <canvas id="marine-wave-chart" width="360" height="100"></canvas>
  </div>
  <div id="marine-alerts"></div>
</section>

<!-- (Restanti blocchi meteo, tab, grafici ecc. come gi√† presenti) -->

<div class="footer" id="footer">Powered by Open-Meteo ‚Ä¢ UI by micheledv74 ‚Ä¢ Ultimo agg.: <span id="updated_stamp"></span></div>
<script>
const DATA = {"days":[{"day_label":"12/10","temp_max":"21.2","temp_min":"19.3","precipitation":"0.00","icon":"‚õÖ","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[21.1,20.6,20.3,20.1,20,19.7,19.5,19.5,19.3,19.4,19.6,20,20.3,20.6,20.8,21,21.1,21.2,21.1,21,20.8,20.7,20.5,20.4],"hourly_winds":[8.1,9.2,10,11.6,12.3,11.4,10.4,9.1,8.9,8.1,6.6,5.4,3.5,3.4,3.9,4.3,4.2,4.1,3.2,3.3,3.5,3.6,3.4,3.3],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"13/10","temp_max":"21.2","temp_min":"19.4","precipitation":"0.00","icon":"‚õÖ","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[20.3,20.2,20.1,19.9,19.8,19.7,19.6,19.5,19.4,19.5,19.7,20,20.2,20.3,20.5,21,21.2,21,20.9,20.8,20.8,20.7,20.6,20.5],"hourly_winds":[2.5,2.1,1.8,1.6,1.3,2,2.8,3.5,4.2,3.5,3.7,3,3.4,4.1,4.5,4.9,7,9.5,9.7,7.8,7.6,5.4,3.2,2],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"14/10","temp_max":"20.4","temp_min":"19.3","precipitation":"0.00","icon":"üå§Ô∏è","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[20.3,20.1,20,19.9,19.7,19.6,19.5,19.4,19.3,19.3,19.4,19.7,20,20.2,20.4,20.4,20.4,20.3,20.3,20.3,20.2,20.1,20,19.9],"hourly_winds":[3.1,2.2,3.4,4.1,4,4.7,3.6,3.6,5.1,5.4,5.4,5.8,5.7,5.6,5.5,7.2,9.1,9.7,7.6,4.4,1.9,4.6,5.3,7.2],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"15/10","temp_max":"20.8","temp_min":"19.3","precipitation":"0.40","icon":"‚õÖ","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.9,19.9,19.9,19.7,19.6,19.5,19.4,19.3,19.3,19.4,19.5,19.7,19.9,20.4,20.8,20.6,20.3,20,19.9,19.8,19.7,19.6,19.5,19.3],"hourly_winds":[6.2,5.7,6.5,7.6,6.8,8.7,10.6,11.1,12.1,13.6,14.9,15.8,15.5,14.8,12.2,10.8,10.4,10.3,8.7,5.6,5.1,9.3,15.8,20.6],"hourly_precips":[0,0,0,0.1,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1,0,0,0,0,0,0]},{"day_label":"16/10","temp_max":"20.5","temp_min":"18.2","precipitation":"0.00","icon":"‚õÖ","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.1,18.9,18.8,18.7,18.6,18.5,18.3,18.2,18.2,18.5,19,19.4,19.8,20.3,20.5,20.4,20.1,19.9,19.6,19.3,19.1,19.1,19.2,19.2],"hourly_winds":[22.2,22.2,21.9,22.2,22.1,22.1,22.2,21.4,21.2,20.7,20.4,19.9,19.5,19.3,19,19.2,19.8,19.9,19.8,19.2,18.9,18.4,18.4,18.7],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{"day_label":"17/10","temp_max":"20.2","temp_min":"19.0","precipitation":"0.30","icon":"‚õÖ","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.2,19.1,19,19,19,19.1,19.1,19.1,19.1,19.6,19.6,19.6,19.8,20,20.2,20.1,20,19.8,19.8,19.7,19.7,19.7,19.7,19.7],"hourly_winds":[18.8,18.9,18.4,17.3,15.9,14.5,13.8,13.1,12.7,20.2,19.5,19.5,20.4,21.5,22.4,22.8,23.2,22.9,22.1,20.6,19.1,17.6,15.7,14.2],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.1,0.1,0.1]},{"day_label":"18/10","temp_max":"20.7","temp_min":"19.3","precipitation":"0.00","icon":"üå§Ô∏è","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.6,19.6,19.6,19.5,19.5,19.4,19.4,19.3,19.4,19.5,19.8,20,20.2,20.4,20.6,20.7,20.7,20.6,20.5,20.3,20.1,20,20,19.9],"hourly_winds":[13.1,11.9,10.5,8.6,6.8,4.7,2.3,0.5,2.5,4,5.4,6.4,6.8,7.2,7.4,7.6,7.5,7.6,8,8.6,9.2,9.2,9.7,9.8],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}],"updated_at":"12/10/2025, 16:22:05"};

// --- METEO JS tua dashboard, non modificato qui ---

// ----- Sezione Marine ----- //
const mergedHourly = DATA.mergedHourly || [];
const alerts = DATA.alerts || [];
const advice = DATA.advice || "";

// breve descrizione
function humanDirection(deg) {
  if(deg==null) return '--';
  const directions = ['N','NNE','NE','ENE','E','ESE','SE','SSE','S','SSW','SW','WSW','W','WNW','NW','NNW'];
  const ix = Math.round(deg / 22.5) % 16;
  return directions[ix];
}

(function renderMarine() {
  const divSummary = document.getElementById('marine-summary');
  if(mergedHourly.length) {
    // Mostra valori per la prima ora disponibile (es: ora corrente)
    const h = mergedHourly[0];
    divSummary.textContent =
      `Altezza onda: ${(h.wave_height??0).toFixed(2)}m, direzione swell: ${humanDirection(h.swell_direction)} (${h.swell_direction??'-'}¬∞), altezza swell: ${(h.swell_height??0).toFixed(2)}m.`;
  } else {
    divSummary.textContent = "Dati marine non disponibili.";
  }

  // Chart compatto
  const ctx = document.getElementById('marine-wave-chart').getContext('2d');
  const labels = mergedHourly.slice(0,24).map(h => h.time.slice(11,16));
  const waves = mergedHourly.slice(0,24).map(h => h.wave_height);
  const swells = mergedHourly.slice(0,24).map(h => h.swell_height);

  new Chart(ctx, {
    type: 'line',
    data: {
      labels,
      datasets: [
        {
          label: 'Altezza onda (m)',
          borderColor: 'rgba(30,144,255,0.88)',
          backgroundColor: 'rgba(30,144,255,0.18)',
          fill: true, data: waves,
          tension: 0.21, pointRadius: 1.5,
        },
        {
          label: 'Altezza swell (m)',
          borderColor: 'rgba(8,206,120,0.86)',
          backgroundColor: 'rgba(60,255,210,0.12)',
          fill: true, data: swells,
          tension: 0.21, pointRadius: 1.5,
        }
      ]
    },
    options: {
      responsive: false,
      maintainAspectRatio: false,
      scales: {
        y: {
          beginAtZero: true,
          title: { display: true, text: 'm', color: '#a8cff8' },
          ticks: { color: '#a8cff8', font: { size: 11 } }
        },
        x: {
          title: { display: false },
          ticks: { color: '#a8cff8', font: { size: 10 }, maxTicksLimit: 8 }
        }
      },
      plugins: {
        legend: { labels: { color: '#a8cff8', font:{size:12} }, display: true},
        tooltip: { mode: 'index', intersect: false }
      }
    }
  });

  // Alert o consiglio
  const divAlerts = document.getElementById('marine-alerts');
  if(alerts.length) {
    divAlerts.innerHTML = alerts.map(a=>`‚ö†Ô∏è ${a.message}`).join('<br>');
  } else {
    divAlerts.textContent = `üóûÔ∏è ${advice}`;
  }
})();
</script>
</body>
</html>
