<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes" />
<title>PREVISIONI METEO PROCIDA</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@700;900&family=Roboto&display=swap');
  html, body { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    font-family: 'Roboto', sans-serif;
    background: linear-gradient(135deg,#26365a,#2a3a7f 85%,#3498db 97%);
    color: #f0f8ff;
    max-width: 980px;
    margin: 0 auto 32px;
    min-height: 100vh;
    padding: 14px 8px 18px;
  }
  .header {
    font-family: 'Montserrat', sans-serif;
    font-weight: 900;
    font-size: 2.5rem;
    color: #cfe9ff;
    text-align: center;
    margin-bottom: 24px;
    user-select: none;
    letter-spacing: 1.8px;
    text-shadow: 1px 2px 14px #09172a;
  }
  .top-meteo-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 20px 18px;
    margin-bottom: 24px;
  }
  .meteo-box {
    background: #2b4170;
    border-radius: 18px;
    padding: 22px 24px;
    color: #c7defc;
    box-shadow: 0 4px 38px rgb(54 91 144 / 0.59);
    display: flex;
    flex-direction: column;
  }
  .box-title {
    font-family: 'Montserrat', sans-serif;
    font-weight: 900;
    font-size: 1.34rem;
    margin-bottom: 18px;
    color: #91c1f9;
  }
  .box-main-info {
    font-size: 1.12rem;
    margin-bottom: 6px;
    color: #a9d8ff;
    font-weight: 600;
  }
  .box-sub-info {
    font-size: 1rem;
    margin-bottom: 14px;
    color: #d3e4ffcc;
    font-weight: 400;
  }
  .btn-detail {
    background-color: #377cfb;
    padding: 12px 30px;
    font-size: 1rem;
    border: none;
    border-radius: 12px;
    font-weight: 700;
    color: white;
    cursor: pointer;
    max-width: max-content;
    align-self: start;
  }
  .btn-detail:hover {
    background-color: #5a9ffb;
  }
  .detail-section {
    margin-top: 14px;
    max-height: 280px;
    overflow-y: auto;
    display: none;
  }
  .detail-section.active {
    display: block;
  }
  .chart-wrap {
    width: 100%;
    height: 240px;
    background-color: rgba(21, 44, 89, 0.82);
    border-radius: 10px;
    padding: 10px;
    box-sizing: border-box;
  }
  .info-chips {
    margin-top: 14px;
    display: flex;
    justify-content: flex-start;
    gap: 18px;
    flex-wrap: wrap;
  }
  .info-chip {
    background: #1e3e7a;
    color: #adcfff;
    font-weight: 600;
    font-size: 0.95rem;
    padding: 9px 15px;
    border-radius: 10px;
    min-width: 95px;
    text-align: center;
  }
  .info-chip.wind { background: #329fff; color: #0c2b44; }
  .info-chip.rain { background: #36c28d; color: #053a20; }
  .info-chip.temp { background: #f7d77c; color: #543c0d; }
  .info-chip.press { background: #ffdd6b; color: #6b5c1a; }
  .today-card {
    background: #1a2b59;
    border-radius: 20px;
    box-shadow: 0 5px 38px #173972cc;
    padding: 26px 28px 22px 28px;
    margin-bottom: 28px;
    color: #a9d9ff;
  }
  .today-header {
    font-family: 'Montserrat', sans-serif;
    font-weight: 900;
    font-size: 2rem;
    margin-bottom: 14px;
  }
  .today-details {
    font-size: 1.1rem;
    line-height: 1.5;
    margin-bottom: 8px;
  }
  .today-details strong {
    color: #dbefff;
  }
  .today-message {
    margin-top: 14px;
    background-color: #2853bf44;
    border-radius: 14px;
    padding: 14px 18px;
    font-size: 1.1rem;
    font-weight: 600;
    color: #a0c8ff;
  }
  /* Two rows, 3 cards each */
  .days-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 16px 18px;
    max-width: 960px;
    margin: 0 auto;
  }
  .day-card {
    background: #234075dd;
    border-radius: 18px;
    padding: 14px 18px;
    box-shadow: 0 2px 14px #0a2051aa;
    cursor: pointer;
    color: #c6f3ff;
    transition: background-color 0.33s ease;
    min-width: 160px;
    font-size: 0.95rem;
    line-height: 1.3;
  }
  .day-card.selected {
    background-color: #3b78d6bd;
    box-shadow:  0 3px 18px #559dedcc;
    color: white;
  }
  .day-card:hover {
    background-color: #3e80e0aa;
  }
  .day-date {
    font-weight: 700;
    font-size: 1.12rem;
  }
  .day-temps {
    margin: 6px 0 4px 0;
  }
  .temp-high {
    color:#ffbb3a;
    font-weight: 700;
  }
  .temp-low {
    color:#6fd4f6;
    font-weight: 700;
  }
  .day-wind-precip {
    font-weight: 600;
    font-size: 0.9rem;
    color: #7bb4df;
  }

  /* Responsive */
  @media (max-width: 1024px) {
    .dashboard { max-width: 95vw; }
    .top-meteo-grid { grid-template-columns: 1fr 1fr; gap: 16px 12px; }
    .days-grid { grid-template-columns: repeat(3, 1fr); }
  }
  @media (max-width: 720px) {
    .top-meteo-grid { grid-template-columns: 1fr; }
    .days-grid { grid-template-columns: repeat(2, 1fr); max-width: 98vw; }
  }
  @media (max-width: 480px) {
    .days-grid { grid-template-columns: 1fr; max-width: 98vw; }
  }
</style>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>

<div class="header">PREVISIONI METEO PROCIDA</div>

<div class="dashboard">
  <!-- Top meteo boxes 2x2 -->
  <div class="top-meteo-grid" id="topMeteoGrid"></div>
  
  <!-- Large today card -->
  <div class="today-card" id="todayCard"></div>
  
  <!-- Grid of days -->
  <div class="days-grid" id="daysGrid"></div>
</div>

<div class="footer" id="footer"></div>

<script>
  const DATA = {"mergedHourly":[{"time":"2025-10-16T00:00","wave_height":0.64,"swell_height":0.42,"swell_direction":219,"sea_surface_temperature":21.2},{"time":"2025-10-16T01:00","wave_height":0.66,"swell_height":0.42,"swell_direction":218,"sea_surface_temperature":21.1},{"time":"2025-10-16T02:00","wave_height":0.7,"swell_height":0.42,"swell_direction":218,"sea_surface_temperature":21.1},{"time":"2025-10-16T03:00","wave_height":0.72,"swell_height":0.42,"swell_direction":194,"sea_surface_temperature":21.1},{"time":"2025-10-16T04:00","wave_height":0.74,"swell_height":0.44,"swell_direction":171,"sea_surface_temperature":21.1},{"time":"2025-10-16T05:00","wave_height":0.76,"swell_height":0.44,"swell_direction":147,"sea_surface_temperature":21.1},{"time":"2025-10-16T06:00","wave_height":0.76,"swell_height":0.44,"swell_direction":150,"sea_surface_temperature":21.1},{"time":"2025-10-16T07:00","wave_height":0.78,"swell_height":0.42,"swell_direction":153,"sea_surface_temperature":21.1},{"time":"2025-10-16T08:00","wave_height":0.78,"swell_height":0.42,"swell_direction":156,"sea_surface_temperature":21.1},{"time":"2025-10-16T09:00","wave_height":0.76,"swell_height":0.46,"swell_direction":149,"sea_surface_temperature":21.1},{"time":"2025-10-16T10:00","wave_height":0.74,"swell_height":0.48,"swell_direction":141,"sea_surface_temperature":21.1},{"time":"2025-10-16T11:00","wave_height":0.72,"swell_height":0.52,"swell_direction":134,"sea_surface_temperature":21.1},{"time":"2025-10-16T12:00","wave_height":0.68,"swell_height":0.48,"swell_direction":136,"sea_surface_temperature":21},{"time":"2025-10-16T13:00","wave_height":0.62,"swell_height":0.46,"swell_direction":137,"sea_surface_temperature":21},{"time":"2025-10-16T14:00","wave_height":0.58,"swell_height":0.42,"swell_direction":139,"sea_surface_temperature":21},{"time":"2025-10-16T15:00","wave_height":0.6,"swell_height":0.4,"swell_direction":140,"sea_surface_temperature":21},{"time":"2025-10-16T16:00","wave_height":0.6,"swell_height":0.36,"swell_direction":141,"sea_surface_temperature":21},{"time":"2025-10-16T17:00","wave_height":0.62,"swell_height":0.34,"swell_direction":142,"sea_surface_temperature":21},{"time":"2025-10-16T18:00","wave_height":0.6,"swell_height":0.32,"swell_direction":142,"sea_surface_temperature":21},{"time":"2025-10-16T19:00","wave_height":0.6,"swell_height":0.32,"swell_direction":142,"sea_surface_temperature":21},{"time":"2025-10-16T20:00","wave_height":0.58,"swell_height":0.3,"swell_direction":142,"sea_surface_temperature":21},{"time":"2025-10-16T21:00","wave_height":0.56,"swell_height":0.28,"swell_direction":140,"sea_surface_temperature":21},{"time":"2025-10-16T22:00","wave_height":0.54,"swell_height":0.26,"swell_direction":139,"sea_surface_temperature":21},{"time":"2025-10-16T23:00","wave_height":0.52,"swell_height":0.24,"swell_direction":137,"sea_surface_temperature":21},{"time":"2025-10-17T00:00","wave_height":0.5,"swell_height":0.22,"swell_direction":136,"sea_surface_temperature":21},{"time":"2025-10-17T01:00","wave_height":0.48,"swell_height":0.2,"swell_direction":134,"sea_surface_temperature":21},{"time":"2025-10-17T02:00","wave_height":0.46,"swell_height":0.18,"swell_direction":133,"sea_surface_temperature":21},{"time":"2025-10-17T03:00","wave_height":0.42,"swell_height":0.16,"swell_direction":133,"sea_surface_temperature":21},{"time":"2025-10-17T04:00","wave_height":0.4,"swell_height":0.14,"swell_direction":132,"sea_surface_temperature":21},{"time":"2025-10-17T05:00","wave_height":0.36,"swell_height":0.12,"swell_direction":132,"sea_surface_temperature":20.9},{"time":"2025-10-17T06:00","wave_height":0.32,"swell_height":0.1,"swell_direction":84,"sea_surface_temperature":20.9},{"time":"2025-10-17T07:00","wave_height":0.3,"swell_height":0.1,"swell_direction":37,"sea_surface_temperature":20.9},{"time":"2025-10-17T08:00","wave_height":0.26,"swell_height":0.08,"swell_direction":349,"sea_surface_temperature":20.9},{"time":"2025-10-17T09:00","wave_height":0.24,"swell_height":0.1,"swell_direction":1,"sea_surface_temperature":20.9},{"time":"2025-10-17T10:00","wave_height":0.2,"swell_height":0.1,"swell_direction":12,"sea_surface_temperature":21},{"time":"2025-10-17T11:00","wave_height":0.18,"swell_height":0.12,"swell_direction":24,"sea_surface_temperature":21},{"time":"2025-10-17T12:00","wave_height":0.16,"swell_height":0.1,"swell_direction":354,"sea_surface_temperature":21},{"time":"2025-10-17T13:00","wave_height":0.14,"swell_height":0.1,"swell_direction":325,"sea_surface_temperature":21},{"time":"2025-10-17T14:00","wave_height":0.12,"swell_height":0.08,"swell_direction":295,"sea_surface_temperature":21},{"time":"2025-10-17T15:00","wave_height":0.12,"swell_height":0.08,"swell_direction":294,"sea_surface_temperature":21},{"time":"2025-10-17T16:00","wave_height":0.12,"swell_height":0.1,"swell_direction":292,"sea_surface_temperature":21},{"time":"2025-10-17T17:00","wave_height":0.12,"swell_height":0.1,"swell_direction":291,"sea_surface_temperature":21},{"time":"2025-10-17T18:00","wave_height":0.12,"swell_height":0.1,"swell_direction":290,"sea_surface_temperature":21},{"time":"2025-10-17T19:00","wave_height":0.14,"swell_height":0.12,"swell_direction":288,"sea_surface_temperature":21},{"time":"2025-10-17T20:00","wave_height":0.14,"swell_height":0.12,"swell_direction":287,"sea_surface_temperature":21},{"time":"2025-10-17T21:00","wave_height":0.14,"swell_height":0.12,"swell_direction":286,"sea_surface_temperature":21},{"time":"2025-10-17T22:00","wave_height":0.14,"swell_height":0.14,"swell_direction":286,"sea_surface_temperature":21},{"time":"2025-10-17T23:00","wave_height":0.14,"swell_height":0.14,"swell_direction":285,"sea_surface_temperature":21},{"time":"2025-10-18T00:00","wave_height":0.14,"swell_height":0.14,"swell_direction":284,"sea_surface_temperature":20.9},{"time":"2025-10-18T01:00","wave_height":0.16,"swell_height":0.14,"swell_direction":282,"sea_surface_temperature":20.9},{"time":"2025-10-18T02:00","wave_height":0.16,"swell_height":0.14,"swell_direction":281,"sea_surface_temperature":20.9},{"time":"2025-10-18T03:00","wave_height":0.16,"swell_height":0.16,"swell_direction":278,"sea_surface_temperature":20.9},{"time":"2025-10-18T04:00","wave_height":0.18,"swell_height":0.16,"swell_direction":276,"sea_surface_temperature":20.9},{"time":"2025-10-18T05:00","wave_height":0.18,"swell_height":0.18,"swell_direction":273,"sea_surface_temperature":20.9},{"time":"2025-10-18T06:00","wave_height":0.18,"swell_height":0.16,"swell_direction":268,"sea_surface_temperature":20.9},{"time":"2025-10-18T07:00","wave_height":0.18,"swell_height":0.16,"swell_direction":262,"sea_surface_temperature":20.9},{"time":"2025-10-18T08:00","wave_height":0.18,"swell_height":0.14,"swell_direction":257,"sea_surface_temperature":20.9},{"time":"2025-10-18T09:00","wave_height":0.18,"swell_height":0.16,"swell_direction":261,"sea_surface_temperature":20.9},{"time":"2025-10-18T10:00","wave_height":0.2,"swell_height":0.16,"swell_direction":264,"sea_surface_temperature":21},{"time":"2025-10-18T11:00","wave_height":0.2,"swell_height":0.18,"swell_direction":268,"sea_surface_temperature":21},{"time":"2025-10-18T12:00","wave_height":0.2,"swell_height":0.18,"swell_direction":268,"sea_surface_temperature":21},{"time":"2025-10-18T13:00","wave_height":0.2,"swell_height":0.18,"swell_direction":268,"sea_surface_temperature":21.1},{"time":"2025-10-18T14:00","wave_height":0.2,"swell_height":0.18,"swell_direction":268,"sea_surface_temperature":21.1},{"time":"2025-10-18T15:00","wave_height":0.2,"swell_height":0.18,"swell_direction":268,"sea_surface_temperature":21.1},{"time":"2025-10-18T16:00","wave_height":0.18,"swell_height":0.18,"swell_direction":269,"sea_surface_temperature":21},{"time":"2025-10-18T17:00","wave_height":0.18,"swell_height":0.18,"swell_direction":269,"sea_surface_temperature":21},{"time":"2025-10-18T18:00","wave_height":0.18,"swell_height":0.16,"swell_direction":270,"sea_surface_temperature":21},{"time":"2025-10-18T19:00","wave_height":0.16,"swell_height":0.16,"swell_direction":270,"sea_surface_temperature":21},{"time":"2025-10-18T20:00","wave_height":0.16,"swell_height":0.14,"swell_direction":271,"sea_surface_temperature":20.9},{"time":"2025-10-18T21:00","wave_height":0.16,"swell_height":0.14,"swell_direction":272,"sea_surface_temperature":20.9},{"time":"2025-10-18T22:00","wave_height":0.14,"swell_height":0.14,"swell_direction":272,"sea_surface_temperature":20.9},{"time":"2025-10-18T23:00","wave_height":0.14,"swell_height":0.14,"swell_direction":273,"sea_surface_temperature":20.9},{"time":"2025-10-19T00:00","wave_height":0.14,"swell_height":0.14,"swell_direction":274,"sea_surface_temperature":20.9},{"time":"2025-10-19T01:00","wave_height":0.12,"swell_height":0.12,"swell_direction":274,"sea_surface_temperature":20.8},{"time":"2025-10-19T02:00","wave_height":0.12,"swell_height":0.12,"swell_direction":275,"sea_surface_temperature":20.8},{"time":"2025-10-19T03:00","wave_height":0.12,"swell_height":0.12,"swell_direction":275,"sea_surface_temperature":20.8},{"time":"2025-10-19T04:00","wave_height":0.12,"swell_height":0.1,"swell_direction":276,"sea_surface_temperature":20.8},{"time":"2025-10-19T05:00","wave_height":0.12,"swell_height":0.1,"swell_direction":276,"sea_surface_temperature":20.8},{"time":"2025-10-19T06:00","wave_height":0.12,"swell_height":0.1,"swell_direction":276,"sea_surface_temperature":20.7},{"time":"2025-10-19T07:00","wave_height":0.14,"swell_height":0.08,"swell_direction":277,"sea_surface_temperature":20.7},{"time":"2025-10-19T08:00","wave_height":0.14,"swell_height":0.08,"swell_direction":277,"sea_surface_temperature":20.7},{"time":"2025-10-19T09:00","wave_height":0.16,"swell_height":0.08,"swell_direction":301,"sea_surface_temperature":20.7},{"time":"2025-10-19T10:00","wave_height":0.2,"swell_height":0.06,"swell_direction":324,"sea_surface_temperature":20.7},{"time":"2025-10-19T11:00","wave_height":0.22,"swell_height":0.06,"swell_direction":348,"sea_surface_temperature":20.8},{"time":"2025-10-19T12:00","wave_height":0.2,"swell_height":0.08,"swell_direction":9,"sea_surface_temperature":20.8},{"time":"2025-10-19T13:00","wave_height":0.2,"swell_height":0.12,"swell_direction":31,"sea_surface_temperature":20.8},{"time":"2025-10-19T14:00","wave_height":0.18,"swell_height":0.14,"swell_direction":52,"sea_surface_temperature":20.8},{"time":"2025-10-19T15:00","wave_height":0.16,"swell_height":0.12,"swell_direction":70,"sea_surface_temperature":20.8},{"time":"2025-10-19T16:00","wave_height":0.14,"swell_height":0.08,"swell_direction":89,"sea_surface_temperature":20.8},{"time":"2025-10-19T17:00","wave_height":0.12,"swell_height":0.06,"swell_direction":107,"sea_surface_temperature":20.7},{"time":"2025-10-19T18:00","wave_height":0.1,"swell_height":0.06,"swell_direction":107,"sea_surface_temperature":20.7},{"time":"2025-10-19T19:00","wave_height":0.1,"swell_height":0.04,"swell_direction":108,"sea_surface_temperature":20.6},{"time":"2025-10-19T20:00","wave_height":0.08,"swell_height":0.04,"swell_direction":108,"sea_surface_temperature":20.6},{"time":"2025-10-19T21:00","wave_height":0.08,"swell_height":0.04,"swell_direction":131,"sea_surface_temperature":20.6},{"time":"2025-10-19T22:00","wave_height":0.06,"swell_height":0.04,"swell_direction":155,"sea_surface_temperature":20.6},{"time":"2025-10-19T23:00","wave_height":0.06,"swell_height":0.04,"swell_direction":178,"sea_surface_temperature":20.5},{"time":"2025-10-20T00:00","wave_height":0.06,"swell_height":0.04,"swell_direction":180,"sea_surface_temperature":20.5},{"time":"2025-10-20T01:00","wave_height":0.06,"swell_height":0.04,"swell_direction":181,"sea_surface_temperature":20.5},{"time":"2025-10-20T02:00","wave_height":0.06,"swell_height":0.04,"swell_direction":183,"sea_surface_temperature":20.5},{"time":"2025-10-20T03:00","wave_height":0.06,"swell_height":0.04,"swell_direction":164,"sea_surface_temperature":20.5},{"time":"2025-10-20T04:00","wave_height":0.08,"swell_height":0.06,"swell_direction":146,"sea_surface_temperature":20.5},{"time":"2025-10-20T05:00","wave_height":0.08,"swell_height":0.06,"swell_direction":127,"sea_surface_temperature":20.5},{"time":"2025-10-20T06:00","wave_height":0.08,"swell_height":0.06,"swell_direction":126,"sea_surface_temperature":20.4},{"time":"2025-10-20T07:00","wave_height":0.1,"swell_height":0.08,"swell_direction":126,"sea_surface_temperature":20.4},{"time":"2025-10-20T08:00","wave_height":0.1,"swell_height":0.08,"swell_direction":125,"sea_surface_temperature":20.4},{"time":"2025-10-20T09:00","wave_height":0.1,"swell_height":0.08,"swell_direction":126,"sea_surface_temperature":20.4},{"time":"2025-10-20T10:00","wave_height":0.08,"swell_height":0.06,"swell_direction":127,"sea_surface_temperature":20.5},{"time":"2025-10-20T11:00","wave_height":0.08,"swell_height":0.06,"swell_direction":128,"sea_surface_temperature":20.5},{"time":"2025-10-20T12:00","wave_height":0.08,"swell_height":0.06,"swell_direction":132,"sea_surface_temperature":20.5},{"time":"2025-10-20T13:00","wave_height":0.1,"swell_height":0.08,"swell_direction":135,"sea_surface_temperature":20.5},{"time":"2025-10-20T14:00","wave_height":0.1,"swell_height":0.08,"swell_direction":139,"sea_surface_temperature":20.5},{"time":"2025-10-20T15:00","wave_height":0.1,"swell_height":0.08,"swell_direction":140,"sea_surface_temperature":20.5},{"time":"2025-10-20T16:00","wave_height":0.1,"swell_height":0.1,"swell_direction":140,"sea_surface_temperature":20.5},{"time":"2025-10-20T17:00","wave_height":0.1,"swell_height":0.1,"swell_direction":141,"sea_surface_temperature":20.5},{"time":"2025-10-20T18:00","wave_height":0.1,"swell_height":0.1,"swell_direction":142,"sea_surface_temperature":20.4},{"time":"2025-10-20T19:00","wave_height":0.1,"swell_height":0.1,"swell_direction":142,"sea_surface_temperature":20.4},{"time":"2025-10-20T20:00","wave_height":0.1,"swell_height":0.1,"swell_direction":143,"sea_surface_temperature":20.4},{"time":"2025-10-20T21:00","wave_height":0.1,"swell_height":0.1,"swell_direction":143,"sea_surface_temperature":20.4},{"time":"2025-10-20T22:00","wave_height":0.1,"swell_height":0.1,"swell_direction":144,"sea_surface_temperature":20.4},{"time":"2025-10-20T23:00","wave_height":0.1,"swell_height":0.1,"swell_direction":144,"sea_surface_temperature":20.3},{"time":"2025-10-21T00:00","wave_height":0.1,"swell_height":0.1,"swell_direction":144,"sea_surface_temperature":20.3},{"time":"2025-10-21T01:00","wave_height":0.1,"swell_height":0.1,"swell_direction":145,"sea_surface_temperature":20.3},{"time":"2025-10-21T02:00","wave_height":0.1,"swell_height":0.1,"swell_direction":145,"sea_surface_temperature":20.3},{"time":"2025-10-21T03:00","wave_height":0.1,"swell_height":0.1,"swell_direction":145,"sea_surface_temperature":20.3},{"time":"2025-10-21T04:00","wave_height":0.1,"swell_height":0.08,"swell_direction":145,"sea_surface_temperature":20.3},{"time":"2025-10-21T05:00","wave_height":0.1,"swell_height":0.08,"swell_direction":145,"sea_surface_temperature":20.2},{"time":"2025-10-21T06:00","wave_height":0.1,"swell_height":0.08,"swell_direction":145,"sea_surface_temperature":20.2},{"time":"2025-10-21T07:00","wave_height":0.08,"swell_height":0.08,"swell_direction":144,"sea_surface_temperature":20.2},{"time":"2025-10-21T08:00","wave_height":0.08,"swell_height":0.08,"swell_direction":144,"sea_surface_temperature":20.2},{"time":"2025-10-21T09:00","wave_height":0.1,"swell_height":0.06,"swell_direction":143,"sea_surface_temperature":20.2},{"time":"2025-10-21T10:00","wave_height":0.12,"swell_height":0.06,"swell_direction":142,"sea_surface_temperature":20.3},{"time":"2025-10-21T11:00","wave_height":0.14,"swell_height":0.04,"swell_direction":141,"sea_surface_temperature":20.3},{"time":"2025-10-21T12:00","wave_height":0.18,"swell_height":0.04,"swell_direction":161,"sea_surface_temperature":20.3},{"time":"2025-10-21T13:00","wave_height":0.22,"swell_height":0.06,"swell_direction":182,"sea_surface_temperature":20.4},{"time":"2025-10-21T14:00","wave_height":0.26,"swell_height":0.06,"swell_direction":202,"sea_surface_temperature":20.4},{"time":"2025-10-21T15:00","wave_height":0.26,"swell_height":0.06,"swell_direction":166,"sea_surface_temperature":20.4},{"time":"2025-10-21T16:00","wave_height":0.26,"swell_height":0.08,"swell_direction":131,"sea_surface_temperature":20.4},{"time":"2025-10-21T17:00","wave_height":0.26,"swell_height":0.08,"swell_direction":95,"sea_surface_temperature":20.4},{"time":"2025-10-21T18:00","wave_height":0.28,"swell_height":0.1,"swell_direction":99,"sea_surface_temperature":20.3},{"time":"2025-10-21T19:00","wave_height":0.3,"swell_height":0.1,"swell_direction":103,"sea_surface_temperature":20.3},{"time":"2025-10-21T20:00","wave_height":0.32,"swell_height":0.12,"swell_direction":107,"sea_surface_temperature":20.3},{"time":"2025-10-21T21:00","wave_height":0.34,"swell_height":0.16,"swell_direction":157,"sea_surface_temperature":20.3},{"time":"2025-10-21T22:00","wave_height":0.36,"swell_height":0.18,"swell_direction":207,"sea_surface_temperature":20.3},{"time":"2025-10-21T23:00","wave_height":0.38,"swell_height":0.22,"swell_direction":257,"sea_surface_temperature":20.2},{"time":"2025-10-22T00:00","wave_height":0.42,"swell_height":0.28,"swell_direction":256,"sea_surface_temperature":20.2},{"time":"2025-10-22T01:00","wave_height":0.48,"swell_height":0.36,"swell_direction":254,"sea_surface_temperature":20.2},{"time":"2025-10-22T02:00","wave_height":0.52,"swell_height":0.42,"swell_direction":253,"sea_surface_temperature":20.2},{"time":"2025-10-22T03:00","wave_height":0.58,"swell_height":0.48,"swell_direction":251,"sea_surface_temperature":20.2},{"time":"2025-10-22T04:00","wave_height":0.62,"swell_height":0.54,"swell_direction":248,"sea_surface_temperature":20.2},{"time":"2025-10-22T05:00","wave_height":0.68,"swell_height":0.6,"swell_direction":246,"sea_surface_temperature":20.2},{"time":"2025-10-22T06:00","wave_height":0.72,"swell_height":0.64,"swell_direction":246,"sea_surface_temperature":20.2},{"time":"2025-10-22T07:00","wave_height":0.76,"swell_height":0.66,"swell_direction":245,"sea_surface_temperature":20.2},{"time":"2025-10-22T08:00","wave_height":0.8,"swell_height":0.7,"swell_direction":245,"sea_surface_temperature":20.2},{"time":"2025-10-22T09:00","wave_height":0.82,"swell_height":0.74,"swell_direction":240,"sea_surface_temperature":20.2},{"time":"2025-10-22T10:00","wave_height":0.86,"swell_height":0.76,"swell_direction":236,"sea_surface_temperature":20.2},{"time":"2025-10-22T11:00","wave_height":0.88,"swell_height":0.8,"swell_direction":231,"sea_surface_temperature":20.3},{"time":"2025-10-22T12:00","wave_height":0.9,"swell_height":0.8,"swell_direction":230,"sea_surface_temperature":20.3},{"time":"2025-10-22T13:00","wave_height":0.9,"swell_height":0.8,"swell_direction":229,"sea_surface_temperature":20.3},{"time":"2025-10-22T14:00","wave_height":0.92,"swell_height":0.8,"swell_direction":228,"sea_surface_temperature":20.3},{"time":"2025-10-22T15:00","wave_height":0.9,"swell_height":0.8,"swell_direction":227,"sea_surface_temperature":20.3},{"time":"2025-10-22T16:00","wave_height":0.9,"swell_height":0.78,"swell_direction":226,"sea_surface_temperature":20.3},{"time":"2025-10-22T17:00","wave_height":0.88,"swell_height":0.78,"swell_direction":225,"sea_surface_temperature":20.3},{"time":"2025-10-22T18:00","wave_height":0.86,"swell_height":0.76,"swell_direction":224,"sea_surface_temperature":20.2},{"time":"2025-10-22T19:00","wave_height":0.82,"swell_height":0.74,"swell_direction":224,"sea_surface_temperature":20.2},{"time":"2025-10-22T20:00","wave_height":0.8,"swell_height":0.72,"swell_direction":223,"sea_surface_temperature":20.2},{"time":"2025-10-22T21:00","wave_height":0.78,"swell_height":0.7,"swell_direction":223,"sea_surface_temperature":20.2},{"time":"2025-10-22T22:00","wave_height":0.74,"swell_height":0.68,"swell_direction":223,"sea_surface_temperature":20.2},{"time":"2025-10-22T23:00","wave_height":0.72,"swell_height":0.66,"swell_direction":223,"sea_surface_temperature":20.2}],"alerts":[],"advice":"Condizioni marine generalmente buone.","tides":{},"days":[{"day_label":"16/10","temp_max":"18.7","temp_min":"17.0","precipitation":"8.00","icon":"🌧️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[18.4,18.4,18.5,18.5,18.4,18,18.2,18.1,18.3,18.4,18.5,18.7,18.6,17.5,17,17.3,17.5,17.5,17.3,17.2,17.5,17.7,17.8,17.8],"hourly_winds":[23.7,21.2,18.9,20.7,21.2,21.2,21.7,22.3,21.7,23.3,24,22,19.8,18.8,16.6,19.4,19.4,19.3,20.9,20.1,19.1,18.7,17.7,18.3],"hourly_wind_directions":[47,48,48,49,50,50,54,52,50,52,54,58,71,70,56,50,50,53,49,47,36,34,27,16],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0.8,2.6,2,0.8,0.3,0.4,0.4,0.4,0.2,0.1,0],"hourly_pressures":[1015.8,1015.6,1015.4,1014.8,1014.5,1014.1,1014.1,1014,1014.4,1014.4,1014.7,1014.9,1014.9,1014.7,1014.2,1014.1,1014,1013.9,1013.6,1013.7,1013.9,1014.1,1014.2,1013.9],"pressure_avg":"1014.4"},{"day_label":"17/10","temp_max":"20.4","temp_min":"17.9","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[17.9,18.1,18.2,18.5,18.6,18.6,18.6,18.7,18.9,19.1,19.4,19.5,19.9,20.1,20.1,20.3,20.4,20.4,20.4,20.3,20.2,19.8,19.5,19.4],"hourly_winds":[17.5,17.3,18.4,17.5,16.8,16,14.9,14.5,14.6,15.3,14.3,12.3,13.2,9.7,7.2,5,4.7,4.8,4.4,2.5,4.5,5.1,5.2,5.4],"hourly_wind_directions":[9,359,357,352,351,352,353,346,344,345,348,345,343,345,3,360,328,318,325,360,76,98,124,127],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1013.5,1013.4,1013.3,1013.2,1012.8,1012.6,1012.5,1012.6,1013.3,1013.9,1014.1,1014.3,1014,1014.1,1014.1,1014.3,1014.4,1014.6,1015,1015.4,1015.9,1016.5,1017,1017.3],"pressure_avg":"1014.3"},{"day_label":"18/10","temp_max":"19.5","temp_min":"18.1","precipitation":"0.00","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.2,19,18.8,18.7,18.6,18.5,18.3,18.3,18.4,18.2,18.1,18.3,18.7,19,19.3,19.4,19.4,19.4,19.4,19.4,19.5,19.4,19.3,19.2],"hourly_winds":[4,5.8,5.1,3.4,3.3,5.6,6.6,5.7,6.8,7.1,8.4,8.9,9,8.6,8.5,9.8,8.5,10,10.6,10,7.7,7.6,7.3,7.2],"hourly_wind_directions":[95,90,98,108,131,105,99,125,122,105,110,130,143,158,168,172,168,167,170,167,152,135,123,108],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1017.3,1017.4,1017.5,1017.6,1017.6,1018,1018.2,1018.5,1018.8,1019.5,1020.1,1020.6,1020.5,1020.2,1019.8,1019.4,1019.3,1019.2,1019.3,1019.4,1019.4,1019.7,1020,1020.2],"pressure_avg":"1019.1"},{"day_label":"19/10","temp_max":"21.5","temp_min":"17.8","precipitation":"0.00","icon":"☀️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19,18.8,18.6,18.4,18.1,18,17.9,17.9,17.8,18,18.3,18.8,19.4,20.2,20.8,21.2,21.5,21.5,21,20.2,19.6,19.1,18.8,18.5],"hourly_winds":[7.6,8.6,8.7,9.4,10.7,11,11.8,12.5,13.7,14.8,16.1,16.5,15.3,12.8,11.9,13.3,15.7,17.2,17.7,17.3,17.1,16.7,16,15.1],"hourly_wind_directions":[93,68,52,43,40,41,40,39,35,39,42,46,49,52,55,57,58,57,52,47,41,37,36,33],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1020.2,1019.8,1019.7,1019.3,1019.1,1018.9,1018.7,1018.7,1018.9,1019.1,1019.2,1019.2,1018.7,1018,1017.4,1016.9,1016.4,1016.1,1016.1,1016.2,1016.4,1016.5,1016.7,1016.7],"pressure_avg":"1018.0"},{"day_label":"20/10","temp_max":"19.5","temp_min":"17.0","precipitation":"0.00","icon":"☀️","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[18.2,17.9,17.7,17.6,17.6,17.5,17.3,17.1,17,17.2,17.4,17.8,18.2,18.6,19,19.2,19.3,19.4,19.5,19.4,19.4,19.5,19.5,19.5],"hourly_winds":[14.2,13.4,12.4,11.6,10.5,9.7,8.7,8.1,7.5,7.1,6.6,6.2,5.5,5.6,6.6,8.1,10.1,11.5,11.5,10.5,9.4,8,6.5,5.2],"hourly_wind_directions":[30,27,26,26,27,27,24,21,17,15,13,7,349,320,299,283,274,268,266,266,266,265,264,258],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1016.5,1016.2,1015.8,1015.4,1015,1014.6,1014.3,1014.2,1014.1,1014.3,1014.7,1014.8,1014.4,1013.8,1013.2,1012.8,1012.5,1012.3,1012.2,1012.3,1012.3,1012.4,1012.4,1012.4],"pressure_avg":"1013.9"},{"day_label":"21/10","temp_max":"21.0","temp_min":"19.2","precipitation":"0.90","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.5,19.5,19.5,20,20,20,19.9,19.8,19.8,20,20.3,20.6,20.7,20.8,20.9,21,21,21,20.8,20.4,20.1,19.8,19.5,19.2],"hourly_winds":[4.5,4.8,5.5,5.2,4.6,4,3.3,2.7,3.1,5.2,8.4,11.3,13.3,15.1,16.3,16.9,16.7,16.8,16.5,16,16,16.6,17.4,18.7],"hourly_wind_directions":[241,222,212,214,198,185,186,203,216,214,211,207,199,192,186,180,174,170,170,171,171,167,162,157],"hourly_precips":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.3,0.3,0.3],"hourly_pressures":[1012.2,1012,1011.8,1011.3,1010.8,1010.5,1010.4,1010.4,1010.5,1010.7,1010.9,1010.9,1010.6,1010.2,1009.9,1009.7,1009.6,1009.5,1009.5,1009.5,1009.6,1009.7,1009.9,1010],"pressure_avg":"1010.4"},{"day_label":"22/10","temp_max":"20.8","temp_min":"19.1","precipitation":"1.20","icon":"⛅","hourly_labels":["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],"hourly_temps":[19.1,19.2,19.2,19.3,19.4,19.5,19.5,19.5,19.5,19.6,19.8,20,20.2,20.5,20.6,20.7,20.8,20.8,20.8,20.7,20.6,20.5,20.4,20.2],"hourly_winds":[20.3,21.6,22.4,21.7,20.4,18.9,17.6,16.3,15.1,14.4,13.8,12.7,11.3,10,9.4,9.1,9.1,8.9,8.3,7.7,6.9,5.9,4.7,4],"hourly_wind_directions":[155,152,150,148,144,141,137,131,128,127,129,133,143,159,176,189,198,207,214,221,227,232,238,243],"hourly_precips":[0.4,0.4,0.4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"hourly_pressures":[1010,1009.9,1009.8,1009.7,1009.5,1009.5,1009.7,1010,1010.3,1010.7,1011.3,1011.6,1011.7,1011.6,1011.5,1011.5,1011.5,1011.6,1011.9,1012.3,1012.7,1013.1,1013.4,1013.7],"pressure_avg":"1011.2"}],"updated_at":"16/10/2025, 11:07:41"};
  let selectedDay = 0;

  /** UTILITIES **/
  function windDirectionName(deg) {
    if(deg == null) return {name:"N/D",abbr:"--",arrow:"↕"};
    const compass = [
      { name: "Tramontana", abbr: "N", arrow: "⬇️" },
      { name: "Grecale", abbr: "NE", arrow: "↙️" },
      { name: "Levante", abbr: "E", arrow: "⬅️" },
      { name: "Scirocco", abbr: "SE", arrow: "↖️" },
      { name: "Ostro", abbr: "S", arrow: "⬆️" },
      { name: "Libeccio", abbr: "SO", arrow: "↗️" },
      { name: "Ponente", abbr: "O", arrow: "➡️" },
      { name: "Maestrale", abbr: "NO", arrow: "↘️" }
    ];
    let idx = Math.floor(((deg + 22.5) % 360) / 45);
    return compass[idx] || {name: "N/D", abbr: "--", arrow: "↕"};
  }
  function mean(arr) {
    if(!arr || arr.length === 0) return 0;
    return arr.reduce((a, b) => a + b, 0) / arr.length;
  }
  function pressureTrend(arr) {
    if(!arr || arr.length < 3) return "N/D";
    const start = mean(arr.slice(0,3));
    const end = mean(arr.slice(-3));
    if(end > start + 1) return "in aumento ⬆️";
    if(start > end + 1) return "in calo ⬇️";
    return "stabile ◼️";
  }
  function rainIcon(mm) {
    if(mm < 0.1) return "";
    if(mm < 0.5) return "💧";
    if(mm < 1) return "💧💧";
    if(mm < 3) return "💧💧💧";
    return "💧💧💧💧";
  }

  /** RENDERING **/
  function toggleDetail(id){
    document.querySelectorAll('.detail-section.active').forEach(e=>e.classList.remove('active'));
    const el = document.getElementById(id);
    el.classList.toggle('active');
  }

  function renderTopMeteoBoxes() {
    const container = document.getElementById("topMeteoGrid");
    container.innerHTML = "";
    ["wind", "rain", "sea", "pressure"].forEach(type => {
      const box = document.createElement("div");
      box.className = "meteo-box";
      switch(type){
        case "wind": {
          const d = DATA.days[selectedDay];
          const hr = new Date().getHours();
          const windSpeed = d.hourly_winds?.[hr] ?? d.wind_max ?? "--";
          const windDir = windDirectionName(d.hourly_wind_directions?.[hr] ?? d.wind_dir ?? null);
          box.innerHTML = `
            <div class="box-title">🌬️ Vento</div>
            <div class="box-main-info">Corrente: <strong>${windSpeed} km/h</strong></div>
            <div class="box-sub-info">Direzione: <strong>${windDir.abbr} (${windDir.name})</strong> ${windDir.arrow}</div>
            <button class="btn-detail" onclick="toggleDetail('wind-detail')">Dettagli / Grafico</button>
            <div class="detail-section" id="wind-detail">
              <svg width="120" height="120" viewBox="0 0 120 120" style="margin-bottom: 8px;">
                ${["N","NE","E","SE","S","SO","O","NO"].map((d,i)=>{
                  const angle = i*45 * Math.PI/180;
                  const x= 60 + Math.sin(angle)*48;
                  const y= 60 - Math.cos(angle)*48;
                  return `<text x="${x.toFixed(2)}" y="${y.toFixed(2)}" fill="#54e2ff" font-weight="bold" font-size="14" dominant-baseline="middle" text-anchor="middle">${d}</text>`;
                }).join("")}
                <line x1="60" y1="60" x2="${(60+Math.sin((windDir.abbr==="N"?0:((windDir.abbr==="NE"?45:(windDir.abbr==="E"?90:(windDir.abbr==="SE"?135:(windDir.abbr==="S"?180:(windDir.abbr==="SO"?225:(windDir.abbr==="O"?270:(windDir.abbr==="NO"?315:0))))))))*(Math.PI/180))*40).toFixed(1)}" y2="${(60-Math.cos((windDir.abbr==="N"?0:((windDir.abbr==="NE"?45:(windDir.abbr==="E"?90:(windDir.abbr==="SE"?135:(windDir.abbr==="S"?180:(windDir.abbr==="SO"?225:(windDir.abbr==="O"?270:(windDir.abbr==="NO"?315:0))))))))*(Math.PI/180))*40).toFixed(1)}" stroke="#33ccff" stroke-width="4" stroke-linecap="round"/>
              </svg>
              <div class="chart-wrap"><canvas id="windChart"></canvas></div>
              <div class="info-chips" id="windChips"></div>
            </div>`;
          setTimeout(() => {
            const ctx = document.getElementById("windChart").getContext("2d");
            if(window.windChart) window.windChart.destroy();
            window.windChart = new Chart(ctx, {
              type: "line",
              data: {
                labels: d.hourly_labels,
                datasets: [{
                  label: "Velocità vento (km/h)",
                  data: d.hourly_winds || [],
                  borderColor: "#4eaaf4",
                  backgroundColor: "rgba(74,153,254,0.15)",
                  fill: true,
                  tension: 0.3,
                  pointRadius: 3,
                  pointHoverRadius: 6
                }],
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: {display: false},
                  tooltip: {
                    enabled: false,
                    external: ctx => {
                      const container = document.getElementById("windChips");
                      const tooltip = ctx.tooltip;
                      if (tooltip.opacity === 0) {
                        container.style.opacity = 0;
                        return;
                      }
                      if (!tooltip.body) {
                        return;
                      }
                      const idx = tooltip.dataPoints[0].dataIndex;
                      container.innerHTML = `<div class="info-chip wind">Ora: ${d.hourly_labels[idx]}</div><div class="info-chip wind">Velocità: ${d.hourly_winds[idx]} km/h</div><div class="info-chip wind">Direzione: ${d.hourly_wind_directions[idx]}° (${windDirectionName(d.hourly_wind_directions[idx]).name})</div>`;
                      container.style.opacity = 1;
                    },
                  },
                },
                scales: {
                  y: {beginAtZero: true},
                  x: { grid: {display: false} }
                },
                interaction: {
                  mode: 'nearest',
                  intersect: false
                }
              }
            });
          }, 80);
          break;
        }
        case "rain": {
          const d = DATA.days[selectedDay];
          box.innerHTML = `
            <div class="box-title">🌧️ Pioggia</div>
            <div class="box-main-info">Totale oggi: <strong>${d.precipitation.toFixed(1)} mm</strong> ${rainIcon(d.precipitation)}</div>
            <div class="box-sub-info">${d.precipitation > 0 ? "Possibile precipitazione" : "Nessuna pioggia significativa"}</div>
            <button class="btn-detail" onclick="toggleDetail('rain-detail')">Dettagli / Grafico</button>
            <div class="detail-section" id="rain-detail">
              <div class="chart-wrap"><canvas id="rainChart"></canvas></div>
              <div class="info-chips" id="rainChips"></div>
            </div>`;
          setTimeout(() => {
            const ctx = document.getElementById("rainChart").getContext("2d");
            if(window.rainChart) window.rainChart.destroy();
            window.rainChart = new Chart(ctx, {
              type: "bar",
              data: {
                labels: d.hourly_labels,
                datasets: [{
                  label: "Precipitazioni (mm)",
                  data: d.hourly_precips,
                  backgroundColor: "#47b4ff",
                  borderColor: "#3a9fde",
                  borderWidth: 2,
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: {display: false},
                  tooltip: {
                    enabled: false,
                    external: ctx => {
                      const container = document.getElementById("rainChips");
                      const tooltip = ctx.tooltip;
                      if (tooltip.opacity === 0) {
                        container.style.opacity = 0;
                        return;
                      }
                      if (!tooltip.body) return;
                      const idx = tooltip.dataPoints[0].dataIndex;
                      container.innerHTML = `<div class="info-chip rain">Ora: ${d.hourly_labels[idx]}</div><div class="info-chip rain">Pioggia: ${d.hourly_precips[idx]} mm</div>`;
                      container.style.opacity = 1;
                    },
                  },
                },
                scales: {
                  y: {beginAtZero: true},
                  x: { grid: {display: false} }
                },
                interaction: {mode: 'nearest', intersect: false}
              }
            });
          }, 80);
          break;
        }
        case "sea": {
          const marineData = DATA.mergedHourly || [];
          const waveMean = mean(marineData.map(m => m.wave_height));
          const seaTemp = mean(marineData.map(m => m.sea_surface_temperature));
          box.innerHTML = `
            <div class="box-title">🌊 Mare</div>
            <div class="box-main-info">Altezza media onda: <strong>${waveMean.toFixed(2)} m</strong></div>
            <div class="box-sub-info">Temperatura mare: <strong>${seaTemp.toFixed(1)} °C</strong></div>
            <button class="btn-detail" onclick="toggleDetail('sea-detail')">Dettagli / Grafico</button>
            <div class="detail-section" id="sea-detail">
              <div class="chart-wrap"><canvas id="seaChart"></canvas></div>
              <div class="info-chips">
                <div class="info-chip temp">Hsig: ${waveMean.toFixed(2)} m</div>
                <div class="info-chip temp">Temperatura: ${seaTemp.toFixed(1)} °C</div>
              </div>
            </div>`;
          setTimeout(() => {
            const ctx = document.getElementById("seaChart").getContext("2d");
            if(window.seaChart) window.seaChart.destroy();
            window.seaChart = new Chart(ctx, {
              type: "line",
              data: {
                labels: marineData.map(m => m.time.slice(11, 16)),
                datasets: [
                  {
                    label: "Altezza onda (m)",
                    data: marineData.map(m => m.wave_height),
                    borderColor: "#41f8bd",
                    backgroundColor: "rgba(34, 255, 170, 0.1)",
                    fill: true,
                    tension: 0.25,
                    pointRadius: 2
                  },
                  {
                    label: "Swell (m)",
                    data: marineData.map(m => m.swell_height),
                    borderColor: "#21d08a",
                    backgroundColor: "rgba(34, 255, 170, 0.06)",
                    fill: true,
                    tension: 0.25,
                    pointRadius: 2
                  }
                ]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: { display: true }
                },
                scales: { y: { beginAtZero: true }, x: {} }
              }
            });
          }, 80);
          break;
        }
        case "pressure": {
          const d = DATA.days[selectedDay];
          const arr = d.hourly_pressures || [];
          const pressMean = mean(arr);
          const pressTrend = pressureTrend(arr);
          box.innerHTML = `
            <div class="box-title">🔽 Pressione</div>
            <div class="box-main-info">Media oggi: <strong>${pressMean.toFixed(1)} hPa</strong></div>
            <div class="box-sub-info">Tendenza: ${pressTrend}</div>
            <button class="btn-detail" onclick="toggleDetail('pressure-detail')">Dettagli / Grafico</button>
            <div class="detail-section" id="pressure-detail">
              <div class="chart-wrap"><canvas id="pressureChart"></canvas></div>
              <div class="info-chips">
                <div class="info-chip press">Max: ${Math.max(...arr)} hPa</div>
                <div class="info-chip press">Min: ${Math.min(...arr)} hPa</div>
              </div>
            </div>`;
          setTimeout(() => {
            const ctx = document.getElementById("pressureChart").getContext("2d");
            if(window.pressureChart) window.pressureChart.destroy();
            window.pressureChart = new Chart(ctx, {
              type: "line",
              data: {
                labels: d.hourly_labels,
                datasets: [{
                  label: "Pressione (hPa)",
                  data: arr,
                  borderColor: "#ffd472",
                  backgroundColor: "rgba(255, 240, 51, 0.1)",
                  fill: true,
                  tension: 0.25,
                  pointRadius: 2
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: { legend: { display: false } },
                scales: { y: { beginAtZero: false }, x: {} }
              }
            });
          }, 80);
          break;
        }
      }
      container.appendChild(box);
    });
  }

  function renderTodayCard() {
    const d = DATA.days[selectedDay];
    const alerts = (DATA.alerts && DATA.alerts.length) ? DATA.alerts.join(", ") : "Nessuna allerta";
    const advice = DATA.advice || "";
    document.getElementById("todayCard").innerHTML = `
      <div class="today-header">${d.day_label} ${d.icon}</div>
      <div class="today-details"><strong>Max:</strong> ${d.temp_max}°C • <strong>Min:</strong> ${d.temp_min}°C</div>
      <div class="today-details"><strong>Pioggia:</strong> ${d.precipitation} mm ${rainIcon(d.precipitation)}</div>
      <div class="today-details"><strong>Vento max:</strong> ${d.wind_max} km/h</div>
      <div class="today-details"><strong>Pressione media:</strong> ${d.pressure_avg} hPa (${pressureTrend(d.hourly_pressures)})</div>
      <div class="today-details"><strong>Allerta:</strong> ${alerts}</div>
      <div class="today-message"><strong>Consiglio:</strong> ${advice}</div>
    `;
  }

  function renderMiniCards() {
    const container = document.getElementById("daysGrid");
    container.innerHTML = "";
    const days = DATA.days.filter((_, idx) => idx !== selectedDay);
    days.forEach((d, i) => {
      const card = document.createElement("div");
      card.className = "day-card";
      if(i === 0) card.classList.add("selected");
      card.innerHTML = `
        <div class="day-date">${d.day_label} ${d.icon}</div>
        <div class="day-temps">
          <span class="temp-high">↑ ${d.temp_max}°</span> &nbsp; <span class="temp-low">↓ ${d.temp_min}°</span>
        </div>
        <div class="day-wind-precip">
          💨 ${d.wind_max} km/h &nbsp; ${rainIcon(d.precipitation)} ${d.precipitation} mm
        </div>
      `;
      card.onclick = () => {
        selectedDay = DATA.days.indexOf(d);
        renderAll();
      };
      container.appendChild(card);
    });
  }

  function renderFooter() {
    document.getElementById('footer').innerHTML = `Powered by Open-Meteo • UI by micheledv74 • Ultimo aggiornamento: <strong>${DATA.updated_at}</strong>`;
  }

  function renderAll() {
    renderTopMeteoBoxes();
    renderTodayCard();
    renderMiniCards();
    renderFooter();
  }

  renderAll();
</script>
</body>
</html>
